{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/css/noscript.styl","path":"css/noscript.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.png","path":"images/avatar.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","path":"images/logo-algolia-nebula-blue-full.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/js/bookmark.js","path":"js/bookmark.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/busuanzi.js","path":"js/busuanzi.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/comments-buttons.js","path":"js/comments-buttons.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/config.js","path":"js/config.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/comments.js","path":"js/comments.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/local-search.js","path":"js/local-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/jquery.js","path":"js/jquery.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/mo.min.js","path":"js/mo.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/pjax.js","path":"js/pjax.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/schedule.js","path":"js/schedule.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/valine.min.js","path":"js/valine.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/fancybox.js","path":"js/third-party/fancybox.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/pace.js","path":"js/third-party/pace.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/quicklink.js","path":"js/third-party/quicklink.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/rating.js","path":"js/third-party/rating.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/baidu-analytics.js","path":"js/third-party/analytics/baidu-analytics.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/google-analytics.js","path":"js/third-party/analytics/google-analytics.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/growingio.js","path":"js/third-party/analytics/growingio.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/chatra.js","path":"js/third-party/chat/chatra.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/gitter.js","path":"js/third-party/chat/gitter.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/tidio.js","path":"js/third-party/chat/tidio.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/changyan.js","path":"js/third-party/comments/changyan.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/disqus.js","path":"js/third-party/comments/disqus.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/disqusjs.js","path":"js/third-party/comments/disqusjs.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/gitalk.js","path":"js/third-party/comments/gitalk.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/isso.js","path":"js/third-party/comments/isso.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/livere.js","path":"js/third-party/comments/livere.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/utterances.js","path":"js/third-party/comments/utterances.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/math/katex.js","path":"js/third-party/math/katex.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/math/mathjax.js","path":"js/third-party/math/mathjax.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/search/algolia-search.js","path":"js/third-party/search/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/search/local-search.js","path":"js/third-party/search/local-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/statistics/firestore.js","path":"js/third-party/statistics/firestore.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/statistics/lean-analytics.js","path":"js/third-party/statistics/lean-analytics.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/tags/mermaid.js","path":"js/third-party/tags/mermaid.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/tags/pdf.js","path":"js/third-party/tags/pdf.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/ForkJoin.md","hash":"02f10f5ca2f3577861a2231cc3a0eac7628614ea","modified":1645878389109},{"_id":"source/_posts/hello-world.md","hash":"7d98d6592de80fdcd2949bd7401cec12afd98cdf","modified":1645877172138},{"_id":"source/friends/index.md","hash":"51508ee3b8dafe5578b6fd35a05a998f3e9570c5","modified":1645975870700},{"_id":"source/_posts/tags-test.md","hash":"5b8225ca138c4af5d58842d8f7f4baaf14062b75","modified":1645964171097},{"_id":"source/tags/index.md","hash":"8bc24d7d070886904aea7094248a087707e5059b","modified":1645953639488},{"_id":"themes/next/.editorconfig","hash":"731c650ddad6eb0fc7c3d4a91cad1698fe7ad311","modified":1645863504096},{"_id":"themes/next/.eslintrc.json","hash":"611e15c3fcb41dc68fa8532ee595a1262a1b5a8a","modified":1645863504096},{"_id":"themes/next/.gitattributes","hash":"aeeca2f1e987d83232d7870d1435a4e3ed66b648","modified":1645863504096},{"_id":"themes/next/.gitignore","hash":"087b7677078303acb2acb47432165950e4d29b43","modified":1645863504111},{"_id":"themes/next/LICENSE.md","hash":"8cfb03967dd4cbaf3b825271ffce0039aa3fc22a","modified":1645863504111},{"_id":"themes/next/.stylintrc","hash":"6259e2a0b65d46865ab89564b88fc67638668295","modified":1645863504111},{"_id":"themes/next/README.md","hash":"43fe29330352545446a532e6630866251129882a","modified":1645863504111},{"_id":"themes/next/_vendors.yml","hash":"7b258f85a083815ef05012103cb1c4a9f86c19b0","modified":1645938137283},{"_id":"themes/next/_config.yml","hash":"73a10715432bceb550a2e9e8aaab20ae6b5abf97","modified":1646136810204},{"_id":"themes/next/crowdin.yml","hash":"4a53f5985e545c635cb56b2a57ed290cb8cf8942","modified":1645863504111},{"_id":"themes/next/package.json","hash":"d52c5dacd768ec2d020af3e33665995256209a35","modified":1645948333333},{"_id":"themes/next/renovate.json","hash":"767b077c7b615e20af3cf865813cd64674a9bea6","modified":1645863504163},{"_id":"themes/next/.githooks/install.js","hash":"305c2a269818466eed9e381b866c6cd1ad7f8afd","modified":1645863504096},{"_id":"themes/next/.githooks/pre-commit","hash":"b69b9d0b51e27d5d4c87c3242f5067c2cda26e44","modified":1645863504111},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"2fdca1040427cabfe27cae6754ec5e027ec7092e","modified":1645863504111},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"593ae64e72d43c020a697eac65b1f9c3483ff097","modified":1645863504111},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"a103e2d875f7434191859e5b42075cfa9a4cbcb3","modified":1645863504111},{"_id":"themes/next/.github/config.yml","hash":"0956bf71b6f36632b63b14d26580458041a5abd2","modified":1645863504111},{"_id":"themes/next/.github/label-commenter-config.yml","hash":"a1aa85a2fc66ff0c52c65bd97b0fa282e297a73f","modified":1645863504111},{"_id":"themes/next/.github/labeler.yml","hash":"ff76a903609932a867082b8ccced906e9910533a","modified":1645863504111},{"_id":"themes/next/.github/issue_label_bot.yaml","hash":"533fbe6b2f87d7e7ec6949063bb7ea7eb4fbe52d","modified":1645863504111},{"_id":"themes/next/.github/release-drafter.yml","hash":"de38f816e3023e0a5c1fd1f3c2b626f78bc35246","modified":1645863504111},{"_id":"themes/next/docs/AUTHORS.md","hash":"579014d47f45b27fd1618b9709f0efe9585c7449","modified":1645863504111},{"_id":"themes/next/docs/AGPL3.md","hash":"f463f95b169d64983f59fa6f3e4b6760290a0e6b","modified":1645863504111},{"_id":"themes/next/docs/LICENSE.txt","hash":"d1cd5a8e83d3bbdb50f902d2b487813da95ddfd3","modified":1645863504111},{"_id":"themes/next/languages/README.md","hash":"b1c96465b3bc139bf5ba6200974b66581d8ff85a","modified":1645863504111},{"_id":"themes/next/languages/ar.yml","hash":"cc7e3e2855348563d746f15c4752b9c63fcdd91a","modified":1645863504111},{"_id":"themes/next/languages/bn.yml","hash":"e78a674af44f19415b9bd91e994548a95be174ae","modified":1645863504111},{"_id":"themes/next/languages/de.yml","hash":"83023c4246b93a2f89f342afe29a7b9e1185f74f","modified":1645863504111},{"_id":"themes/next/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1645863504111},{"_id":"themes/next/languages/en.yml","hash":"dee2aa7c28cc616a44b89f644d98dcf25f873b0f","modified":1645949144499},{"_id":"themes/next/languages/es.yml","hash":"21676d658d309eb90342a924e106645611c937bc","modified":1645863504111},{"_id":"themes/next/languages/fa.yml","hash":"e09fad889ab3ae87874093e1acd51edc9297d869","modified":1645863504111},{"_id":"themes/next/languages/fr.yml","hash":"328c255c82e9b561e20a9f51a4d84abc63d1b90a","modified":1645863504127},{"_id":"themes/next/languages/id.yml","hash":"d7c337ca72efb0bd02ade8b5560c559384ad84dd","modified":1645863504127},{"_id":"themes/next/languages/it.yml","hash":"c038ff0cadbe405750d980bcacfd3900acf96905","modified":1645863504127},{"_id":"themes/next/languages/ko.yml","hash":"d6e2add7488065ec4f7d21cfcf7f0eaa877a84f4","modified":1645863504127},{"_id":"themes/next/languages/ja.yml","hash":"57a35b21aca04ce8bca64fb5933f35626c462ea3","modified":1645863504127},{"_id":"themes/next/languages/nl.yml","hash":"e47858bd1e0d0622c15366ae6c0513d996f589e3","modified":1645863504127},{"_id":"themes/next/languages/pt-BR.yml","hash":"305025e932832328b7e2a8a584638a23c462e68f","modified":1645863504127},{"_id":"themes/next/languages/pt.yml","hash":"ff93459250c33d3c7ba06c30164cc4208edf9b33","modified":1645863504127},{"_id":"themes/next/languages/ru.yml","hash":"837bb39651769244b19ce458053757d429869764","modified":1645863504127},{"_id":"themes/next/languages/si.yml","hash":"c15ed758dbad890e856f4fc281208d7b78cc1a59","modified":1645863504127},{"_id":"themes/next/languages/tk.yml","hash":"bf61562ac892231bd28f23a2a5597ee98fb05aa6","modified":1645863504127},{"_id":"themes/next/languages/tr.yml","hash":"d3262d2221b0583a52e5d20a3cd1380f5dc49378","modified":1645863504127},{"_id":"themes/next/languages/uk.yml","hash":"f32871f67c63d26bc4e3e15df9b01f5a41236a50","modified":1645863504127},{"_id":"themes/next/languages/vi.yml","hash":"e452ea8c48993262a3e8fce9d92072cafabfc734","modified":1645863504127},{"_id":"themes/next/languages/zh-CN.yml","hash":"f8379d15038e22ef7039d91272cb4f36842dbbe1","modified":1645863504127},{"_id":"themes/next/languages/zh-HK.yml","hash":"c1ee97ceb56da76ecdc7b69fa975f28c8574441b","modified":1645863504127},{"_id":"themes/next/layout/_layout.njk","hash":"104f37c440fd9185dda78b1bd82ded35350c663c","modified":1646146941790},{"_id":"themes/next/layout/archive.njk","hash":"723c05231b1f874f95cc6022e1582e7c0d057bbc","modified":1646066037557},{"_id":"themes/next/languages/zh-TW.yml","hash":"70c45076ad722b777956048fcc430eac37844c11","modified":1645863504127},{"_id":"themes/next/layout/category.njk","hash":"82f541452cae76a94ee15cb8d8a888f44260a0fd","modified":1645863504161},{"_id":"themes/next/layout/index.njk","hash":"fa52c3049871e879980cb6abccdea3792ca4ce70","modified":1645863504161},{"_id":"themes/next/layout/page.njk","hash":"fddfdee95f5da86eab8a85d6eb1901996d2153cf","modified":1645863504161},{"_id":"themes/next/layout/post.njk","hash":"707a50e50b90df5fbeaf8407d12895d04163a290","modified":1645863504162},{"_id":"themes/next/layout/tag.njk","hash":"b6c017d30d08ddd30d66e9c6f3a71aa65d214eac","modified":1645863504162},{"_id":"themes/next/test/index.js","hash":"983a505399796b9d9e174ba46d89abbdde38f8ee","modified":1645863504223},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"032194e7975564176f2109aa8b7c020fa6d5e6b1","modified":1645863504111},{"_id":"themes/next/.github/ISSUE_TEMPLATE/other.md","hash":"618d07b49f4774cd79613d4001984a19d954a6ad","modified":1645863504111},{"_id":"themes/next/.github/ISSUE_TEMPLATE/config.yml","hash":"daeedc5da2ee74ac31cf71846b766ca6499e9fc6","modified":1645863504111},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"4a7885fe2c8b25be02ab57c345cd862aeeeeacaf","modified":1645863504111},{"_id":"themes/next/.github/workflows/label-commenter.yml","hash":"7dec949b13131783e726facb2f4acde0945db1b8","modified":1645863504111},{"_id":"themes/next/.github/workflows/labeler.yml","hash":"46d0b29dc561fe571d91fd06a7c8ef606b984c72","modified":1645863504111},{"_id":"themes/next/.github/workflows/linter.yml","hash":"b57d876c90d1645a52bbba8a52d47ad0b0c96140","modified":1645863504111},{"_id":"themes/next/.github/workflows/lock.yml","hash":"58eca481fd71088a8ae1dbc04645bcfc03460b87","modified":1645863504111},{"_id":"themes/next/.github/workflows/stale.yml","hash":"32e7dfb55ecf8af66aebfed471be09ef2eb10e18","modified":1645863504111},{"_id":"themes/next/.github/workflows/release-drafter.yml","hash":"359b74890a47d784e35a5cc3c7885d5cdf302e82","modified":1645863504111},{"_id":"themes/next/.github/workflows/tester.yml","hash":"b53053d82f428605f29274b318d73429a37fb275","modified":1645863504111},{"_id":"themes/next/docs/ru/README.md","hash":"e1d6bf38cf34972ca2ee5331a727787fe14082a3","modified":1645863504111},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"7befb4325b107dd668d9eae3d7e86a34910ce3f2","modified":1645863504111},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"a09ceb82b45dd8b7da76c227f3d0bb7eebe7d5d1","modified":1645863504111},{"_id":"themes/next/docs/zh-CN/README.md","hash":"354b0b0a24cbe97cccf2ec8bd97eb7d624fa0dea","modified":1645863504111},{"_id":"themes/next/layout/_macro/post.njk","hash":"d42737506482904201f96e3b6f42a291742a0cec","modified":1645939021075},{"_id":"themes/next/layout/_macro/post-collapse.njk","hash":"d9d8e6d7a6a8c80009dd5334cc17fd3e4977a008","modified":1645863504127},{"_id":"themes/next/layout/_macro/sidebar.njk","hash":"be779ec6d11bf9ba28f89191ab70728581042f5a","modified":1645936512915},{"_id":"themes/next/layout/_partials/comments.njk","hash":"d6b7bb7764e3b471ed6b4e5715f6cbe2dd453f59","modified":1645863504127},{"_id":"themes/next/layout/_partials/footer.njk","hash":"18c609ef34d9440b3525fe47041bdbd849fb9504","modified":1645947880726},{"_id":"themes/next/layout/_partials/languages.njk","hash":"537026fc120adeef9148c98ebf074207e3810538","modified":1645863504141},{"_id":"themes/next/layout/_partials/pagination.njk","hash":"2de77d533c91532a8a4052000244d0c1693370df","modified":1645863504144},{"_id":"themes/next/layout/_partials/widgets.njk","hash":"54a89accfdbfa2e6df912994c496815ed802cc6e","modified":1645891986526},{"_id":"themes/next/layout/_scripts/vendors.njk","hash":"0a1470440f11362df2b1cd6b6228e273d9f999d6","modified":1645863504149},{"_id":"themes/next/layout/_third-party/fancybox.njk","hash":"53ad3c31762b74e5d29787b37d5e494cc4fded9b","modified":1645863504155},{"_id":"themes/next/layout/_scripts/index.njk","hash":"4eb65641b47ea9b23ed2ddfd69b18f21d7d8f214","modified":1645863504149},{"_id":"themes/next/layout/_third-party/index.njk","hash":"33a4a3275474bd3bb2e8d1b0ea01b42dda9ea608","modified":1645863504155},{"_id":"themes/next/layout/_third-party/pace.njk","hash":"13b2a77b4858a127f458ea092b6f713b052befac","modified":1645863504157},{"_id":"themes/next/layout/_third-party/quicklink.njk","hash":"73bc15a9c3c5c239ab90efa19a1e721f41f3cb93","modified":1645863504157},{"_id":"themes/next/layout/_third-party/rating.njk","hash":"d0444179fec512760ab1d4f76928d795b971c884","modified":1645863504157},{"_id":"themes/next/scripts/events/index.js","hash":"8bca7ae3cebb3857866d718a562c5d8820fcfbe5","modified":1645863504163},{"_id":"themes/next/scripts/helpers/next-config.js","hash":"e73f43f1bcb46965e317285d6831e129a40ea59b","modified":1645974792211},{"_id":"themes/next/scripts/helpers/engine.js","hash":"11c40cd31cec00bfca7a45d596e76b425fc397c5","modified":1645863504170},{"_id":"themes/next/scripts/helpers/font.js","hash":"0a6fa582a0890ecaf5f03f758a730936e48aeca1","modified":1645863504171},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"98fc68cf3fcd6253bbb94068ab1d86578a4ef9ea","modified":1645863504171},{"_id":"themes/next/scripts/helpers/next-vendors.js","hash":"52acbc74c1ead8a77cd3bbcba4e033053683f7d0","modified":1645863504172},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"0c9a1fe9906672724dbf274154a37bac1915ca2c","modified":1645863504168},{"_id":"themes/next/scripts/filters/locals.js","hash":"87f3bff03fa9fd96cf0787a6442464a7ff57f76b","modified":1645863504169},{"_id":"themes/next/scripts/filters/post.js","hash":"5a132b7f9280a40b3d5fb40928c8cbbe071fe6f6","modified":1645863504170},{"_id":"themes/next/scripts/filters/minify.js","hash":"056f9c9f8c6e34b084b4ac69901c9858a072d9ab","modified":1645863504169},{"_id":"themes/next/scripts/tags/button.js","hash":"86c71c73a63744efbbbb367612871fede0d69529","modified":1645863504172},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"8e912c715702addaf0cefe63e580e45b97ae8c3f","modified":1645863504172},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"1c609312a71d47f838226346aad5c2e1c35f15dd","modified":1645863504173},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"b4d12e6fe29089be0f43bafc9eea736602cd16bf","modified":1645863504173},{"_id":"themes/next/scripts/tags/index.js","hash":"255dd1090e8319b557eeca43571f0e4f8aab013b","modified":1645863504174},{"_id":"themes/next/scripts/tags/link-grid.js","hash":"3f358bb78c5c6fdf45de287f3ead553e3a6a93c2","modified":1645863504174},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"b3844e168b51a99d495ca05562ffac47677f5728","modified":1645863504175},{"_id":"themes/next/scripts/tags/label.js","hash":"c18b0e619a779ed40be7f014db92af18f45fbd5c","modified":1645863504174},{"_id":"themes/next/scripts/tags/pdf.js","hash":"317ba4611020cc840854386dde098dbbe452777e","modified":1645863504175},{"_id":"themes/next/scripts/tags/note.js","hash":"a12fd53e421400836a3722ae69130969558d6ac0","modified":1645863504175},{"_id":"themes/next/scripts/tags/tabs.js","hash":"e0ed5fe1bc9d2957952a1aacdf3252d6ef3f9743","modified":1645863504175},{"_id":"themes/next/scripts/tags/video.js","hash":"f6ad3f52779f0636251238d3cbdc5b6f91cc5aba","modified":1645863504176},{"_id":"themes/next/source/css/_colors.styl","hash":"5ea14958044d7d6fe57c5312774a28b23932f90c","modified":1646023211579},{"_id":"themes/next/source/css/_mixins.styl","hash":"34bb8315ecb9df3f346305746e0d37635e5884c7","modified":1645932347152},{"_id":"themes/next/source/css/main.styl","hash":"38b8a12681a3a04bed02aa1659054912ed6def11","modified":1645863504207},{"_id":"themes/next/source/css/noscript.styl","hash":"7dc97674c232f6ca71e48b95e3f66472cd8e9c05","modified":1645863504207},{"_id":"themes/next/source/images/avatar.png","hash":"950a75e7c1a7f9d510ede71f7d0bdeb1466ca514","modified":1645106268902},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1645863504207},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1645863504207},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1645863504207},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1645863504207},{"_id":"themes/next/source/js/bookmark.js","hash":"1457291a7244b7786ec35b949d97183e4fbd181d","modified":1645863504207},{"_id":"themes/next/source/images/logo.svg","hash":"2cb74fd3ea2635e015eabc58a8d488aed6cf6417","modified":1645863504207},{"_id":"themes/next/source/js/busuanzi.js","hash":"ed9da4adea9bcd618fdf25acab2daf9b9cdd341e","modified":1645287091930},{"_id":"themes/next/source/js/comments-buttons.js","hash":"81ea6cbcdf0357094753d7523919c1eafa38e79f","modified":1645863504207},{"_id":"themes/next/source/js/config.js","hash":"211a9ab35205ccfa6b7c74394bade84da0d00af7","modified":1645863504207},{"_id":"themes/next/source/js/comments.js","hash":"0b4daf0ce610760bd52e95d423f61f3e1c72442a","modified":1645863504207},{"_id":"themes/next/source/js/local-search.js","hash":"cfa6a0f3f9c2bc759ee507668a21f4e8f250f42a","modified":1645279153596},{"_id":"themes/next/source/js/next-boot.js","hash":"b0bdb542a809932182cfbb8772328115142a0b77","modified":1645891634324},{"_id":"themes/next/source/js/motion.js","hash":"20b979ebe3671cb415e6e7171485d65cc347086e","modified":1645863504207},{"_id":"themes/next/source/js/pjax.js","hash":"85293c253e0f43540572c4e4615c712325a732e2","modified":1645863504207},{"_id":"themes/next/source/js/schedule.js","hash":"6dade4388aa6579576a35758075134f573985d57","modified":1645863504207},{"_id":"themes/next/source/js/utils.js","hash":"b6f1d24bc40da927e267916c9552b455cdaa5545","modified":1645891586831},{"_id":"themes/next/test/helpers/index.js","hash":"2fb58dca3df2fe53116ee2b1232fa26ebe7b2ce5","modified":1645863504223},{"_id":"themes/next/test/helpers/font.js","hash":"6f5076bd3f2724e47b46ca69028393a9b6275cd1","modified":1645863504223},{"_id":"themes/next/test/helpers/next-url.js","hash":"08e84781f1cd54e5634b86877ad9cefae4a78e95","modified":1645863504223},{"_id":"themes/next/test/validate/index.js","hash":"560862194991c5963da5a411629d8e6c71d20ee2","modified":1645863504223},{"_id":"themes/next/test/tags/button.js","hash":"a50ca44eaec3d91c2958e3157d624cd3e68828c7","modified":1645863504223},{"_id":"themes/next/test/tags/caniuse.js","hash":"2852be850d9103c25114253a45e6c62e32517de4","modified":1645863504223},{"_id":"themes/next/test/tags/group-pictures.js","hash":"8f66d3c6f03fb11d85aa2ab05c9b3c9aa2b4e994","modified":1645863504223},{"_id":"themes/next/test/tags/center-quote.js","hash":"2ac4b5a358681691a17e736de06fce0b640a7023","modified":1645863504223},{"_id":"themes/next/test/tags/index.js","hash":"5cad001936a694bf32d59751cc2b68a66199f976","modified":1645863504223},{"_id":"themes/next/test/tags/link-grid.js","hash":"41730266306c02362258384cd73659223928361f","modified":1645863504223},{"_id":"themes/next/test/tags/mermaid.js","hash":"f718a3d0e303d842e2ca5a3b162539a49e45a520","modified":1645863504223},{"_id":"themes/next/test/tags/note.js","hash":"161a81ce749e239d2403681372d48ecc1b51d7b9","modified":1645863504223},{"_id":"themes/next/test/tags/label.js","hash":"6cad7d84c42511459a89cda3971e8ea5cdee0125","modified":1645863504223},{"_id":"themes/next/test/tags/pdf.js","hash":"2d114596a8a180b2f3cd2a9c6528a328961f12d4","modified":1645863504223},{"_id":"themes/next/test/tags/tabs.js","hash":"b19d2592347eae5d6a7a97ca7e8cec03e8f25b51","modified":1645863504223},{"_id":"themes/next/test/tags/video.js","hash":"88db9a3a26cd35525c43c0339fcd1c5965ec9518","modified":1645863504223},{"_id":"themes/next/layout/_partials/head/head-unique.njk","hash":"fd83bbe03833b126c0138c9312ea306a6cf556cd","modified":1645863504127},{"_id":"themes/next/layout/_partials/head/head.njk","hash":"3ff7e251bf99a275cd5dfda1b3e51f773c5f7b05","modified":1645863504127},{"_id":"themes/next/layout/_partials/header/brand.njk","hash":"8f11cdf5147ffbe1eee2c16aa208faea0207cfe5","modified":1645972348217},{"_id":"themes/next/layout/_partials/header/menu-item.njk","hash":"f066390762faf6684a523e2eb943420023aac2b1","modified":1645863504127},{"_id":"themes/next/layout/_partials/header/index.njk","hash":"1b2ae17f3c394ce310fe2d9ed5f4d07d8cc74ae7","modified":1645888056158},{"_id":"themes/next/layout/_partials/header/menu.njk","hash":"bb711592430b03bdf4fcf89d16278a72c68f7ded","modified":1645968297570},{"_id":"themes/next/layout/_partials/header/sub-menu.njk","hash":"940cad08a67e6c361214045096bd3cdffdf44fcf","modified":1645863504140},{"_id":"themes/next/layout/_partials/page/breadcrumb.njk","hash":"9c136edd2248e2d50c1f6110b75e2b75c299bbd7","modified":1645863504142},{"_id":"themes/next/layout/_partials/page/categories.njk","hash":"b352346dd2cb42f7eeaec5e39d9a2a353b029775","modified":1645863504143},{"_id":"themes/next/layout/_partials/page/page-header.njk","hash":"92553feb26f30f7fc9147bc4ef122908a9da06be","modified":1645863504143},{"_id":"themes/next/layout/_partials/page/tags.njk","hash":"e9e788b2e66ca5ffa3ea8dfa2085d03cd5790307","modified":1645954331104},{"_id":"themes/next/layout/_partials/page/schedule.njk","hash":"130e776575d634201d4f8ef3d78dc12624f19fde","modified":1645863504144},{"_id":"themes/next/layout/_partials/post/post-copyright.njk","hash":"0ebc0142abebbeef4278e32abb543c7d7fa75d88","modified":1645863504145},{"_id":"themes/next/layout/_partials/post/post-followme.njk","hash":"ebf83083856f8bd81ad47ffb985d44e338b4e6bb","modified":1645863504145},{"_id":"themes/next/layout/_partials/post/post-meta.njk","hash":"80bcd84cc72c2fa162e7c4a85655ef5d18cf4197","modified":1645950548185},{"_id":"themes/next/layout/_partials/post/post-footer.njk","hash":"e3502059bcc443ce932946a9891fcbe8b2bb362d","modified":1645863504145},{"_id":"themes/next/layout/_partials/post/post-related.njk","hash":"17e03b61e20a5cb4195f0e0d75261ce61a1cddc4","modified":1645863504146},{"_id":"themes/next/layout/_partials/post/post-reward.njk","hash":"58b3f657a47bae406e5fcf19cd5e42680785ac71","modified":1645863504146},{"_id":"themes/next/layout/_partials/sidebar/site-overview.njk","hash":"9e447a10cf7425285c5e1d7ecdd0d07734aa8ae2","modified":1645965938862},{"_id":"themes/next/layout/_partials/search/algolia-search.njk","hash":"93fbb449fbd599cb4315d7eb0daeb239811b233f","modified":1645863504147},{"_id":"themes/next/layout/_partials/search/localsearch.njk","hash":"2b016e9b9dcf5f4b9851fccd9a43b7f5dbb375fd","modified":1645893761267},{"_id":"themes/next/layout/_partials/search/index.njk","hash":"9766852e72c1809d8c1eea71ac6116b4cc0886d2","modified":1645863504147},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.njk","hash":"3e80332f88b101141be69f2a07f54ed8c053eabb","modified":1645863504150},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.njk","hash":"52ad137450f7b3d6a330e16b3ed1c6174290f0eb","modified":1645863504151},{"_id":"themes/next/layout/_third-party/analytics/cloudflare.njk","hash":"c7cea42f6db2137c11ca1d83e43fcb7ad7ccfb89","modified":1645863504150},{"_id":"themes/next/layout/_third-party/analytics/index.njk","hash":"eef710e9be20e7fed7573d0824feaa4eb1cf2737","modified":1645863504151},{"_id":"themes/next/layout/_third-party/analytics/growingio.njk","hash":"9ff9ec05c2037beea229a6bb698f9e3546973220","modified":1645863504151},{"_id":"themes/next/layout/_third-party/analytics/microsoft-clarity.njk","hash":"50c42adf5ba59ff227e9bce6dc4085694e5fe3c2","modified":1645863504151},{"_id":"themes/next/layout/_third-party/comments/changyan.njk","hash":"5f7967bd946060f4102263a552ddfbae9975e7ea","modified":1645863504153},{"_id":"themes/next/layout/_third-party/comments/disqusjs.njk","hash":"c5086b4c35f730f82c99c4a8317f2f153ebde869","modified":1645863504154},{"_id":"themes/next/layout/_third-party/comments/disqus.njk","hash":"b0828dd1b1fd66ecd612d9e886a08e7579e9a4f7","modified":1645863504153},{"_id":"themes/next/layout/_third-party/comments/isso.njk","hash":"38badcc7624a13961381c2465478056b9602aee5","modified":1645863504154},{"_id":"themes/next/layout/_third-party/comments/gitalk.njk","hash":"6fd4df5c21cfe530dbb0c012bc0b202f2c362b9c","modified":1645863504154},{"_id":"themes/next/layout/_third-party/comments/livere.njk","hash":"b8e0d5de584cece5e05b03db5b86145aa1e422b4","modified":1645863504154},{"_id":"themes/next/layout/_third-party/comments/utterances.njk","hash":"a7921be7328e1509d33b435175f5333a9aada66f","modified":1645863504155},{"_id":"themes/next/layout/_third-party/chat/chatra.njk","hash":"09d2c9487d75894d45a823e3237ae9f90fd6ee01","modified":1645863504152},{"_id":"themes/next/layout/_third-party/chat/gitter.njk","hash":"375a86f0b19e130cfa7707007e3a53d9ae7c9b64","modified":1645863504152},{"_id":"themes/next/layout/_third-party/chat/tidio.njk","hash":"3fbc72427c1211e5dcfd269af1a74852a7ba5c1a","modified":1645863504152},{"_id":"themes/next/layout/_third-party/math/index.njk","hash":"1856c4b035c5b8e64300a11af0461b519dfc4cf4","modified":1645863504156},{"_id":"themes/next/layout/_third-party/math/mathjax.njk","hash":"a62aa1ed4e35b8d0451d83f341bf0a97538bc9a4","modified":1645863504156},{"_id":"themes/next/layout/_third-party/math/katex.njk","hash":"a84db8bc8804335f95609a221ac1746433dcdc89","modified":1645863504156},{"_id":"themes/next/layout/_third-party/statistics/firestore.njk","hash":"af5336e8bbdc4638435971da115bb7443d374ade","modified":1645863504159},{"_id":"themes/next/layout/_third-party/statistics/busuanzi-counter.njk","hash":"d97790e4b442a1e3ded7d7b4f84b8ee6cdb6e8ea","modified":1645863504159},{"_id":"themes/next/layout/_third-party/statistics/index.njk","hash":"866ffa15a3250678eb8a90aa6f609fa965db90fd","modified":1645863504159},{"_id":"themes/next/layout/_third-party/statistics/lean-analytics.njk","hash":"8703d1855bb8d251c9b7c2940b7e3be525e53000","modified":1645863504160},{"_id":"themes/next/layout/_third-party/search/algolia-search.njk","hash":"67f67a77f27103177b9940446f43610229536d82","modified":1645863504158},{"_id":"themes/next/layout/_third-party/search/localsearch.njk","hash":"210c32b654adae3d8076c4417d370b42af258cea","modified":1645863504158},{"_id":"themes/next/layout/_third-party/tags/mermaid.njk","hash":"dd8f963acd5a3685be46fd5319c06df0308d99b2","modified":1645863504160},{"_id":"themes/next/layout/_third-party/tags/pdf.njk","hash":"0386c708975cc5faea4f782611c5d2c6b8ac2850","modified":1645863504160},{"_id":"themes/next/scripts/events/lib/config.js","hash":"f78cd74b25cc0ef65c060fec1d7e056967e26b4b","modified":1645863504164},{"_id":"themes/next/scripts/events/lib/highlight.js","hash":"00cec6980cafd417def885f496371856cd524a25","modified":1645863504164},{"_id":"themes/next/scripts/events/lib/utils.js","hash":"7bdf8588563cd13a1eb7a2c5bcffd831855b59a0","modified":1645863504165},{"_id":"themes/next/scripts/events/lib/injects.js","hash":"1f1ea7b579a49f17574c31d78d663c54896133eb","modified":1645863504164},{"_id":"themes/next/scripts/events/lib/vendors.js","hash":"09cba2c433fe47981d07d67c038790f4fc2ec16b","modified":1645948932820},{"_id":"themes/next/scripts/filters/comment/changyan.js","hash":"17fbc99521440a5d6c32ac991ba2038a12f86b31","modified":1645863504166},{"_id":"themes/next/scripts/filters/comment/common.js","hash":"713056d33dbcd8e9748205c5680b456c21174f4e","modified":1645863504166},{"_id":"themes/next/scripts/filters/comment/disqus.js","hash":"3283bdd6e5ac7d10376df8ddd5faaec5dc1bd667","modified":1645863504167},{"_id":"themes/next/scripts/filters/comment/default-config.js","hash":"1cb58aa6b88f7461c3c3f9605273686adcc30979","modified":1645863504166},{"_id":"themes/next/scripts/filters/comment/disqusjs.js","hash":"70eb507ef7f1a4fc3ca71a3814cc57afe7f3f60c","modified":1645863504167},{"_id":"themes/next/scripts/filters/comment/gitalk.js","hash":"96e58efba0dc76af409cc7d2db225f0fe4526ea8","modified":1645863504167},{"_id":"themes/next/scripts/filters/comment/isso.js","hash":"c22cbccd7d514947e084eeac6a3af1aa41ec857a","modified":1645863504167},{"_id":"themes/next/scripts/filters/comment/livere.js","hash":"bb8ebb541c40362c0cbbd8e83d3b777302bb6c40","modified":1645863504168},{"_id":"themes/next/scripts/filters/comment/utterances.js","hash":"a50718c081685fd35ff8ea9ca13682c284399ed8","modified":1645863504168},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"c4537fa2de33d98baff2c87a73801770414e0b69","modified":1645863504192},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"0fa7516da1175628216621c1ac3b8eeff7e7a210","modified":1645952357075},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"58014a2d087c4126058a99b5b1cb7d8a2eb6224d","modified":1645863504207},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"ab7d6cced9dfa0a5141f0d0ece5afd675214a143","modified":1645947293096},{"_id":"themes/next/source/css/_variables/base.styl","hash":"0f403f7dc1eb1ea75d71f051df584a9c58f5bf55","modified":1646023187628},{"_id":"themes/next/source/js/schemes/muse.js","hash":"b05dd5cc085684f9808e1d9d9e297b72af74e306","modified":1645938721740},{"_id":"themes/next/source/js/third-party/fancybox.js","hash":"8a847a7bbdbc0086dd1de12b82107a854b43f5e5","modified":1645863504207},{"_id":"themes/next/source/js/third-party/pace.js","hash":"0ebee77b2307bf4b260afb06c060171ef42b7141","modified":1645863504207},{"_id":"themes/next/source/js/third-party/quicklink.js","hash":"5b0197e061f57e00875be3636ba372a67693abe0","modified":1645863504207},{"_id":"themes/next/source/js/third-party/rating.js","hash":"a1f44247c18ac00ee3e0026560398429e4c77dd7","modified":1645863504207},{"_id":"themes/next/source/css/_common/components/index.styl","hash":"991c1f80995cec418dc00d3d6b13e2d911ac9894","modified":1645863504178},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"d1ecc87bc7efc4c3804c0a5fedca038a23cda374","modified":1646020120610},{"_id":"themes/next/source/css/_common/components/reading-progress.styl","hash":"f3defd56be33dba4866a695396d96c767ce63182","modified":1645863504183},{"_id":"themes/next/source/css/_common/outline/index.styl","hash":"7782dfae7a0f8cd61b936fa8ac980440a7bbd3bb","modified":1645863504189},{"_id":"themes/next/source/css/_common/outline/mobile.styl","hash":"2db4462e9cb87b8aef3f50f850fed407de16da3e","modified":1645863504190},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"cbd263b341b986f202d965d85fce51f140d2e5c4","modified":1645939719220},{"_id":"themes/next/source/css/_common/scaffolding/buttons.styl","hash":"f768ecb2fe3e9384777c1c115cd7409e9155edd7","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/comments.styl","hash":"cf8446f4378dcab27b55ede1635c608ae6b8a5c8","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/index.styl","hash":"43045d115f8fe95732c446aa45bf1c97609ff2a5","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"6d740699fb6a7640647a8fd77c4ea4992d8d6437","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/pagination.styl","hash":"34416a5792d0235caa8c0c7e59725f2df0fa614c","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"b9388016f8d9274703e77e306a1feaad1b7b9d6c","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"f51b6a4f06359ed56b2d10caa6f15362d3b3751d","modified":1645956138618},{"_id":"themes/next/source/css/_common/scaffolding/toggles.styl","hash":"90f7d3baab061e860172b536c9edc38c7fd2ef5c","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"607117c6ccb89567821ecdc85deaaa4ea54413c7","modified":1645969357472},{"_id":"themes/next/source/css/_schemes/Mist/_layout.styl","hash":"00366a6bd1a66f99f845c5ebfc9e8cf56651b815","modified":1645940216580},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"f337981f8f20944ed366694aea88146c7b0a13ab","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expand.styl","hash":"e3947971819f6bb25841fcd2e3c6cbf147992f23","modified":1645963633703},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"89bf3f6b82cb0fafbbd483431df8f450857c5a0b","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"9d38cc9406e22a631e14e86c96e7430a1357b007","modified":1645939420132},{"_id":"themes/next/source/css/_schemes/Muse/_header.styl","hash":"fd89988442f380cba907752fe3f608e3498f8c93","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"28030c61288cc0e1321b18373a5c79029fd76a53","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Muse/_sidebar.styl","hash":"2ffe0aedf02d117ae923eff200489bc6c9edea07","modified":1645966269889},{"_id":"themes/next/source/css/_schemes/Muse/_sub-menu.styl","hash":"2d3e05015796a790abd9d68957a5c698c0c9f9b6","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"25c2a7930da14f023329df20f38df2728057fb4d","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Pisces/_header.styl","hash":"9b2cba0c9aa5a64957294f7548c199db1f63f0f4","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"9f60d501808f67d151af437221d0dfacc27c180c","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"1d29eca70fa686d895f8e98a283e4a159e40905a","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"b5c3dd08c520a16ee49f85fa12b4935e725ef261","modified":1645863504192},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"08f23c34c19da2358a89a0ecb3230923cf4e60f4","modified":1645946275821},{"_id":"themes/next/source/js/third-party/analytics/baidu-analytics.js","hash":"f9579a02599de063ccff336177ba964a2931a6e9","modified":1645863504207},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"5939a60215255a212f80096cbd7be605df8faedd","modified":1645952344251},{"_id":"themes/next/source/js/third-party/analytics/google-analytics.js","hash":"d77d4934d959e7125128754b568f1d041c3fbfff","modified":1645863504207},{"_id":"themes/next/source/js/third-party/analytics/growingio.js","hash":"f755e8537ccbbb0bd84c26923f320d4e206e7428","modified":1645863504207},{"_id":"themes/next/source/js/third-party/chat/chatra.js","hash":"72e0766752b78a723fb30e92d533a8b353104e2d","modified":1645863504207},{"_id":"themes/next/source/js/third-party/chat/gitter.js","hash":"14b024c920a8b359777d79dd8e1a849387f8f3ad","modified":1645863504207},{"_id":"themes/next/source/js/third-party/chat/tidio.js","hash":"77c231bcd64f1c09bd9989909e9fee703b65f47f","modified":1645863504207},{"_id":"themes/next/source/js/third-party/comments/changyan.js","hash":"b4cb06fdf531292e2361398a98d75a4ca2b8473a","modified":1645863504207},{"_id":"themes/next/source/js/third-party/comments/disqus.js","hash":"5460de247c038d6cfbe774d7f8747f0a958d9017","modified":1645863504207},{"_id":"themes/next/source/js/third-party/comments/disqusjs.js","hash":"1c282d6c2151346d1f0aa95055d17abe77054ec9","modified":1645863504207},{"_id":"themes/next/source/js/third-party/comments/gitalk.js","hash":"1e8509356fb027d948d118ab220d9631f4d482fa","modified":1645863504207},{"_id":"themes/next/source/js/third-party/comments/isso.js","hash":"b9b9fd2f0e098a123b34a4932da912a9485ffe6c","modified":1645863504207},{"_id":"themes/next/source/js/third-party/comments/livere.js","hash":"68892d74ef5fc308c6e7e6b4f190826d79f3055d","modified":1645863504207},{"_id":"themes/next/source/js/third-party/comments/utterances.js","hash":"ec44d7f1c8b51b0aa3cccba099a78f3575ac828c","modified":1645863504207},{"_id":"themes/next/source/js/third-party/math/katex.js","hash":"5c63ec71458b4fe0cd98fd4a04e11c3746764f11","modified":1645863504207},{"_id":"themes/next/source/js/third-party/math/mathjax.js","hash":"d93556184b2c0aa1dbc4a6fb892d2f77b80d7d9f","modified":1645863504207},{"_id":"themes/next/source/js/third-party/search/algolia-search.js","hash":"ea94731438d8c518d946601f8f46a65b92381fac","modified":1645863504207},{"_id":"themes/next/source/js/third-party/search/local-search.js","hash":"dc2b0e89aa32afc7f7a7e2d7a277dadb7f96e06d","modified":1645893724123},{"_id":"themes/next/source/js/third-party/statistics/firestore.js","hash":"d0829fe41d2fe86b8499e2a896556c1275ea0066","modified":1645863504223},{"_id":"themes/next/source/js/third-party/statistics/lean-analytics.js","hash":"6abdc209f4503d4efd676e18bc30ddea813b6ff9","modified":1645863504223},{"_id":"themes/next/source/js/third-party/tags/mermaid.js","hash":"2618135cbcee6bf228f6734767de1995e5eaaac6","modified":1645863504223},{"_id":"themes/next/source/js/third-party/tags/pdf.js","hash":"e109c2d6828f527f0289d5fa3bb02fce63ee6d93","modified":1645863504223},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1477558306000},{"_id":"themes/next/source/css/_common/components/post/index.styl","hash":"df2fbd0ada00f37439b0de965c6f1c29d3c97429","modified":1645863504180},{"_id":"themes/next/source/css/_common/components/post/post-body.styl","hash":"4626bacb6b8cae52bb967d1038cf0199d1251ea6","modified":1645964615580},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"d864773c84e43c5bbd79d6ada2c56be220d25beb","modified":1646066141287},{"_id":"themes/next/source/css/_common/components/post/post-footer.styl","hash":"e53a5eb1d1771e284044bdb0bc0ed2de27923669","modified":1645863504182},{"_id":"themes/next/source/css/_common/components/post/post-followme.styl","hash":"791bc9befb0d4d06e3e517eccfe0bc3551a02a60","modified":1645863504181},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"c34936a17c3d8af6c0988ac6746d7509dc0b50eb","modified":1645863504182},{"_id":"themes/next/source/css/_common/components/post/post-header.styl","hash":"bbff3d9d92ff1b81b58de9f1964d02b95b87b623","modified":1645956864634},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"69dff7cf231d01f85671758455726dd666664a73","modified":1645863504183},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"9043d9bc2db35ca000c79258ef89fdb161dc43fb","modified":1645863504183},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"0a779f955a0e25df0852e0731517dadb234aa181","modified":1645863504183},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"fde10ce94e9ae21a03b60d41d532835b54abdcb1","modified":1645863504179},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"80595d274f593b321c0b644a06f3165fe07b16f5","modified":1645863504179},{"_id":"themes/next/source/css/_common/components/pages/index.styl","hash":"6cf78a379bb656cc0abb4ab80fcae60152ce41ad","modified":1645863504179},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"091b8c763e43447d087c122a86538f290f83136a","modified":1645863504179},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"12c900ede5438395250722eae44a40f45128432a","modified":1646065953689},{"_id":"themes/next/source/css/_common/components/third-party/disqusjs.styl","hash":"c1e9edbfd1c3696b35d5452ae2e6d766f3fe91aa","modified":1645863504184},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"fb165c1a0d990c5cf98b87773e0dc50410229b96","modified":1645863504184},{"_id":"themes/next/source/css/_common/components/third-party/gitter.styl","hash":"7b36f776c41fbb744572c5de2c8d49b35656ec21","modified":1645863504185},{"_id":"themes/next/source/css/_common/components/third-party/index.styl","hash":"0c4c5e39f8ac12febaa0f4ff7265151e139edad8","modified":1645863504185},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"1e5776ad4c5c8bcf7596ac74dcabc30704b3f5a0","modified":1645863504185},{"_id":"themes/next/source/css/_common/components/third-party/search.styl","hash":"49c26184580fde8a732899a4de5aae8662e289b8","modified":1645863504186},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"0527153aa821bdbdb84c7b47f60e3cefd95a742f","modified":1645863504186},{"_id":"themes/next/source/css/_common/components/third-party/utterances.styl","hash":"d28856f365a9373c4ae6fe1e5673d63df2dfd65f","modified":1645863504186},{"_id":"themes/next/source/css/_common/outline/header/bookmark.styl","hash":"c8648c8ea3105556be0068d9fb2735261d0d94bc","modified":1645863504187},{"_id":"themes/next/source/css/_common/outline/header/github-banner.styl","hash":"05af22f3edc2383a3d97ec4c05e9ac43b014bead","modified":1645863504188},{"_id":"themes/next/source/css/_common/outline/header/menu.styl","hash":"2db695204d39e4c7daa7b91585a0ea4b06b49f11","modified":1645863504188},{"_id":"themes/next/source/css/_common/outline/header/index.styl","hash":"67fc7a1eb59c8451eec34e572cbb2fd1424757bc","modified":1645863504188},{"_id":"themes/next/source/css/_common/outline/header/site-meta.styl","hash":"86b0925e968f35bbc76b473a861e8f9797f7580e","modified":1645863504189},{"_id":"themes/next/source/css/_common/outline/header/site-nav.styl","hash":"d9bc2b520636b9df7f946295cd430593df4118ff","modified":1645863504189},{"_id":"themes/next/source/css/_common/outline/footer/index.styl","hash":"f2f5498a3798d6a66a455f8170bcebc0496ee12d","modified":1645938668236},{"_id":"themes/next/source/css/_common/outline/sidebar/index.styl","hash":"6cec28209076c1feeec89e866da653008394d133","modified":1646064545261},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"2c2bfbc34b6f19d262ae7c041474985e12f4f4ad","modified":1645863504191},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"2732f3ff32256e3ad80222ae22252075d7b73744","modified":1645975015093},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"1c324d56ae83e96db2c4c6d63edd7ee51c936fc1","modified":1645863504191},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"63d8f5f169c2b1c969928fc79244c5fe89ee484e","modified":1645863504192},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-dimmer.styl","hash":"09bed6818f55729c74214528e49b396a951e688a","modified":1645892571916},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"8aac130364803c613e916d03a703f93a21d1ae32","modified":1645963282100},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"a586566bd12b85a431cdda0fb8bcd003c17c5324","modified":1645966949177},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"6681ffe283f8a7e3c86310ef4f6ca1e499c1a19f","modified":1645863504192},{"_id":"themes/next/source/css/_common/outline/sidebar/site-state.styl","hash":"2de038def2cb91da143b14696366c14a66e0e569","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"a4003e1408844568cb5102a5a111046cb19b2d31","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/highlight/index.styl","hash":"ee05c1d00bc38397bd320128bbe15d05d9100039","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"6b3680e0dbea8e14c1cec24ef63b7fae5e37f7ef","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"8d9218980e185210ce034e9769ab639b9630fd88","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tags/index.styl","hash":"e22fde6f1657d311d46f64d868c4491d535c8caa","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tags/label.styl","hash":"531daf2612c6217950677a2d03924459ce57c291","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tags/link-grid.styl","hash":"7075dd32dd70da1e161e4bd14b46f1e8be62fa3c","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tags/mermaid.styl","hash":"c7754dc6c866928b538f0863a05b96ec44b5e986","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tags/note.styl","hash":"2e9dc3b3546e19e9de18050ad04b1741841116bc","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tags/pdf.styl","hash":"77122986509a6b4968bae2729417b7016137534c","modified":1645863504192},{"_id":"themes/next/source/css/_common/scaffolding/tags/tabs.styl","hash":"40a38f2129617ffd4e8d5cd78e982fdfc9941acf","modified":1645863504192},{"_id":"themes/next/source/js/jquery.js","hash":"255057d893d00bf46df9a1471672e5a68d67199d","modified":1626582637617},{"_id":"themes/next/source/js/mo.min.js","hash":"4c69f052549568088af3f84b46830a24e7dfc97d","modified":1626582732969},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1477558304000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1477558304000},{"_id":"themes/next/yarn.lock","hash":"d5de7e059870af5239d49d6cc5837fd9ca56031d","modified":1646012504787},{"_id":"themes/next/source/js/valine.min.js","hash":"f589db019c63721dd9c3bbe3a54781d20f6fa2c6","modified":1645327055004},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1477558304000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1477558304000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1477558304000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1477558304000},{"_id":"source/_posts/images/AQS-.png","hash":"045942daf5e0e0a332e6dd04b36decaedc15c27d","modified":1620914628881},{"_id":"source/_posts/Java - AQS.md","hash":"b21b51d630e0f8283d3a2eaa30754876d7a4c068","modified":1646045452547},{"_id":"source/_posts/Java - Callable.md","hash":"3955cd15a071b1db1d5a94cc87182c8491251486","modified":1646045966090},{"_id":"source/_posts/Java - ForkJoin.md","hash":"ed8b80695275f315cabeb9a8dc4b1a25e44b0898","modified":1646042887552},{"_id":"source/_posts/Java - ArrayList.md","hash":"b62a6f32ca137b854c66fd447da4b77a82598fae","modified":1646045725623},{"_id":"source/_posts/Java - JMM .md","hash":"321566add3fb0bcea099647017d269b48d37c923","modified":1646045770790},{"_id":"source/_posts/Java - ReetrantLock.md","hash":"65d5bcb3605707e4b9dfd0893134a1976c72033d","modified":1646045659446},{"_id":"source/_posts/Java - JUC .md","hash":"b3a3d84cf18ee7b2f7ea22664b4c3d1f39f17f13","modified":1646045746153},{"_id":"source/_posts/Java - Queue.md","hash":"148524dfbcfba4eda280ec3efe9343966fff34c5","modified":1646045419795},{"_id":"source/_posts/Java - Semaphore.md","hash":"45707f270c00ef321fe5963de9e0099b612635c1","modified":1646045801123},{"_id":"source/_posts/Java - interrupt+isInterrupted.md","hash":"b7a0d0d9526241c52921208aba092db27f3c7bf6","modified":1646045700713},{"_id":"source/_posts/Java - synchronized.md","hash":"db1a47dd4eb6e94b6f513a357b58d774acfcf6a4","modified":1646045367154},{"_id":"source/_posts/images/CAP - 1.png","hash":"551fe33f13c2f947de0402818e18222d2f27e956","modified":1622164850464},{"_id":"source/_posts/images/Aware - .png","hash":"280869274c59012eebf7f6f2c177792be27f5fbc","modified":1621434630177},{"_id":"source/_posts/images/CAP - 2.png","hash":"951f5c62d65bae2789be97db59ffbab1dd4ab212","modified":1622164914131},{"_id":"source/_posts/images/CASAAB.png","hash":"4fdb6156ef699cfbba4f41355d581dee7118b109","modified":1617806398041},{"_id":"source/_posts/images/CPU.png","hash":"c3d0fc6735c910ac2273df44aba86101387f53e4","modified":1617672837044},{"_id":"source/_posts/images/ClassLoader.png","hash":"e9716ed140d78f32d6e438af2e957d421676787a","modified":1629905424777},{"_id":"source/_posts/images/ClassLoader.png","hash":"8bc867a0c026d0f5ea917129c0c2d5855a2871d9","modified":1629905297742},{"_id":"source/_posts/images/ConcurrentHashMap - sizeCtl.png","hash":"36e586e17dee50b9358e29c205a36cec154b303c","modified":1621779813066},{"_id":"source/_posts/images/HashMap_Resize.png","hash":"3751ebc345d81508c88e1de7167cf62160896b7b","modified":1617290063525},{"_id":"source/_posts/images/HashMap.PNG","hash":"8f199e930fb8c91364f0194e1226f327a9ea128f","modified":1617108418486},{"_id":"source/_posts/images/JDK1.7-ConcurrentHashMap .png","hash":"6a6e9d818ba509d430d9ed7728daa65b54782538","modified":1619749407503},{"_id":"source/_posts/images/JDK1.7-ConcurrentHashMap .png","hash":"5e6ff7991dd3e7285555debf301221d0013b80f8","modified":1619749441473},{"_id":"source/_posts/images/JDK1.7-ConcurrentHashMap .png","hash":"089b6ca2a179992a06604555b31837e536edc646","modified":1619749171034},{"_id":"source/_posts/images/JDK1.7-ConcurrentHashMap .png","hash":"f8246dd5300c73fd77eba24430ab414967414c94","modified":1619749273409},{"_id":"source/_posts/images/JMM.png","hash":"316bef2d71ec11e2a34d190dfa91d3d3badb8f12","modified":1617634368473},{"_id":"source/_posts/images/JDK1.7-ConcurrentHashMap .png","hash":"82aa7141d42a550fb9e25761adf04e0c35b7dcca","modified":1619749203033},{"_id":"source/_posts/images/JDK1.7-ConcurrentHashMap.png","hash":"fe89837875afca67e6d57b20b73d2adaab864c99","modified":1619747679608},{"_id":"source/_posts/images/JVM - .png","hash":"8f5d05efd50c3effa2eb5f7b57e6cea298bad356","modified":1633704222215},{"_id":"source/_posts/images/JVM - .png","hash":"d6257acc7f0802a59f4a9d7731dd0c1949fd8e92","modified":1640103628174},{"_id":"source/_posts/images/JVM - .png","hash":"682b8a9105bb1baaea6ca366236745b4c854af3b","modified":1639900480498},{"_id":"source/_posts/images/JVM - NGC.png","hash":"aa78d986d5aeddfe5115ae0bd91eba143f4a2000","modified":1634569119607},{"_id":"source/_posts/images/JVM - GC.png","hash":"c3e878077a4f7c5c6ae53cefa311e1d3c4cf909d","modified":1634568655947},{"_id":"source/_posts/images/JVM - GC.png","hash":"20f47ec611c404b10a75640f554fdcbb4c4404e7","modified":1634568958777},{"_id":"source/_posts/images/JVM - .png","hash":"8e748f623b89042219a1fa2d828c5f4677b41bbe","modified":1629623373807},{"_id":"source/_posts/images/JVM-Xmxsize.png","hash":"a6fa818ce4e52d35e33eb645a2e4f0f955629e5d","modified":1633598191988},{"_id":"source/_posts/images/JVM-doublelongslot.png","hash":"7acdd6d93fce52949cf3c6d090cdc38bae240710","modified":1631432406735},{"_id":"source/_posts/images/JVM-.png","hash":"c313894e72a4e01ca71eab6942d8453d679c013e","modified":1631338723215},{"_id":"source/_posts/images/JVM-doublelong1slot.png","hash":"88070e2f348489629805a5ad9b09e7b7cdc286f4","modified":1631432531543},{"_id":"source/_posts/images/MQ-.png","hash":"875746e29400c3c4575b73f3e8ade0f5d888b277","modified":1624081290213},{"_id":"source/_posts/images/MySQL - MyISAM.png","hash":"32ca44d76c8d08dfaba3c7709bdedee477c190dd","modified":1630939843777},{"_id":"source/_posts/images/MySQL - MyISAM.png","hash":"86ba6c53c015028dfdcf488292fb61f73bf1eb56","modified":1630939874953},{"_id":"source/_posts/images/MySQL-B+.png","hash":"23c472942c8362939d37ec1326f236e82e4272ff","modified":1630939794276},{"_id":"source/_posts/images/MySQL-BTree.png","hash":"9a1ee05061e98bd665a94f63222e06b9493c02ec","modified":1630939597592},{"_id":"source/_posts/images/MySQL-BTree.png","hash":"b3e8e468a2f60b88e5f0bc190b770cc186491c37","modified":1630939731233},{"_id":"source/_posts/images/MySQL-MVCC(2).png","hash":"dfc2cf63006cfebd68c9d7833b40b762cbe107bd","modified":1630940103442},{"_id":"source/_posts/images/MySQL-B.png","hash":"3415bf6a5f6bc93fac4b16d49b32f0dd2152277c","modified":1630939771110},{"_id":"source/_posts/images/MySQL-MVCC(3).png","hash":"301577384c48e56af9011c15ab98f8a0489a8950","modified":1630940126406},{"_id":"source/_posts/images/MySQL-MVCC(4).png","hash":"359c9429f6d529549d18f5502d87710276e4349c","modified":1630940146787},{"_id":"source/_posts/images/MySQL-MVCC(1).png","hash":"2ef98d6e61cc72c7ae0871276b10c55c5b16b10f","modified":1630940076316},{"_id":"source/_posts/images/MySQL-MVCC(6).png","hash":"db915046b68fdfd8224af88bb6cc768ea9f244e8","modified":1630940206208},{"_id":"source/_posts/images/MySQL-SQL.png","hash":"a2bb9054dab95db53e365c85ee679df86b1a7544","modified":1630940802041},{"_id":"source/_posts/images/MySQL-MVCC(5).png","hash":"c7f782dcf44d21ee4e262132e6e00f1fb8a84b54","modified":1630940166430},{"_id":"source/_posts/images/MySQL-.png","hash":"74a85942d3f0a82aa9195261ce77c1ab99af61ff","modified":1630940988419},{"_id":"source/_posts/images/MySQL-.png","hash":"32c1afd1795df20e21f1a59433cdc24ddeeefde3","modified":1630940953087},{"_id":"source/_posts/images/MySQL-id.png","hash":"09a92fd76b5f68227a3f76a60531f7b756fb8712","modified":1630940887180},{"_id":"source/_posts/images/MySQL-(1).png","hash":"3a989f94d51c96566c51cc348a43efca679f3c6c","modified":1630940369408},{"_id":"source/_posts/images/MySQL-(2).png","hash":"aa9b7191f1f7ecf862ef597745ce25cf70989103","modified":1630940398421},{"_id":"source/_posts/images/MySQL-(3).png","hash":"0eb3a02952fa7392fa967ee063650cd7365d3def","modified":1630940434686},{"_id":"source/_posts/images/MySQL-.png","hash":"4131a0fa2dc0c683b7ce83bcd786618d269bf09a","modified":1630940228519},{"_id":"source/_posts/images/RabbitMQ - Exchange.png","hash":"317a99169ea7856dc0e5164cab043dbf2d3811b8","modified":1624100000029},{"_id":"source/_posts/images/RabbitMQ - Topic Exchange.png","hash":"c11bae66b21e4f7dd627b7226f36803c5a094758","modified":1624110939548},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"15048164aac59651d03ce611f6be9ccd2e594648","modified":1624693853529},{"_id":"source/_posts/images/RabbitMQ - Topics.png","hash":"cb480452456a04777c3d0d5355f4808be88c53ac","modified":1624110320224},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"a64f0792db2a5b6d208eb5020a1e73ed7fd855ae","modified":1624544566125},{"_id":"source/_posts/images/RabbitMQ - VirtualHosts.png","hash":"8c86765c42a1c93f2ab496e289738870e0b2792b","modified":1624088977800},{"_id":"source/_posts/images/RabbitMQ - -.png","hash":"f52493699bf6c764f7e52b397db6f64316bd02b9","modified":1624623165716},{"_id":"source/_posts/images/RabbitMQ - -.png","hash":"56c01862afc4a77f67a64422ee66a924d1bfcebd","modified":1624630111786},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"73cd07ceff17621017decefeefda2ca0abcb6fd8","modified":1624096792407},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"72771904df801fce745dac633dc12eafbdae9792","modified":1624543442064},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"a3d967cc60e48e9293553255ba79d327db638ed7","modified":1624094556264},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"36622f805f41b57ac28716c0284ca04fa1a1146e","modified":1624596660975},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"b134fe799028a130aef221bdcf9e80bd4831bc16","modified":1624709653121},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"68299edb12b7d61ff4c4f7edff9f518db04b5192","modified":1624088362485},{"_id":"source/_posts/images/RabbitMQ - Virtual Hosts.png","hash":"7629a6e990de20e514ccead3e7a3fe450a08fd9c","modified":1624089059720},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"b3676abacdc64a26f64919763373dc5c86cfee81","modified":1624104864036},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"1e066682c8d4223d47d7e213c6dad1d953932646","modified":1624094463104},{"_id":"source/_posts/images/RabbitMQ-VirtualHosts.png","hash":"fb637f9590c1f982c64f1adddc5200fb740a492f","modified":1624089016707},{"_id":"source/_posts/images/SQL -  order by rand().png","hash":"32699aac407cc4ed8b4bf4ca1de81067d25cd249","modified":1624781091123},{"_id":"source/_posts/images/SQL -  order by rand().png","hash":"83a61e3d23b72284913a4bff4fedb68b629ec980","modified":1624781381067},{"_id":"source/_posts/images/Socket - API.png","hash":"89eec1ed22a2663fc3febeb75f8b078ea0e292e7","modified":1623168184721},{"_id":"source/_posts/images/Spring.png","hash":"a789a078fbc6e2507bc4902e0160ac9d854a7505","modified":1619487063063},{"_id":"source/_posts/images/ThreadPool.png","hash":"0378bbde87978189341f7c19145b48fc5765f95a","modified":1617547787212},{"_id":"source/_posts/images/Unsafe.png","hash":"08a46f8726718ca069722e125b6dc9945afcbf5a","modified":1619743340039},{"_id":"source/_posts/images/newJVM.png","hash":"678d6706f27d5ad2a465b9918c318072b4e9e724","modified":1624965872634},{"_id":"source/_posts/images/rehash.png","hash":"e9b3210ce69ddd00e40d3ffcdf408c82d0728737","modified":1617289636856},{"_id":"source/_posts/images/spring-beandefinition.png","hash":"f0e951d4c5b9cdb10622d0c9e78cf9945c4c13b0","modified":1618902103204},{"_id":"source/_posts/images/strategy_1.png","hash":"502b290ef8e04f369ff859e2d1f3c737daf12129","modified":1612071331097},{"_id":"source/_posts/images/wrapper_1.png","hash":"2d9a81f93b580b2f4c49b5c6297d574bed357aef","modified":1612455550629},{"_id":"source/_posts/images/DI - .png","hash":"33b5972c0529e0f6b31ae90da8ecc046bd35b560","modified":1618542096625},{"_id":"source/_posts/images/DI - .png","hash":"44c5a8206a863ac73dee176a9920f87dae7fce97","modified":1618541168424},{"_id":"source/_posts/images/ - binlog.jpg","hash":"0bb1ef0c6dc4520e47502a3c958e490a20b76910","modified":1624964374401},{"_id":"source/_posts/images/ - .jpg","hash":"6a37ca0d16cd566adc8e50e910af6504a4048d2f","modified":1624964640012},{"_id":"source/_posts/images/ - .jpg","hash":"4922cd99ecd46f70202066d16ac6da3ef9919e80","modified":1624964514513},{"_id":"source/_posts/images/-2PC.png","hash":"b29d1182259a68a249d93ea41ed2356a452a2685","modified":1622181860038},{"_id":"source/_posts/images/ - .png","hash":"ac5337091ff01bd3f850f8e97ce6efc9f090f2ee","modified":1618387643505},{"_id":"source/_posts/images/ - .png","hash":"82c0498dfc4536cc3be744656b8bf8bc5b68f139","modified":1618386897665},{"_id":"source/_posts/images/ - .png","hash":"a68e50b68d0211a897f9340ce0bc8ab6c443c54f","modified":1618385506784},{"_id":"source/_posts/images/.png","hash":"099b9d47d260ca4988b160f027ac72df428ba1c6","modified":1629610969167},{"_id":"source/_posts/images/.png","hash":"c22fc8c8010c006be2f1b48d9f4963b8a212bfd9","modified":1618366974470},{"_id":"source/_posts/images/CPU.png","hash":"9c41b372394ba05998577d6521c1cdd7b61c6500","modified":1617674029808},{"_id":"source/_posts/images/ClassLoader.png","hash":"8237f15d9d7da8cd827f476a77a4f2eb58b64e17","modified":1618714708238},{"_id":"source/_posts/images/CopyOnWriteArrayList - .png","hash":"1fed83017f6fede76d99ced89e3b74491ac2ff70","modified":1622421801898},{"_id":"source/_posts/images/HTTP - .png","hash":"3ac670959ad9f4073119036d9c1b3b73cc4810c5","modified":1623333819723},{"_id":"source/_posts/images/JDK1.7-ConcurrentHashMap .png","hash":"35bf2e8d67550089d5ba623e1c9b20cb0900bf3d","modified":1619749369337},{"_id":"source/_posts/images/JVM - C2.png","hash":"eaf1779a50afaa90a77058b7f6ff1187debc1781","modified":1640102421689},{"_id":"source/_posts/images/JVM - GC.png","hash":"67feb98282741a7b6fa18eab3de2781655b8805f","modified":1634569228884},{"_id":"source/_posts/images/JVM - .png","hash":"cafca025ded5d0246b35f3c436a9515231dc2061","modified":1640102606387},{"_id":"source/_posts/images/JVM-slot.png","hash":"fac94697967fafe5e399475ec73ba67917e3be87","modified":1631433172035},{"_id":"source/_posts/images/JVM-slotthis.png","hash":"71dff36d6ed180bd310553608817c120d4d2ecdb","modified":1631431421462},{"_id":"source/_posts/images/JVM.png","hash":"2310d8ef43786d1d768254f983a8c2d017aeda92","modified":1618119246858},{"_id":"source/_posts/images/JVM-this.png","hash":"e6d25025cb0d226d5d647816d4c39283b4ba71cd","modified":1631431243918},{"_id":"source/_posts/images/JVM.png","hash":"6dfc98afc74ec82c7f735bd6f046023ba9b74ff7","modified":1618120220750},{"_id":"source/_posts/images/JVM.png","hash":"f3b9964c8dc0b9ac552afabca42674d483beb6ea","modified":1618119332528},{"_id":"source/_posts/images/JVM.png","hash":"b675f3fff2208baf99bace0f12320748ccb67c0a","modified":1627224080888},{"_id":"source/_posts/images/JVM.png","hash":"c7130a2fb40458bc4f30d75eabda9493d49ef4a7","modified":1618120094181},{"_id":"source/_posts/images/JVM.png","hash":"e0debcbc9f23777647f30d51a909d515a1aa50fc","modified":1618119182418},{"_id":"source/_posts/images/JVM.png","hash":"3018682773e3e1e5c397c2008196b27951b5ce69","modified":1618119880778},{"_id":"source/_posts/images/JVM.png","hash":"6460d99a27de3243fa3515920969fb98cb85d842","modified":1629623182539},{"_id":"source/_posts/images/Java.png","hash":"1c450c2ad35e3e2a925abf63352b6761bd135135","modified":1629627357179},{"_id":"source/_posts/images/Java1.png","hash":"0786bedf30e33f694ca26da80b816870ce938b7b","modified":1618121562942},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"1046db85e20803398b7caf5fb8215d17ab5f0d75","modified":1624085206664},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"c237dae7338f5d7daf117998c0de0476d860332a","modified":1624089842492},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"cf05ddd49ba7dac0755ee0647bb00740d6a37ac0","modified":1624089753524},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"4c7342ccfc059dc1b57a3b68f396e29293ab94c3","modified":1624090364281},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"f3f30bb903a170148b62c92726d8bfad36368588","modified":1624596013318},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"d225c53a7d44e8f9e463b0de963e3f260b288532","modified":1624115088035},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"b3b535658e2d072633d1cefa00e79ee1cc5e27d3","modified":1624288304273},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"2fb716a98187f7008bfcef0d89f5d278439ae4fb","modified":1624178469153},{"_id":"source/_posts/images/Socket.png","hash":"826d8f693eb6e0548a997068e25418073cc719c4","modified":1623168124244},{"_id":"source/_posts/images/Spring BeanDefinitionReader.png","hash":"20b8993500110b276c266af2b7c90951101240bf","modified":1619492758048},{"_id":"source/_posts/images/Spring - .png","hash":"82c12df23736aa43b5929a661d67923c26825dd9","modified":1624788778791},{"_id":"source/_posts/images/UDPTCP.png","hash":"bd04666bcc0d1053b5cfba83d9faef704ea933cb","modified":1623167843238},{"_id":"source/_posts/images/.png","hash":"6df8722d808db9d71de90bdf03fed588ca510f9e","modified":1618154234041},{"_id":"source/_posts/images/.png","hash":"db021710093b68c890a7cfa97f1ee8b6f9a6b3b5","modified":1618154191306},{"_id":"source/_posts/images/.png","hash":"b37ce57e0a20f2aecdbf23a3d8ce6a8f096d3edf","modified":1618154112013},{"_id":"source/_posts/images/.png","hash":"e46cd337f90ffc32ee70049b88080586c0801e6a","modified":1629621645440},{"_id":"source/_posts/images/.png","hash":"cf05c6cb911b6e657fcbf20bd325e306d0f8d498","modified":1618215269994},{"_id":"source/_posts/images/.png","hash":"3682718b8428a87a79504b342861058ebe5eff6d","modified":1618155746621},{"_id":"source/_posts/images/.png","hash":"28fe834812b6df1846c1ec92c4d3e5d9168e0518","modified":1618157024239},{"_id":"source/_posts/images/.png","hash":"7f73b292a61f960621445521303d4593b79a08a6","modified":1618156315231},{"_id":"source/_posts/images/.png","hash":"4be3d199236047b04c9c40eda60f63c1b3e302b1","modified":1618156468366},{"_id":"source/_posts/images/.png","hash":"8b643c7f9148ca64c23635261ccd1a67afb83875","modified":1618157243416},{"_id":"source/_posts/images/.png","hash":"1e57f2cde00b1ded089d47f3d4048b8f766fcdb5","modified":1618157506075},{"_id":"source/_posts/images/.png","hash":"81f66b4959bfa108dca6ad69731572870e133a7a","modified":1618157163441},{"_id":"source/_posts/images/.png","hash":"4b50f2e613245420cda0882be3f0ba7c86530d79","modified":1618156136059},{"_id":"source/_posts/images/.png","hash":"192d5903a972f26e58675f924afc35ad7edc40c9","modified":1618122515545},{"_id":"source/_posts/images/.png","hash":"add2a1304ed2d73cb38e17325b4120b288468dc6","modified":1618122549631},{"_id":"source/_posts/images/AQS-.png","hash":"7e7859f6e135e47b22194aa17e3dc83bd84f2f79","modified":1620969251794},{"_id":"source/_posts/images/ClassLoader-getResources.png","hash":"a3a97699a0f4668f0819968d6f7e2c02d8f5724a","modified":1618716020030},{"_id":"source/_posts/images/ForkJoin.png","hash":"d2e0b54687a8ec722e42fdaa0d9ec87d0855df23","modified":1617603389789},{"_id":"source/_posts/images/HTTP - .png","hash":"5b466755b4400e3a9b0de8b5d7aa6f3dfbfea041","modified":1623333881066},{"_id":"source/_posts/images/JSP.png","hash":"c51bf10dbc36e66417755e6c256cfa5f4fefb6d8","modified":1618328965817},{"_id":"source/_posts/images/JVM - Javac.png","hash":"86ea0f997a28af079b6fbf9e303f7744fa0344e1","modified":1640098874905},{"_id":"source/_posts/images/JVM - .png","hash":"037b3a9b0a72986f833d9e74d823ba11cd73d211","modified":1633704073688},{"_id":"source/_posts/images/JVM-PC.png","hash":"7d6d3b776a54b292b75ea314e0b1fbfbd339e6c1","modified":1631028636364},{"_id":"source/_posts/images/Java.png","hash":"05d25bad3cc783eaf8ecd71e5362771145c6483d","modified":1629614600780},{"_id":"source/_posts/images/Lock-ReentrantLock-Condition.png","hash":"f5f26fe48c680d278be4a9f1d6cc9de2372b4d63","modified":1619687619234},{"_id":"source/_posts/images/NIO - Buffer.png","hash":"44881f9efe7c5970560848e81eaf521849d19e6e","modified":1623335177653},{"_id":"source/_posts/images/OSI.png","hash":"180bca3d2028544eb6489ac53574c2dae3dd186b","modified":1623164177298},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"3b900979e094deccde161f60f2a624d31c0d3ed5","modified":1624095554935},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"a88da89ca575f3350e1aa58ac8bb3b481cf9b33f","modified":1624340236554},{"_id":"source/_posts/images/RabbitMQ - .png","hash":"a2cfb71ccfa8fc411ebaea141846119983cdeb18","modified":1624177822605},{"_id":"source/_posts/images/Spring ResourceLoader.png","hash":"c84ab2fc4bbd964b12bb657b42c9f0c3b55e24c8","modified":1619489552756},{"_id":"source/_posts/images/Spring-BeanFactory.png","hash":"6f6973c4dec570b049696a3e6047c3221f709162","modified":1618922055755},{"_id":"source/_posts/images/Spring5.png","hash":"5d1b367a7ac869b57031970f7b382518b1985341","modified":1618238724626},{"_id":"source/_posts/images/SpringFramework.png","hash":"e03f83ba551803aeceeabfec1add61f2773c353b","modified":1612705804298},{"_id":"source/_posts/images/SpringInputStreamSource.png","hash":"7abea6e87a0c62479c220cc70af8d36921cdeff5","modified":1619487955659},{"_id":"source/_posts/images/Spring.png","hash":"24b947909d90ef3ace48a045694c9894c4a0385f","modified":1618238845157},{"_id":"source/_posts/images/TCP.png","hash":"eb632600d5edec70be19a81c17211b32eec2526e","modified":1623164353346},{"_id":"source/_posts/images/.png","hash":"5da33e93a79dff87f9042faf04c180d19246f69b","modified":1613652033259},{"_id":"source/_posts/images/.png","hash":"4f483a1008cfe9a993591ab4f1a11e896727a292","modified":1618153209549},{"_id":"source/_posts/images/.jpg","hash":"a0cc44faa5bada844860ab656842915d8842ee19","modified":1618540600608},{"_id":"source/_posts/images/.png","hash":"028e6a5eb11bab322bc9ea0585979e6ac7ad3226","modified":1618215088495},{"_id":"source/_posts/images/.png","hash":"e668ae30f32368d680edb3e8fd34b3397e58756c","modified":1618156645712},{"_id":"source/_posts/images/.png","hash":"1b59d594a61998d95a691f680eafd1118a154dd7","modified":1618156910560},{"_id":"source/_posts/images/.png","hash":"b7a20301cbadfb6966e745697b39f70aba3a3f3d","modified":1618157453186},{"_id":"source/_posts/images/.png","hash":"82aa5a41ed4e1fa1d290555f7a5c01122dbbb6a5","modified":1618536961320},{"_id":"source/_posts/images/(monitor).png","hash":"8ce275486475b28587f8bf1f92732b15364298f7","modified":1619662768498},{"_id":"source/_posts/images/-.png","hash":"10e36e297329cea610712fc86b9550fc7468e919","modified":1618367128195},{"_id":"source/_posts/images/HTTP - .png","hash":"397458388b1fb1a2d9d1e6c79eb93f7d9f7f8bdf","modified":1623333737648},{"_id":"source/_posts/images/IOC.jpg","hash":"771bcaf6b4e96e69272ebaf9674ce212d2a30652","modified":1618540915983},{"_id":"source/_posts/images/JVM - TLAB.png","hash":"aa50f49d2ed00eb1322c336c0308853050e44d1e","modified":1635867183973},{"_id":"source/_posts/images/JVM.png","hash":"8c208a09ca14ac03c53f6ac427f9dcebc33f3be2","modified":1629612951596},{"_id":"source/_posts/images/NIO-Selector.png","hash":"e6a4a0a0538ce25bfac6d72862b47dae968d2c8b","modified":1623939311856},{"_id":"source/_posts/images/Servlet.png","hash":"4147c089f88ba94f0b666784152f4a82cb217e67","modified":1618371168023},{"_id":"source/_posts/images/-TCC.png","hash":"55e8ebcf98afe4b2462cf75bedf4eb0e6daca0c9","modified":1622185997370},{"_id":"source/_posts/images/.png","hash":"d7858cc960e570b3fa90b24c7073a4f348e77e3f","modified":1630338337860},{"_id":"source/_posts/images/.jpg","hash":"8b6db0126ddd36527b1da765097ea2c84923eebd","modified":1618540540578},{"_id":"source/_posts/images/.png","hash":"cb5d657feb957d8aa230f766c895bb20b1b04212","modified":1618214726208},{"_id":"source/_posts/images/JClassLib-.png","hash":"8764d5d46285a8e083a7ebcb8161291c7d2551e4","modified":1631426777423},{"_id":"source/_posts/images/NIO - ByteBuffer.png","hash":"507e4ea984f946f6b023a6cea20c09ed50741f71","modified":1626003410163},{"_id":"source/_posts/images/SpringAOP.png","hash":"5bd6fa40ae8d0e4c5c2d5c1d2af1795f392b91c5","modified":1618242379515},{"_id":"source/_posts/images/TCP.png","hash":"657be2b9d45a7de7af921a92dbf11e52462883ca","modified":1623166168682},{"_id":"source/_posts/images/.png","hash":"3631371549117596e89f7ef4b89074f95587c629","modified":1618154716376},{"_id":"source/_posts/images/.png","hash":"571a7366a3323ea6365dd460ade8ee0f00194529","modified":1618155373154},{"_id":"source/_posts/images/HashMap.png","hash":"f3829bc228c7eb0954efe5caebb44c61d4c2c967","modified":1619331652204},{"_id":"source/_posts/images/JVM - .png","hash":"1ab2e86e7b23c1cd04ffdd2c4a5b95bab2c9649a","modified":1626706643424},{"_id":"source/_posts/images/JVM-.png","hash":"e05652634268e44e8191b4ab79067028be4ed502","modified":1619662583602},{"_id":"source/_posts/images/JVM.png","hash":"2824de9a6498c71cfa0e6ea070e57be44168931d","modified":1627222077699},{"_id":"source/_posts/images/NIO - ServerSocketChannel.png","hash":"b82745ecd777df0896f41a431cca3c72f61ea0e5","modified":1623846682808},{"_id":"source/_posts/images/NIO - SocketChannel.png","hash":"7a6d55f20e4cd89a9df9a6b52deec23a8524698f","modified":1623581344466},{"_id":"source/_posts/images/Spring - BeanFactory.png","hash":"ef607ba684c400fcd3b3a9c430b3771e683e1a73","modified":1618921290148},{"_id":"source/_posts/images/NIO - Channel.png","hash":"5dfbfdfe3b45601f14d3459547b860b0768917ce","modified":1623580820779},{"_id":"source/_posts/images/NIO-Selector.png","hash":"975306d7da5250b4193dda99071ecbffaacff0f6","modified":1623939383209},{"_id":"source/_posts/images/UDP.png","hash":"2792f12e001d457097617ea13f395b46a8582a2f","modified":1623167453291},{"_id":"source/_posts/images/synchronized.png","hash":"c136f2a999cde3ad3ab8a599a7f8e25f60482f5d","modified":1619153328811},{"_id":"source/_posts/images/Netty - EventLoopGroup.png","hash":"aab70784fef1ec6b4ed3d4dbdeb9076c9c2e5f85","modified":1624858700133},{"_id":"source/_posts/images/Netty - .png","hash":"fff44d46f15b5b13e5f4d91f8e08e18371a6dcbb","modified":1624858527170},{"_id":"source/_posts/images/SpringResourceAnt.png","hash":"7fc706808691911c1cfe71417fdb42623d2a767a","modified":1619488953691},{"_id":"source/_posts/images/ - .png","hash":"df00b363eb03e872a16513d6c56916d6293a60dc","modified":1618153315604},{"_id":"source/_posts/images/Lock - ReetrantLock.png","hash":"1e6e657c8694502f77ac1f47f133054377b7e912","modified":1619675641204},{"_id":"source/_posts/images/Netty - .png","hash":"c143c49ea882dc6296b1deee580908e9fadb4b58","modified":1624858088321},{"_id":"source/_posts/images/JSP-HTML.png","hash":"2c16252af6cd6ff8d7bec661d938219d97af18d8","modified":1618329384701},{"_id":"source/_posts/images/JVM-.png","hash":"e87d6501769d02190bb05a924de704a75ae6efe1","modified":1630941519255},{"_id":"source/_posts/images/Java.png","hash":"aef9d443f086c8d4f2263e2755584aa1d19f37a8","modified":1629612489333},{"_id":"source/_posts/images/BIO-IO.png","hash":"ccf27e799d1fb3954f8dc007ec61e969efdce1d6","modified":1623330997267}],"Category":[{"name":"Spring","_id":"cl064ohl40006lou5dea6hh3p"}],"Data":[],"Page":[{"title":"friends","date":"2022-02-27T15:30:41.000Z","_content":"\nHello,world","source":"friends/index.md","raw":"---\ntitle: friends\ndate: 2022-02-27 23:30:41\n---\n\nHello,world","updated":"2022-02-27T15:31:10.700Z","path":"friends/index.html","comments":1,"layout":"page","_id":"cl064ohkt0000lou57ppkhvs5","content":"<p>Hello,world</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Hello,world</p>\n"},{"date":"2022-02-24T16:21:14.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ndate: 2022-02-25 00:21:14\ntype: \"tags\"\ncomments: false\n---\n","updated":"2022-02-27T09:20:39.488Z","path":"tags/index.html","title":"","layout":"page","_id":"cl064ohkz0002lou56n630cir","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"AQS","date":"2021-06-01T09:19:14.000Z","comments":0,"_content":"\nAQS AbstractQueuedSynchronizerReentrantLockCountDownLatchSemphore\n\n![image-20210513220313583](.\\images\\AQS-.png)\n\nacquireacquireShared\n\ntryAcquiretryAcquireShared\n\nreleasereleaseShared\n\ntryReleasetryReleaseShared\n\n##  \n\nAQS\n\n```java\npublic class MyAqs {\n    // \n    public volatile AtomicReference<Thread> owner = new AtomicReference<>();\n    // \n    public volatile LinkedBlockingQueue<Thread> waiters = new LinkedBlockingQueue<>();\n    // \n    public volatile AtomicInteger state = new AtomicInteger(0);\n    \n    public void acquire() {\n        boolean addQ = true;\n        while (!tryAcquire()) {\n            if (addQ) {\n                // \n                waiters.offer(Thread.currentThread());\n                addQ = false;\n            } else {\n                // \n                LockSupport.park(); \n            }\n        }\n        // \n        waiters.remove(Thread.currentThread()); \n    }\n    \n    /**\n     * \n     */\n    public boolean tryAcquire() { \n        throw new UnsupportedOperationException();\n    }\n    \n    public void release() {\n        if (tryRelease()) {\n            // \n            Iterator<Thread> iterator = waiters.iterator();\n            if (iterator.hasNext()) {\n                Thread next = iterator.next();\n                // \n                LockSupport.unpark(next); \n            }\n        }\n    }\n    \n    public boolean tryRelease() {\n        throw new UnsupportedOperationException();\n    }\n    \n    //==================  ==================//\n    public void acquireShared() {\n        boolean addQ = true;\n        while (tryAcquireShared() < 0) {\n            if (addQ) {\n                waiters.offer(Thread.currentThread());\n                addQ = false;\n            } else {\n                LockSupport.park(); \n            }\n        }\n        waiters.remove(Thread.currentThread());\n    }\n    \n    public int tryAcquireShared() {\n        throw new UnsupportedOperationException();\n    }\n\t\n    public void releaseShared() {\n        if (tryReleaseShared()) {\n            Iterator<Thread> iterator = waiters.iterator();\n            if (iterator.hasNext()) {\n                Thread next = iterator.next();\n                LockSupport.unpark(next);\n            }\n        }\n    }\n    \n    public boolean tryReleaseShared() {\n        throw new UnsupportedOperationException();\n    }\n    \n    // \n    public AtomicInteger getState() {\n        return state;\n    }\n\n    public void setState(AtomicInteger state) {\n        this.state = state;\n    }\n}\n```\n\n## AQS\n\nBlockingQueue\n\nacquireQueued() \n\n```java\npublic final void acquire(int arg) {\n    // \n    if (!tryAcquire(arg) && acquireQueued(addWaiter(Node.EXCLUSIVE), arg))\n        selfInterrupt();\n}\n\nprotected boolean tryAcquire(int arg) {\n    throw new UnsupportedOperationException();\n}\n```\n\ntryAcquire() \n\n```java\nfinal boolean acquireQueued(final Node node, int arg) {\n    boolean failed = true;\n    try {\n        boolean interrupted = false; // \n        for (;;) {// \n            final Node p = node.predecessor(); // \n            if (p == head && tryAcquire(arg)) { // head\n                setHead(node); // head\n                p.next = null; // help GC\n                failed = false;\n                return interrupted;\n            }\n            // \n            if (shouldParkAfterFailedAcquire(p, node) &&\n                parkAndCheckInterrupt())// Park\n                interrupted = true; // \n        }\n    } finally {\n        if (failed)\n            cancelAcquire(node);\n    }\n}\n\nfinal Node predecessor() throws NullPointerException {\n    // head\n    Node p = prev;\n    if (p == null)\n        throw new NullPointerException();\n    else\n        return p;\n}\n\nprivate static boolean shouldParkAfterFailedAcquire(Node pred, Node node) {\n    int ws = pred.waitStatus; //   \n    if (ws == Node.SIGNAL) // \n        /*\n         * This node has already set status asking a release\n         * to signal it, so it can safely park.\n         */\n        return true;\n    if (ws > 0) { // CANCELLED\n        /*\n         * Predecessor was cancelled. Skip over predecessors and\n         * indicate retry.\n         */\n        do { // \n            node.prev = pred = pred.prev;\n        } while (pred.waitStatus > 0);\n        pred.next = node;\n    } else {\n        /*\n         * waitStatus must be 0 or PROPAGATE.  Indicate that we\n         * need a signal, but don't park yet.  Caller will need to\n         * retry to make sure it cannot acquire before parking.\n         */\n        compareAndSetWaitStatus(pred, ws, Node.SIGNAL); // SIGNAL\n    }\n    return false;\n}\n```\n\n\n\n```java\npublic final boolean release(int arg) {\n    if (tryRelease(arg)) {\n        Node h = head; // \n        if (h != null && h.waitStatus != 0)\n            unparkSuccessor(h); // \n        return true;\n    }\n    return false;\n}\n\nprotected boolean tryRelease(int arg) {\n    throw new UnsupportedOperationException();\n}\n\nprivate void unparkSuccessor(Node node) {\n    /*\n     * If status is negative (i.e., possibly needing signal) try\n     * to clear in anticipation of signalling.  It is OK if this\n     * fails or if status is changed by waiting thread.\n     */\n    int ws = node.waitStatus; // \n    if (ws < 0)\n        compareAndSetWaitStatus(node, ws, 0); // \n\n    /*\n     * Thread to unpark is held in successor, which is normally\n     * just the next node.  But if cancelled or apparently null,\n     * traverse backwards from tail to find the actual\n     * non-cancelled successor.\n     */\n    Node s = node.next; // \n    if (s == null || s.waitStatus > 0) { // \n        s = null;\n        for (Node t = tail; t != null && t != node; t = t.prev)\n            if (t.waitStatus <= 0)\n                s = t;\n    }\n    if (s != null) // \n        LockSupport.unpark(s.thread);\n}\n```\n\n##  \n\n\n\n![image-20210514131357784](.\\images\\AQS-.png)\n\n","source":"_posts/Java - AQS.md","raw":"---\ntitle: AQS\ndate: 2021-06-1 17:19:14\ntags:\n- JUC\ncomments: false\n---\n\nAQS AbstractQueuedSynchronizerReentrantLockCountDownLatchSemphore\n\n![image-20210513220313583](.\\images\\AQS-.png)\n\nacquireacquireShared\n\ntryAcquiretryAcquireShared\n\nreleasereleaseShared\n\ntryReleasetryReleaseShared\n\n##  \n\nAQS\n\n```java\npublic class MyAqs {\n    // \n    public volatile AtomicReference<Thread> owner = new AtomicReference<>();\n    // \n    public volatile LinkedBlockingQueue<Thread> waiters = new LinkedBlockingQueue<>();\n    // \n    public volatile AtomicInteger state = new AtomicInteger(0);\n    \n    public void acquire() {\n        boolean addQ = true;\n        while (!tryAcquire()) {\n            if (addQ) {\n                // \n                waiters.offer(Thread.currentThread());\n                addQ = false;\n            } else {\n                // \n                LockSupport.park(); \n            }\n        }\n        // \n        waiters.remove(Thread.currentThread()); \n    }\n    \n    /**\n     * \n     */\n    public boolean tryAcquire() { \n        throw new UnsupportedOperationException();\n    }\n    \n    public void release() {\n        if (tryRelease()) {\n            // \n            Iterator<Thread> iterator = waiters.iterator();\n            if (iterator.hasNext()) {\n                Thread next = iterator.next();\n                // \n                LockSupport.unpark(next); \n            }\n        }\n    }\n    \n    public boolean tryRelease() {\n        throw new UnsupportedOperationException();\n    }\n    \n    //==================  ==================//\n    public void acquireShared() {\n        boolean addQ = true;\n        while (tryAcquireShared() < 0) {\n            if (addQ) {\n                waiters.offer(Thread.currentThread());\n                addQ = false;\n            } else {\n                LockSupport.park(); \n            }\n        }\n        waiters.remove(Thread.currentThread());\n    }\n    \n    public int tryAcquireShared() {\n        throw new UnsupportedOperationException();\n    }\n\t\n    public void releaseShared() {\n        if (tryReleaseShared()) {\n            Iterator<Thread> iterator = waiters.iterator();\n            if (iterator.hasNext()) {\n                Thread next = iterator.next();\n                LockSupport.unpark(next);\n            }\n        }\n    }\n    \n    public boolean tryReleaseShared() {\n        throw new UnsupportedOperationException();\n    }\n    \n    // \n    public AtomicInteger getState() {\n        return state;\n    }\n\n    public void setState(AtomicInteger state) {\n        this.state = state;\n    }\n}\n```\n\n## AQS\n\nBlockingQueue\n\nacquireQueued() \n\n```java\npublic final void acquire(int arg) {\n    // \n    if (!tryAcquire(arg) && acquireQueued(addWaiter(Node.EXCLUSIVE), arg))\n        selfInterrupt();\n}\n\nprotected boolean tryAcquire(int arg) {\n    throw new UnsupportedOperationException();\n}\n```\n\ntryAcquire() \n\n```java\nfinal boolean acquireQueued(final Node node, int arg) {\n    boolean failed = true;\n    try {\n        boolean interrupted = false; // \n        for (;;) {// \n            final Node p = node.predecessor(); // \n            if (p == head && tryAcquire(arg)) { // head\n                setHead(node); // head\n                p.next = null; // help GC\n                failed = false;\n                return interrupted;\n            }\n            // \n            if (shouldParkAfterFailedAcquire(p, node) &&\n                parkAndCheckInterrupt())// Park\n                interrupted = true; // \n        }\n    } finally {\n        if (failed)\n            cancelAcquire(node);\n    }\n}\n\nfinal Node predecessor() throws NullPointerException {\n    // head\n    Node p = prev;\n    if (p == null)\n        throw new NullPointerException();\n    else\n        return p;\n}\n\nprivate static boolean shouldParkAfterFailedAcquire(Node pred, Node node) {\n    int ws = pred.waitStatus; //   \n    if (ws == Node.SIGNAL) // \n        /*\n         * This node has already set status asking a release\n         * to signal it, so it can safely park.\n         */\n        return true;\n    if (ws > 0) { // CANCELLED\n        /*\n         * Predecessor was cancelled. Skip over predecessors and\n         * indicate retry.\n         */\n        do { // \n            node.prev = pred = pred.prev;\n        } while (pred.waitStatus > 0);\n        pred.next = node;\n    } else {\n        /*\n         * waitStatus must be 0 or PROPAGATE.  Indicate that we\n         * need a signal, but don't park yet.  Caller will need to\n         * retry to make sure it cannot acquire before parking.\n         */\n        compareAndSetWaitStatus(pred, ws, Node.SIGNAL); // SIGNAL\n    }\n    return false;\n}\n```\n\n\n\n```java\npublic final boolean release(int arg) {\n    if (tryRelease(arg)) {\n        Node h = head; // \n        if (h != null && h.waitStatus != 0)\n            unparkSuccessor(h); // \n        return true;\n    }\n    return false;\n}\n\nprotected boolean tryRelease(int arg) {\n    throw new UnsupportedOperationException();\n}\n\nprivate void unparkSuccessor(Node node) {\n    /*\n     * If status is negative (i.e., possibly needing signal) try\n     * to clear in anticipation of signalling.  It is OK if this\n     * fails or if status is changed by waiting thread.\n     */\n    int ws = node.waitStatus; // \n    if (ws < 0)\n        compareAndSetWaitStatus(node, ws, 0); // \n\n    /*\n     * Thread to unpark is held in successor, which is normally\n     * just the next node.  But if cancelled or apparently null,\n     * traverse backwards from tail to find the actual\n     * non-cancelled successor.\n     */\n    Node s = node.next; // \n    if (s == null || s.waitStatus > 0) { // \n        s = null;\n        for (Node t = tail; t != null && t != node; t = t.prev)\n            if (t.waitStatus <= 0)\n                s = t;\n    }\n    if (s != null) // \n        LockSupport.unpark(s.thread);\n}\n```\n\n##  \n\n\n\n![image-20210514131357784](.\\images\\AQS-.png)\n\n","slug":"Java - AQS","published":1,"updated":"2022-02-28T10:50:52.547Z","_id":"cl06iwafo000nqwu573xwg7v8","layout":"post","photos":[],"link":"","content":"<p>AQS AbstractQueuedSynchronizerReentrantLockCountDownLatchSemphore</p>\n<p><img src=\".%5Cimages%5CAQS-%E6%8E%A5%E5%8F%A3.png\" alt=\"image-20210513220313583\"></p>\n<p>acquireacquireShared</p>\n<p>tryAcquiretryAcquireShared</p>\n<p>releasereleaseShared</p>\n<p>tryReleasetryReleaseShared</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>AQS</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyAqs</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> AtomicReference&lt;Thread&gt; owner = <span class=\"keyword\">new</span> <span class=\"title class_\">AtomicReference</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> LinkedBlockingQueue&lt;Thread&gt; waiters = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedBlockingQueue</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"type\">AtomicInteger</span> <span class=\"variable\">state</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">AtomicInteger</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">acquire</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">addQ</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!tryAcquire()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (addQ) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                waiters.offer(Thread.currentThread());</span><br><span class=\"line\">                addQ = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                LockSupport.park(); </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        waiters.remove(Thread.currentThread()); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryAcquire</span><span class=\"params\">()</span> &#123; </span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">release</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tryRelease()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            Iterator&lt;Thread&gt; iterator = waiters.iterator();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (iterator.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"type\">Thread</span> <span class=\"variable\">next</span> <span class=\"operator\">=</span> iterator.next();</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                LockSupport.unpark(next); </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryRelease</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//==================  ==================//</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">acquireShared</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">addQ</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (tryAcquireShared() &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (addQ) &#123;</span><br><span class=\"line\">                waiters.offer(Thread.currentThread());</span><br><span class=\"line\">                addQ = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                LockSupport.park(); </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        waiters.remove(Thread.currentThread());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">tryAcquireShared</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">releaseShared</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tryReleaseShared()) &#123;</span><br><span class=\"line\">            Iterator&lt;Thread&gt; iterator = waiters.iterator();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (iterator.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"type\">Thread</span> <span class=\"variable\">next</span> <span class=\"operator\">=</span> iterator.next();</span><br><span class=\"line\">                LockSupport.unpark(next);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryReleaseShared</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AtomicInteger <span class=\"title function_\">getState</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> state;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setState</span><span class=\"params\">(AtomicInteger state)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.state = state;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"AQS\"><a href=\"#AQS\" class=\"headerlink\" title=\"AQS\"></a>AQS</h2><p>BlockingQueue</p>\n<p>acquireQueued() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">acquire</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!tryAcquire(arg) &amp;&amp; acquireQueued(addWaiter(Node.EXCLUSIVE), arg))</span><br><span class=\"line\">        selfInterrupt();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryAcquire</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>tryAcquire() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"type\">boolean</span> <span class=\"title function_\">acquireQueued</span><span class=\"params\">(<span class=\"keyword\">final</span> Node node, <span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">failed</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">interrupted</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (;;) &#123;<span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">final</span> <span class=\"type\">Node</span> <span class=\"variable\">p</span> <span class=\"operator\">=</span> node.predecessor(); <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (p == head &amp;&amp; tryAcquire(arg)) &#123; <span class=\"comment\">// head</span></span><br><span class=\"line\">                setHead(node); <span class=\"comment\">// head</span></span><br><span class=\"line\">                p.next = <span class=\"literal\">null</span>; <span class=\"comment\">// help GC</span></span><br><span class=\"line\">                failed = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> interrupted;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;</span><br><span class=\"line\">                parkAndCheckInterrupt())<span class=\"comment\">// Park</span></span><br><span class=\"line\">                interrupted = <span class=\"literal\">true</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (failed)</span><br><span class=\"line\">            cancelAcquire(node);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">final</span> Node <span class=\"title function_\">predecessor</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> NullPointerException &#123;</span><br><span class=\"line\">    <span class=\"comment\">// head</span></span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">p</span> <span class=\"operator\">=</span> prev;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (p == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>();</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">shouldParkAfterFailedAcquire</span><span class=\"params\">(Node pred, Node node)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">ws</span> <span class=\"operator\">=</span> pred.waitStatus; <span class=\"comment\">//   </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ws == Node.SIGNAL) <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * This node has already set status asking a release</span></span><br><span class=\"line\"><span class=\"comment\">         * to signal it, so it can safely park.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ws &gt; <span class=\"number\">0</span>) &#123; <span class=\"comment\">// CANCELLED</span></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * Predecessor was cancelled. Skip over predecessors and</span></span><br><span class=\"line\"><span class=\"comment\">         * indicate retry.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">do</span> &#123; <span class=\"comment\">// </span></span><br><span class=\"line\">            node.prev = pred = pred.prev;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">while</span> (pred.waitStatus &gt; <span class=\"number\">0</span>);</span><br><span class=\"line\">        pred.next = node;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * waitStatus must be 0 or PROPAGATE.  Indicate that we</span></span><br><span class=\"line\"><span class=\"comment\">         * need a signal, but don&#x27;t park yet.  Caller will need to</span></span><br><span class=\"line\"><span class=\"comment\">         * retry to make sure it cannot acquire before parking.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        compareAndSetWaitStatus(pred, ws, Node.SIGNAL); <span class=\"comment\">// SIGNAL</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"type\">boolean</span> <span class=\"title function_\">release</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tryRelease(arg)) &#123;</span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">h</span> <span class=\"operator\">=</span> head; <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (h != <span class=\"literal\">null</span> &amp;&amp; h.waitStatus != <span class=\"number\">0</span>)</span><br><span class=\"line\">            unparkSuccessor(h); <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryRelease</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">unparkSuccessor</span><span class=\"params\">(Node node)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * If status is negative (i.e., possibly needing signal) try</span></span><br><span class=\"line\"><span class=\"comment\">     * to clear in anticipation of signalling.  It is OK if this</span></span><br><span class=\"line\"><span class=\"comment\">     * fails or if status is changed by waiting thread.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">ws</span> <span class=\"operator\">=</span> node.waitStatus; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ws &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        compareAndSetWaitStatus(node, ws, <span class=\"number\">0</span>); <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread to unpark is held in successor, which is normally</span></span><br><span class=\"line\"><span class=\"comment\">     * just the next node.  But if cancelled or apparently null,</span></span><br><span class=\"line\"><span class=\"comment\">     * traverse backwards from tail to find the actual</span></span><br><span class=\"line\"><span class=\"comment\">     * non-cancelled successor.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">s</span> <span class=\"operator\">=</span> node.next; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"literal\">null</span> || s.waitStatus &gt; <span class=\"number\">0</span>) &#123; <span class=\"comment\">// </span></span><br><span class=\"line\">        s = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">Node</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> tail; t != <span class=\"literal\">null</span> &amp;&amp; t != node; t = t.prev)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t.waitStatus &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">                s = t;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s != <span class=\"literal\">null</span>) <span class=\"comment\">// </span></span><br><span class=\"line\">        LockSupport.unpark(s.thread);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p><img src=\".%5Cimages%5CAQS-%E8%B5%84%E6%BA%90%E5%8D%A0%E7%94%A8%E6%B5%81%E7%A8%8B.png\" alt=\"image-20210514131357784\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>AQS AbstractQueuedSynchronizerReentrantLockCountDownLatchSemphore</p>\n<p><img src=\".%5Cimages%5CAQS-%E6%8E%A5%E5%8F%A3.png\" alt=\"image-20210513220313583\"></p>\n<p>acquireacquireShared</p>\n<p>tryAcquiretryAcquireShared</p>\n<p>releasereleaseShared</p>\n<p>tryReleasetryReleaseShared</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>AQS</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyAqs</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> AtomicReference&lt;Thread&gt; owner = <span class=\"keyword\">new</span> <span class=\"title class_\">AtomicReference</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> LinkedBlockingQueue&lt;Thread&gt; waiters = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedBlockingQueue</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"type\">AtomicInteger</span> <span class=\"variable\">state</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">AtomicInteger</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">acquire</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">addQ</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!tryAcquire()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (addQ) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                waiters.offer(Thread.currentThread());</span><br><span class=\"line\">                addQ = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                LockSupport.park(); </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        waiters.remove(Thread.currentThread()); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryAcquire</span><span class=\"params\">()</span> &#123; </span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">release</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tryRelease()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            Iterator&lt;Thread&gt; iterator = waiters.iterator();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (iterator.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"type\">Thread</span> <span class=\"variable\">next</span> <span class=\"operator\">=</span> iterator.next();</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                LockSupport.unpark(next); </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryRelease</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//==================  ==================//</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">acquireShared</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">addQ</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (tryAcquireShared() &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (addQ) &#123;</span><br><span class=\"line\">                waiters.offer(Thread.currentThread());</span><br><span class=\"line\">                addQ = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                LockSupport.park(); </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        waiters.remove(Thread.currentThread());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">tryAcquireShared</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">releaseShared</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tryReleaseShared()) &#123;</span><br><span class=\"line\">            Iterator&lt;Thread&gt; iterator = waiters.iterator();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (iterator.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"type\">Thread</span> <span class=\"variable\">next</span> <span class=\"operator\">=</span> iterator.next();</span><br><span class=\"line\">                LockSupport.unpark(next);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryReleaseShared</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AtomicInteger <span class=\"title function_\">getState</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> state;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setState</span><span class=\"params\">(AtomicInteger state)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.state = state;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"AQS\"><a href=\"#AQS\" class=\"headerlink\" title=\"AQS\"></a>AQS</h2><p>BlockingQueue</p>\n<p>acquireQueued() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">acquire</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!tryAcquire(arg) &amp;&amp; acquireQueued(addWaiter(Node.EXCLUSIVE), arg))</span><br><span class=\"line\">        selfInterrupt();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryAcquire</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>tryAcquire() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"type\">boolean</span> <span class=\"title function_\">acquireQueued</span><span class=\"params\">(<span class=\"keyword\">final</span> Node node, <span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">failed</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">interrupted</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (;;) &#123;<span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">final</span> <span class=\"type\">Node</span> <span class=\"variable\">p</span> <span class=\"operator\">=</span> node.predecessor(); <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (p == head &amp;&amp; tryAcquire(arg)) &#123; <span class=\"comment\">// head</span></span><br><span class=\"line\">                setHead(node); <span class=\"comment\">// head</span></span><br><span class=\"line\">                p.next = <span class=\"literal\">null</span>; <span class=\"comment\">// help GC</span></span><br><span class=\"line\">                failed = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> interrupted;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;</span><br><span class=\"line\">                parkAndCheckInterrupt())<span class=\"comment\">// Park</span></span><br><span class=\"line\">                interrupted = <span class=\"literal\">true</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (failed)</span><br><span class=\"line\">            cancelAcquire(node);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">final</span> Node <span class=\"title function_\">predecessor</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> NullPointerException &#123;</span><br><span class=\"line\">    <span class=\"comment\">// head</span></span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">p</span> <span class=\"operator\">=</span> prev;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (p == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>();</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">shouldParkAfterFailedAcquire</span><span class=\"params\">(Node pred, Node node)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">ws</span> <span class=\"operator\">=</span> pred.waitStatus; <span class=\"comment\">//   </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ws == Node.SIGNAL) <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * This node has already set status asking a release</span></span><br><span class=\"line\"><span class=\"comment\">         * to signal it, so it can safely park.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ws &gt; <span class=\"number\">0</span>) &#123; <span class=\"comment\">// CANCELLED</span></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * Predecessor was cancelled. Skip over predecessors and</span></span><br><span class=\"line\"><span class=\"comment\">         * indicate retry.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">do</span> &#123; <span class=\"comment\">// </span></span><br><span class=\"line\">            node.prev = pred = pred.prev;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">while</span> (pred.waitStatus &gt; <span class=\"number\">0</span>);</span><br><span class=\"line\">        pred.next = node;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * waitStatus must be 0 or PROPAGATE.  Indicate that we</span></span><br><span class=\"line\"><span class=\"comment\">         * need a signal, but don&#x27;t park yet.  Caller will need to</span></span><br><span class=\"line\"><span class=\"comment\">         * retry to make sure it cannot acquire before parking.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        compareAndSetWaitStatus(pred, ws, Node.SIGNAL); <span class=\"comment\">// SIGNAL</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"type\">boolean</span> <span class=\"title function_\">release</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tryRelease(arg)) &#123;</span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">h</span> <span class=\"operator\">=</span> head; <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (h != <span class=\"literal\">null</span> &amp;&amp; h.waitStatus != <span class=\"number\">0</span>)</span><br><span class=\"line\">            unparkSuccessor(h); <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"type\">boolean</span> <span class=\"title function_\">tryRelease</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UnsupportedOperationException</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">unparkSuccessor</span><span class=\"params\">(Node node)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * If status is negative (i.e., possibly needing signal) try</span></span><br><span class=\"line\"><span class=\"comment\">     * to clear in anticipation of signalling.  It is OK if this</span></span><br><span class=\"line\"><span class=\"comment\">     * fails or if status is changed by waiting thread.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">ws</span> <span class=\"operator\">=</span> node.waitStatus; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ws &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        compareAndSetWaitStatus(node, ws, <span class=\"number\">0</span>); <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread to unpark is held in successor, which is normally</span></span><br><span class=\"line\"><span class=\"comment\">     * just the next node.  But if cancelled or apparently null,</span></span><br><span class=\"line\"><span class=\"comment\">     * traverse backwards from tail to find the actual</span></span><br><span class=\"line\"><span class=\"comment\">     * non-cancelled successor.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">s</span> <span class=\"operator\">=</span> node.next; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"literal\">null</span> || s.waitStatus &gt; <span class=\"number\">0</span>) &#123; <span class=\"comment\">// </span></span><br><span class=\"line\">        s = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">Node</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> tail; t != <span class=\"literal\">null</span> &amp;&amp; t != node; t = t.prev)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t.waitStatus &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">                s = t;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s != <span class=\"literal\">null</span>) <span class=\"comment\">// </span></span><br><span class=\"line\">        LockSupport.unpark(s.thread);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p><img src=\".%5Cimages%5CAQS-%E8%B5%84%E6%BA%90%E5%8D%A0%E7%94%A8%E6%B5%81%E7%A8%8B.png\" alt=\"image-20210514131357784\"></p>\n"},{"title":"ForkJoinPool","date":"2021-08-22T04:50:00.000Z","comments":0,"_content":"\n\t\tForkJoinPool ExecutorService Java 7Fork/JoinRunnable\n\n## \n\n- WorkerForkJoinWorkerThread\n\n- ForkJoinDeQueueLIFOFIFO\n\n-  Worker \n\n-  Worker steal workAPIAPI\n\n## \n\n-  Worker  join \n\n-  Worker  yield  sleep \n\n## \n\n\n\n\n\nForkJoinTask\n\nForkJoinTaskIO\n\n\n\njava8java.utilArrays parallelSort() \n\n## \n\n 0  10_0000_0000\n\n```java\npublic void test1() {\n    long start = System.currentTimeMillis();\n    long sum = 0;\n    for (long i = 0; i < 10_0000_0000L; i++) {\n        sum += i;\n    }\n    System.out.println(sum + \",\" + (System.currentTimeMillis() - start) + \"ms\");// 361ms\n}\n```\n\n ForkJoinPool \n\n```java\npublic void test2() throws ExecutionException, InterruptedException {\n    long start = System.currentTimeMillis();\n\n    ForkJoinPool pool = new ForkJoinPool();\n    ForkJoinTask<Long> task = new Task04051(0L, 10_0000_0000L);\n    ForkJoinTask<Long> submit = pool.submit(task);\n    Long result = submit.get();\n\n    System.out.println(result + \",\" + (System.currentTimeMillis() - start) + \"ms\"); // 186ms\n}\n```\n\n  stream \n\n```java\npublic void test3() {\n    long start = System.currentTimeMillis();\n\t//  LongStream DoubleStreamIntegerStream \n    long sum = LongStream.rangeClosed(0L, num).parallel().reduce(0, Long::sum);\n\n    System.out.println(sum + \",\" + (System.currentTimeMillis() - start) + \"ms\");// 126ms\n}\n```\n\n","source":"_posts/Java - ForkJoin.md","raw":"---\ntitle: ForkJoinPool\ndate: 2021-08-22 12:50:00\ntags:\n- Java\ncomments: false\n---\n\n\t\tForkJoinPool ExecutorService Java 7Fork/JoinRunnable\n\n## \n\n- WorkerForkJoinWorkerThread\n\n- ForkJoinDeQueueLIFOFIFO\n\n-  Worker \n\n-  Worker steal workAPIAPI\n\n## \n\n-  Worker  join \n\n-  Worker  yield  sleep \n\n## \n\n\n\n\n\nForkJoinTask\n\nForkJoinTaskIO\n\n\n\njava8java.utilArrays parallelSort() \n\n## \n\n 0  10_0000_0000\n\n```java\npublic void test1() {\n    long start = System.currentTimeMillis();\n    long sum = 0;\n    for (long i = 0; i < 10_0000_0000L; i++) {\n        sum += i;\n    }\n    System.out.println(sum + \",\" + (System.currentTimeMillis() - start) + \"ms\");// 361ms\n}\n```\n\n ForkJoinPool \n\n```java\npublic void test2() throws ExecutionException, InterruptedException {\n    long start = System.currentTimeMillis();\n\n    ForkJoinPool pool = new ForkJoinPool();\n    ForkJoinTask<Long> task = new Task04051(0L, 10_0000_0000L);\n    ForkJoinTask<Long> submit = pool.submit(task);\n    Long result = submit.get();\n\n    System.out.println(result + \",\" + (System.currentTimeMillis() - start) + \"ms\"); // 186ms\n}\n```\n\n  stream \n\n```java\npublic void test3() {\n    long start = System.currentTimeMillis();\n\t//  LongStream DoubleStreamIntegerStream \n    long sum = LongStream.rangeClosed(0L, num).parallel().reduce(0, Long::sum);\n\n    System.out.println(sum + \",\" + (System.currentTimeMillis() - start) + \"ms\");// 126ms\n}\n```\n\n","slug":"Java - ForkJoin","published":1,"updated":"2022-02-28T10:08:07.552Z","_id":"cl06j796n000qqwu507fy8fur","layout":"post","photos":[],"link":"","content":"<p>        ForkJoinPool ExecutorService Java 7Fork/JoinRunnable</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p>WorkerForkJoinWorkerThread</p>\n</li>\n<li><p>ForkJoinDeQueueLIFOFIFO</p>\n</li>\n<li><p> Worker </p>\n</li>\n<li><p> Worker steal workAPIAPI</p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p> Worker  join </p>\n</li>\n<li><p> Worker  yield  sleep </p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p></p>\n<p>ForkJoinTask</p>\n<p>ForkJoinTaskIO</p>\n<p></p>\n<p>java8java.utilArrays parallelSort() </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> 0  10_0000_0000</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">long</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10_0000_0000L</span>; i++) &#123;</span><br><span class=\"line\">        sum += i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sum + <span class=\"string\">&quot;,&quot;</span> + (System.currentTimeMillis() - start) + <span class=\"string\">&quot;ms&quot;</span>);<span class=\"comment\">// 361ms</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> ForkJoinPool </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test2</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">ForkJoinPool</span> <span class=\"variable\">pool</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ForkJoinPool</span>();</span><br><span class=\"line\">    ForkJoinTask&lt;Long&gt; task = <span class=\"keyword\">new</span> <span class=\"title class_\">Task04051</span>(<span class=\"number\">0L</span>, <span class=\"number\">10_0000_0000L</span>);</span><br><span class=\"line\">    ForkJoinTask&lt;Long&gt; submit = pool.submit(task);</span><br><span class=\"line\">    <span class=\"type\">Long</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> submit.get();</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(result + <span class=\"string\">&quot;,&quot;</span> + (System.currentTimeMillis() - start) + <span class=\"string\">&quot;ms&quot;</span>); <span class=\"comment\">// 186ms</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>  stream </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test3</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">\t<span class=\"comment\">//  LongStream DoubleStreamIntegerStream </span></span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> LongStream.rangeClosed(<span class=\"number\">0L</span>, num).parallel().reduce(<span class=\"number\">0</span>, Long::sum);</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(sum + <span class=\"string\">&quot;,&quot;</span> + (System.currentTimeMillis() - start) + <span class=\"string\">&quot;ms&quot;</span>);<span class=\"comment\">// 126ms</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<p>        ForkJoinPool ExecutorService Java 7Fork/JoinRunnable</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p>WorkerForkJoinWorkerThread</p>\n</li>\n<li><p>ForkJoinDeQueueLIFOFIFO</p>\n</li>\n<li><p> Worker </p>\n</li>\n<li><p> Worker steal workAPIAPI</p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p> Worker  join </p>\n</li>\n<li><p> Worker  yield  sleep </p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p></p>\n<p>ForkJoinTask</p>\n<p>ForkJoinTaskIO</p>\n<p></p>\n<p>java8java.utilArrays parallelSort() </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> 0  10_0000_0000</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">long</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10_0000_0000L</span>; i++) &#123;</span><br><span class=\"line\">        sum += i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sum + <span class=\"string\">&quot;,&quot;</span> + (System.currentTimeMillis() - start) + <span class=\"string\">&quot;ms&quot;</span>);<span class=\"comment\">// 361ms</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> ForkJoinPool </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test2</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">ForkJoinPool</span> <span class=\"variable\">pool</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ForkJoinPool</span>();</span><br><span class=\"line\">    ForkJoinTask&lt;Long&gt; task = <span class=\"keyword\">new</span> <span class=\"title class_\">Task04051</span>(<span class=\"number\">0L</span>, <span class=\"number\">10_0000_0000L</span>);</span><br><span class=\"line\">    ForkJoinTask&lt;Long&gt; submit = pool.submit(task);</span><br><span class=\"line\">    <span class=\"type\">Long</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> submit.get();</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(result + <span class=\"string\">&quot;,&quot;</span> + (System.currentTimeMillis() - start) + <span class=\"string\">&quot;ms&quot;</span>); <span class=\"comment\">// 186ms</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>  stream </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test3</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">\t<span class=\"comment\">//  LongStream DoubleStreamIntegerStream </span></span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> LongStream.rangeClosed(<span class=\"number\">0L</span>, num).parallel().reduce(<span class=\"number\">0</span>, Long::sum);</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(sum + <span class=\"string\">&quot;,&quot;</span> + (System.currentTimeMillis() - start) + <span class=\"string\">&quot;ms&quot;</span>);<span class=\"comment\">// 126ms</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"ArrayList","date":"2021-05-31T07:05:00.000Z","comments":0,"description":"","_content":"\n> Tips\n\n\n\n-----\n\n## \n\nArrayListObject[] elementData\n\n## \n\n\n\n```java\npublic boolean add(E e) {\n    ensureCapacityInternal(size + 1);  // Increments modCount!!\n    elementData[size++] = e;\n    return true;\n}\n```\n\n101010\n\n```java\nprivate void ensureCapacityInternal(int minCapacity) {\n    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n        // private static final int DEFAULT_CAPACITY = 10;\n        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);\n    }\n    ensureExplicitCapacity(minCapacity);\n}\n```\n\ngrow\n\n```java\nprivate void grow(int minCapacity) {\n    // overflow-conscious code\n    int oldCapacity = elementData.length;\n    int newCapacity = oldCapacity + (oldCapacity >> 1);\n    if (newCapacity - minCapacity < 0)\n        newCapacity = minCapacity;\n    if (newCapacity - MAX_ARRAY_SIZE > 0)\n        newCapacity = hugeCapacity(minCapacity);\n    // minCapacity is usually close to size, so this is a win:\n    elementData = Arrays.copyOf(elementData, newCapacity);\n}\n```\n\nArrayscopyof\n\n```java\npublic static <T> T[] copyOf(T[] original, int newLength) {\n    return (T[]) copyOf(original, newLength, original.getClass());\n}\n\npublic static <T,U> T[] copyOf(U[] original, int newLength, Class<? extends T[]> newType) {\n    @SuppressWarnings(\"unchecked\")\n    T[] copy = ((Object)newType == (Object)Object[].class)\n        ? (T[]) new Object[newLength]\n        : (T[]) Array.newInstance(newType.getComponentType(), newLength);\n    System.arraycopy(original, 0, copy, 0,\n                     Math.min(original.length, newLength));\n    return copy;\n}\n\n// \npublic static native void arraycopy(Object src,  int  srcPos,\n                                    Object dest, int destPos,\n                                    int length);\n```\n\n\n\n","source":"_posts/Java - ArrayList.md","raw":"---\ntitle: ArrayList\ndate: 2021-05-31 15:05:00\ntags:\n- JUC\ncomments: false\ndescription: \n---\n\n> Tips\n\n\n\n-----\n\n## \n\nArrayListObject[] elementData\n\n## \n\n\n\n```java\npublic boolean add(E e) {\n    ensureCapacityInternal(size + 1);  // Increments modCount!!\n    elementData[size++] = e;\n    return true;\n}\n```\n\n101010\n\n```java\nprivate void ensureCapacityInternal(int minCapacity) {\n    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n        // private static final int DEFAULT_CAPACITY = 10;\n        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);\n    }\n    ensureExplicitCapacity(minCapacity);\n}\n```\n\ngrow\n\n```java\nprivate void grow(int minCapacity) {\n    // overflow-conscious code\n    int oldCapacity = elementData.length;\n    int newCapacity = oldCapacity + (oldCapacity >> 1);\n    if (newCapacity - minCapacity < 0)\n        newCapacity = minCapacity;\n    if (newCapacity - MAX_ARRAY_SIZE > 0)\n        newCapacity = hugeCapacity(minCapacity);\n    // minCapacity is usually close to size, so this is a win:\n    elementData = Arrays.copyOf(elementData, newCapacity);\n}\n```\n\nArrayscopyof\n\n```java\npublic static <T> T[] copyOf(T[] original, int newLength) {\n    return (T[]) copyOf(original, newLength, original.getClass());\n}\n\npublic static <T,U> T[] copyOf(U[] original, int newLength, Class<? extends T[]> newType) {\n    @SuppressWarnings(\"unchecked\")\n    T[] copy = ((Object)newType == (Object)Object[].class)\n        ? (T[]) new Object[newLength]\n        : (T[]) Array.newInstance(newType.getComponentType(), newLength);\n    System.arraycopy(original, 0, copy, 0,\n                     Math.min(original.length, newLength));\n    return copy;\n}\n\n// \npublic static native void arraycopy(Object src,  int  srcPos,\n                                    Object dest, int destPos,\n                                    int length);\n```\n\n\n\n","slug":"Java - ArrayList","published":1,"updated":"2022-02-28T10:55:25.623Z","_id":"cl06jbeml000uqwu56n784tyq","layout":"post","photos":[],"link":"","content":"<blockquote>\n<p>Tips</p>\n</blockquote>\n<p></p>\n<hr>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ArrayListObject[] elementData</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">add</span><span class=\"params\">(E e)</span> &#123;</span><br><span class=\"line\">    ensureCapacityInternal(size + <span class=\"number\">1</span>);  <span class=\"comment\">// Increments modCount!!</span></span><br><span class=\"line\">    elementData[size++] = e;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>101010</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">ensureCapacityInternal</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// private static final int DEFAULT_CAPACITY = 10;</span></span><br><span class=\"line\">        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ensureExplicitCapacity(minCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>grow</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">grow</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// overflow-conscious code</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">oldCapacity</span> <span class=\"operator\">=</span> elementData.length;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">newCapacity</span> <span class=\"operator\">=</span> oldCapacity + (oldCapacity &gt;&gt; <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - minCapacity &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = minCapacity;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = hugeCapacity(minCapacity);</span><br><span class=\"line\">    <span class=\"comment\">// minCapacity is usually close to size, so this is a win:</span></span><br><span class=\"line\">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Arrayscopyof</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; T[] copyOf(T[] original, <span class=\"type\">int</span> newLength) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (T[]) copyOf(original, newLength, original.getClass());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T,U&gt; T[] copyOf(U[] original, <span class=\"type\">int</span> newLength, Class&lt;? <span class=\"keyword\">extends</span> <span class=\"title class_\">T</span>[]&gt; newType) &#123;</span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class=\"line\">    T[] copy = ((Object)newType == (Object)Object[].class)</span><br><span class=\"line\">        ? (T[]) <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>[newLength]</span><br><span class=\"line\">        : (T[]) Array.newInstance(newType.getComponentType(), newLength);</span><br><span class=\"line\">    System.arraycopy(original, <span class=\"number\">0</span>, copy, <span class=\"number\">0</span>,</span><br><span class=\"line\">                     Math.min(original.length, newLength));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> copy;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">arraycopy</span><span class=\"params\">(Object src,  <span class=\"type\">int</span>  srcPos,</span></span><br><span class=\"line\"><span class=\"params\">                                    Object dest, <span class=\"type\">int</span> destPos,</span></span><br><span class=\"line\"><span class=\"params\">                                    <span class=\"type\">int</span> length)</span>;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>Tips</p>\n</blockquote>\n<p></p>\n<hr>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ArrayListObject[] elementData</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">add</span><span class=\"params\">(E e)</span> &#123;</span><br><span class=\"line\">    ensureCapacityInternal(size + <span class=\"number\">1</span>);  <span class=\"comment\">// Increments modCount!!</span></span><br><span class=\"line\">    elementData[size++] = e;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>101010</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">ensureCapacityInternal</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// private static final int DEFAULT_CAPACITY = 10;</span></span><br><span class=\"line\">        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ensureExplicitCapacity(minCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>grow</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">grow</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// overflow-conscious code</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">oldCapacity</span> <span class=\"operator\">=</span> elementData.length;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">newCapacity</span> <span class=\"operator\">=</span> oldCapacity + (oldCapacity &gt;&gt; <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - minCapacity &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = minCapacity;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = hugeCapacity(minCapacity);</span><br><span class=\"line\">    <span class=\"comment\">// minCapacity is usually close to size, so this is a win:</span></span><br><span class=\"line\">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Arrayscopyof</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; T[] copyOf(T[] original, <span class=\"type\">int</span> newLength) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (T[]) copyOf(original, newLength, original.getClass());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T,U&gt; T[] copyOf(U[] original, <span class=\"type\">int</span> newLength, Class&lt;? <span class=\"keyword\">extends</span> <span class=\"title class_\">T</span>[]&gt; newType) &#123;</span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class=\"line\">    T[] copy = ((Object)newType == (Object)Object[].class)</span><br><span class=\"line\">        ? (T[]) <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>[newLength]</span><br><span class=\"line\">        : (T[]) Array.newInstance(newType.getComponentType(), newLength);</span><br><span class=\"line\">    System.arraycopy(original, <span class=\"number\">0</span>, copy, <span class=\"number\">0</span>,</span><br><span class=\"line\">                     Math.min(original.length, newLength));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> copy;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">arraycopy</span><span class=\"params\">(Object src,  <span class=\"type\">int</span>  srcPos,</span></span><br><span class=\"line\"><span class=\"params\">                                    Object dest, <span class=\"type\">int</span> destPos,</span></span><br><span class=\"line\"><span class=\"params\">                                    <span class=\"type\">int</span> length)</span>;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n"},{"title":"Callable","date":"2021-04-10T12:40:00.000Z","comments":0,"description":" FutureTask ","_content":"\n\n\n Callable\\<T\\> \n\n```java\npublic class ThreadCallable {\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        FutureTask<String> futureTask = new FutureTask<>(new MyThread0403());\n        new Thread(futureTask,\"A\").start();\n        String result = futureTask.get();\n        System.out.println(result);\n    }\n}\n//  Callable<T> ,T\nclass MyThread0403 implements Callable<String> {\n    @Override\n    public String call() throws Exception {\n        System.out.println(Thread.currentThread().getName()+\"--->Call()\");\n        return \"1024\";\n    }\n}\n```\n\n Thread  public Thread(Runnable target, String name)  Runnable FutureTask\n\n```java\n//  RunnableFuture\npublic class FutureTask<V> implements RunnableFuture<V> {}\n\n// RunnableFutureRunnableFutureTaskRunnable\npublic interface RunnableFuture<V> extends Runnable, Future<V> {}\n```\n\nFuture.get() call","source":"_posts/Java - Callable.md","raw":"---\ntitle: Callable\ndate: 2021-04-10 20:40:00\ntags:\n- JUC\ncomments: false\ndescription:  FutureTask \n---\n\n\n\n Callable\\<T\\> \n\n```java\npublic class ThreadCallable {\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        FutureTask<String> futureTask = new FutureTask<>(new MyThread0403());\n        new Thread(futureTask,\"A\").start();\n        String result = futureTask.get();\n        System.out.println(result);\n    }\n}\n//  Callable<T> ,T\nclass MyThread0403 implements Callable<String> {\n    @Override\n    public String call() throws Exception {\n        System.out.println(Thread.currentThread().getName()+\"--->Call()\");\n        return \"1024\";\n    }\n}\n```\n\n Thread  public Thread(Runnable target, String name)  Runnable FutureTask\n\n```java\n//  RunnableFuture\npublic class FutureTask<V> implements RunnableFuture<V> {}\n\n// RunnableFutureRunnableFutureTaskRunnable\npublic interface RunnableFuture<V> extends Runnable, Future<V> {}\n```\n\nFuture.get() call","slug":"Java - Callable","published":1,"updated":"2022-02-28T10:59:26.090Z","_id":"cl06jc54a000wqwu51oeq1w13","layout":"post","photos":[],"link":"","content":"<p></p>\n<p> Callable&lt;T&gt; </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadCallable</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">        FutureTask&lt;String&gt; futureTask = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">MyThread0403</span>());</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(futureTask,<span class=\"string\">&quot;A&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> futureTask.get();</span><br><span class=\"line\">        System.out.println(result);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//  Callable&lt;T&gt; ,T</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyThread0403</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Callable</span>&lt;String&gt; &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;---&gt;Call()&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;1024&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> Thread  public Thread(Runnable target, String name)  Runnable FutureTask</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  RunnableFuture</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FutureTask</span>&lt;V&gt; <span class=\"keyword\">implements</span> <span class=\"title class_\">RunnableFuture</span>&lt;V&gt; &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// RunnableFutureRunnableFutureTaskRunnable</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">RunnableFuture</span>&lt;V&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">Runnable</span>, Future&lt;V&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Future.get() call</p>\n","site":{"data":{}},"excerpt":"","more":"<p></p>\n<p> Callable&lt;T&gt; </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadCallable</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">        FutureTask&lt;String&gt; futureTask = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">MyThread0403</span>());</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(futureTask,<span class=\"string\">&quot;A&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> futureTask.get();</span><br><span class=\"line\">        System.out.println(result);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//  Callable&lt;T&gt; ,T</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyThread0403</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Callable</span>&lt;String&gt; &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;---&gt;Call()&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;1024&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> Thread  public Thread(Runnable target, String name)  Runnable FutureTask</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  RunnableFuture</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FutureTask</span>&lt;V&gt; <span class=\"keyword\">implements</span> <span class=\"title class_\">RunnableFuture</span>&lt;V&gt; &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// RunnableFutureRunnableFutureTaskRunnable</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">RunnableFuture</span>&lt;V&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">Runnable</span>, Future&lt;V&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Future.get() call</p>\n"},{"title":"","date":"2021-04-12T14:21:00.000Z","comments":0,"description":"stopsuspendresume ","_content":"\n##  - \n\n###  \n\n\t\tThread.stop()Javabreak\n\n\t\tstopsuspendresume \n\n\t\t Thread.stop() **** \n\n\t\t  Thread.interrupt() \n\n\t\tJava3\n\n\t\t1\n\n\t\t2 stop() \n\n\t\t3 interrupt() \n\n### interrupt() \n\n\t\n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n        MyThread myThread = new MyThread();\n        myThread.start();\n        Thread.sleep(1000);\n        myThread.interrupt();\n        System.out.println(\"mrdjun\");\n    }\n}\n\nclass MyThread extends Thread {\n    @Override\n    public void run() {\n        super.run();\n        for (int i = 0; i < 1000000; i++) {\n            System.out.println(\"i=\" + (i + 1));\n        }\n    }\n}\n```\n\n **1000000**  mrdjun  interrupt \n\n### \n\n\tJava\n\n\tpublic static boolean interrupted()  Thread.interrupted()  false \n\n\tpublic boolean this.isInterrupted()  this \n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n        MyThread myThread = new MyThread();\n        myThread.start();\n        Thread.sleep(1000);\n        myThread.interrupt(); //  myThread \n        // isInterrupted \n        System.out.println(\"\"+myThread.isInterrupted());\n        System.out.println(\"\"+myThread.isInterrupted());\n    }\n}\n```\n\n\t\t Thread.interrupted()  Thread.java static currentThread() \n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n      \tThread.currentThread().interrupt(); //  Thread\n        // isInterrupted \n        System.out.println(\"\"+ Thread.interrupted()); //  true\n        System.out.println(\"\"+ Thread.interrupted()); //  false\n        System.out.println(\"END!\");\n    }\n}\n```\n\n interrupted() \n\n> false\n\nisInterrupted() \n\n``` java\npublic boolean isInterrupted();\n```\n\nstatic\n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n        MyThread myThread = new MyThread();\n        myThread.start();\n        Thread.sleep(1000);\n\t    myThread.interrupt();\n        System.out.println(\"\" + myThread.isInterrupted()); //  true\n        System.out.println(\"\" + myThread.isInterrupted()); //  true\n        System.out.println(\"END!\");\n    }\n}\n```\n\n\n\n1Thread.interrupted() false\n\n2new Thread().isInterrupted() Thread\n\n###  \n\n\tmain Thread  myThread.interrupt() for if \n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n        MyThread myThread = new MyThread();\n        myThread.start();\n        Thread.sleep(500);\n        myThread.interrupt();\n    }\n}\n\nclass MyThread extends Thread {\n    @Override\n    public void run() {\n        super.run();\n        try {\n            for (int i = 0; i < 5000000; i++) {\n                if (interrupted()) {\n                    System.out.println(\"\");\n                    //  return;  throw new InterruptedException() \n                    throw new InterruptedException();\n                }\n                System.out.println(\"i=\" + (i + 1));\n            }\n            System.out.println(\"for\");\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n\n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) {\n        try {\n            MyThread myThread = new MyThread();\n            myThread.start();\n            Thread.sleep(1000);\n            myThread.interrupt();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\nclass MyThread extends Thread {\n    @Override\n    public void run() {\n        super.run();\n        try {\n            for (int i = 0; i < 5000000; i++) {\n                if (interrupted()) {\n                    System.out.println(\"\");\n                    throw new InterruptedException();\n                }\n                System.out.println(\"i=\" + (i + 1));\n            }\n            System.out.println(\"for\");\n        } catch (Exception e) {\n            System.out.println(\"\");\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n\n\n```java\ni=312961\ni=312962\n\n\njava.lang.InterruptedException\n\tat com.fun.async.test.class03.MyThread.run(ThreadInterrupt.java:34)\n```\n\n###  sleep \n\n``` java\npublic class SleepThreadInterrupt {\n    public static void main(String[] args) {\n        try {\n            MyThread thread = new MyThread();\n            thread.start();\n            Thread.sleep(200); // sleep  interrupt\n            thread.interrupt();\n            System.out.println(\"complete!\");\n        } catch (InterruptedException e) {\n            System.out.println(\"main catch\");\n            e.printStackTrace();\n        }\n    }\n\n    static class MyThread extends Thread{\n        @Override\n        public void run() {\n            super.run();\n            try {\n                System.out.println(\"run start ...\");\n                Thread.sleep(200000);\n                System.out.println(\"run end!\");\n            } catch (InterruptedException e) {\n                System.out.println(\"sleepcatch\"+this.isInterrupted());\n                e.printStackTrace();\n            }\n        }\n    }\n}\n```\n\n sleep  catch false\n\n``` java\nrun start ...\ncomplete!\nsleepcatchfalse\njava.lang.InterruptedException: sleep interrupted\n\tat java.lang.Thread.sleep(Native Method)\n\tat com.fun.async.test.class03.SleepThreadInterrupt$MyThread.run(SleepThreadInterrupt.java:26)\n\n```\n\n","source":"_posts/Java - interrupt+isInterrupted.md","raw":"---\ntitle: \ndate: 2021-04-12 22:21:00\ntags:\n- JUC\ncomments: false\ndescription: stopsuspendresume \n---\n\n##  - \n\n###  \n\n\t\tThread.stop()Javabreak\n\n\t\tstopsuspendresume \n\n\t\t Thread.stop() **** \n\n\t\t  Thread.interrupt() \n\n\t\tJava3\n\n\t\t1\n\n\t\t2 stop() \n\n\t\t3 interrupt() \n\n### interrupt() \n\n\t\n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n        MyThread myThread = new MyThread();\n        myThread.start();\n        Thread.sleep(1000);\n        myThread.interrupt();\n        System.out.println(\"mrdjun\");\n    }\n}\n\nclass MyThread extends Thread {\n    @Override\n    public void run() {\n        super.run();\n        for (int i = 0; i < 1000000; i++) {\n            System.out.println(\"i=\" + (i + 1));\n        }\n    }\n}\n```\n\n **1000000**  mrdjun  interrupt \n\n### \n\n\tJava\n\n\tpublic static boolean interrupted()  Thread.interrupted()  false \n\n\tpublic boolean this.isInterrupted()  this \n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n        MyThread myThread = new MyThread();\n        myThread.start();\n        Thread.sleep(1000);\n        myThread.interrupt(); //  myThread \n        // isInterrupted \n        System.out.println(\"\"+myThread.isInterrupted());\n        System.out.println(\"\"+myThread.isInterrupted());\n    }\n}\n```\n\n\t\t Thread.interrupted()  Thread.java static currentThread() \n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n      \tThread.currentThread().interrupt(); //  Thread\n        // isInterrupted \n        System.out.println(\"\"+ Thread.interrupted()); //  true\n        System.out.println(\"\"+ Thread.interrupted()); //  false\n        System.out.println(\"END!\");\n    }\n}\n```\n\n interrupted() \n\n> false\n\nisInterrupted() \n\n``` java\npublic boolean isInterrupted();\n```\n\nstatic\n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n        MyThread myThread = new MyThread();\n        myThread.start();\n        Thread.sleep(1000);\n\t    myThread.interrupt();\n        System.out.println(\"\" + myThread.isInterrupted()); //  true\n        System.out.println(\"\" + myThread.isInterrupted()); //  true\n        System.out.println(\"END!\");\n    }\n}\n```\n\n\n\n1Thread.interrupted() false\n\n2new Thread().isInterrupted() Thread\n\n###  \n\n\tmain Thread  myThread.interrupt() for if \n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n        MyThread myThread = new MyThread();\n        myThread.start();\n        Thread.sleep(500);\n        myThread.interrupt();\n    }\n}\n\nclass MyThread extends Thread {\n    @Override\n    public void run() {\n        super.run();\n        try {\n            for (int i = 0; i < 5000000; i++) {\n                if (interrupted()) {\n                    System.out.println(\"\");\n                    //  return;  throw new InterruptedException() \n                    throw new InterruptedException();\n                }\n                System.out.println(\"i=\" + (i + 1));\n            }\n            System.out.println(\"for\");\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n\n\n``` java\npublic class ThreadInterrupt {\n    public static void main(String[] args) {\n        try {\n            MyThread myThread = new MyThread();\n            myThread.start();\n            Thread.sleep(1000);\n            myThread.interrupt();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\nclass MyThread extends Thread {\n    @Override\n    public void run() {\n        super.run();\n        try {\n            for (int i = 0; i < 5000000; i++) {\n                if (interrupted()) {\n                    System.out.println(\"\");\n                    throw new InterruptedException();\n                }\n                System.out.println(\"i=\" + (i + 1));\n            }\n            System.out.println(\"for\");\n        } catch (Exception e) {\n            System.out.println(\"\");\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n\n\n```java\ni=312961\ni=312962\n\n\njava.lang.InterruptedException\n\tat com.fun.async.test.class03.MyThread.run(ThreadInterrupt.java:34)\n```\n\n###  sleep \n\n``` java\npublic class SleepThreadInterrupt {\n    public static void main(String[] args) {\n        try {\n            MyThread thread = new MyThread();\n            thread.start();\n            Thread.sleep(200); // sleep  interrupt\n            thread.interrupt();\n            System.out.println(\"complete!\");\n        } catch (InterruptedException e) {\n            System.out.println(\"main catch\");\n            e.printStackTrace();\n        }\n    }\n\n    static class MyThread extends Thread{\n        @Override\n        public void run() {\n            super.run();\n            try {\n                System.out.println(\"run start ...\");\n                Thread.sleep(200000);\n                System.out.println(\"run end!\");\n            } catch (InterruptedException e) {\n                System.out.println(\"sleepcatch\"+this.isInterrupted());\n                e.printStackTrace();\n            }\n        }\n    }\n}\n```\n\n sleep  catch false\n\n``` java\nrun start ...\ncomplete!\nsleepcatchfalse\njava.lang.InterruptedException: sleep interrupted\n\tat java.lang.Thread.sleep(Native Method)\n\tat com.fun.async.test.class03.SleepThreadInterrupt$MyThread.run(SleepThreadInterrupt.java:26)\n\n```\n\n","slug":"Java - interrupt+isInterrupted","published":1,"updated":"2022-02-28T10:55:00.713Z","_id":"cl06jfuo3000yqwu5g54wbl9h","layout":"post","photos":[],"link":"","content":"<h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" - \"></a> - </h2><h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h3><p>        Thread.stop()Javabreak</p>\n<p>        stopsuspendresume </p>\n<p>         Thread.stop() <strong></strong> </p>\n<p>          Thread.interrupt() </p>\n<p>        Java3</p>\n<p>        1</p>\n<p>        2 stop() </p>\n<p>        3 interrupt() </p>\n<h3 id=\"interrupt-\"><a href=\"#interrupt-\" class=\"headerlink\" title=\"interrupt() \"></a>interrupt() </h3><p>    </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        myThread.interrupt();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;mrdjun&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000000</span>; i++) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;i=&quot;</span> + (i + <span class=\"number\">1</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <strong>1000000</strong>  mrdjun  interrupt </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>    Java</p>\n<p>    public static boolean interrupted()  Thread.interrupted()  false </p>\n<p>    public boolean this.isInterrupted()  this </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        myThread.interrupt(); <span class=\"comment\">//  myThread </span></span><br><span class=\"line\">        <span class=\"comment\">// isInterrupted </span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>+myThread.isInterrupted());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>+myThread.isInterrupted());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>         Thread.interrupted()  Thread.java static currentThread() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">      \tThread.currentThread().interrupt(); <span class=\"comment\">//  Thread</span></span><br><span class=\"line\">        <span class=\"comment\">// isInterrupted </span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>+ Thread.interrupted()); <span class=\"comment\">//  true</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>+ Thread.interrupted()); <span class=\"comment\">//  false</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;END!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> interrupted() </p>\n<blockquote>\n<p>false</p>\n</blockquote>\n<p>isInterrupted() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isInterrupted</span><span class=\"params\">()</span>;</span><br></pre></td></tr></table></figure>\n\n<p>static</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">\t    myThread.interrupt();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + myThread.isInterrupted()); <span class=\"comment\">//  true</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + myThread.isInterrupted()); <span class=\"comment\">//  true</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;END!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>1Thread.interrupted() false</p>\n<p>2new Thread().isInterrupted() Thread</p>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h3><p>    main Thread  myThread.interrupt() for if </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">500</span>);</span><br><span class=\"line\">        myThread.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000000</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (interrupted()) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                    <span class=\"comment\">//  return;  throw new InterruptedException() </span></span><br><span class=\"line\">                    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">InterruptedException</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;i=&quot;</span> + (i + <span class=\"number\">1</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;for&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">            myThread.start();</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">            myThread.interrupt();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000000</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (interrupted()) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">InterruptedException</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;i=&quot;</span> + (i + <span class=\"number\">1</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;for&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">i=<span class=\"number\">312961</span></span><br><span class=\"line\">i=<span class=\"number\">312962</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">java.lang.InterruptedException</span><br><span class=\"line\">\tat com.fun.async.test.class03.MyThread.run(ThreadInterrupt.java:<span class=\"number\">34</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-sleep-\"><a href=\"#-sleep-\" class=\"headerlink\" title=\" sleep \"></a> sleep </h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SleepThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">MyThread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">            thread.start();</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">200</span>); <span class=\"comment\">// sleep  interrupt</span></span><br><span class=\"line\">            thread.interrupt();</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;complete!&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;main catch&quot;</span>);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span>&#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;run start ...&quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">200000</span>);</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;run end!&quot;</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;sleepcatch&quot;</span>+<span class=\"built_in\">this</span>.isInterrupted());</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> sleep  catch false</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">run start ...</span><br><span class=\"line\">complete!</span><br><span class=\"line\">sleep<span class=\"keyword\">catch</span><span class=\"literal\">false</span></span><br><span class=\"line\">java.lang.InterruptedException: sleep interrupted</span><br><span class=\"line\">\tat java.lang.Thread.sleep(Native Method)</span><br><span class=\"line\">\tat com.fun.async.test.class03.SleepThreadInterrupt$MyThread.run(SleepThreadInterrupt.java:<span class=\"number\">26</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" - \"></a> - </h2><h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h3><p>        Thread.stop()Javabreak</p>\n<p>        stopsuspendresume </p>\n<p>         Thread.stop() <strong></strong> </p>\n<p>          Thread.interrupt() </p>\n<p>        Java3</p>\n<p>        1</p>\n<p>        2 stop() </p>\n<p>        3 interrupt() </p>\n<h3 id=\"interrupt-\"><a href=\"#interrupt-\" class=\"headerlink\" title=\"interrupt() \"></a>interrupt() </h3><p>    </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        myThread.interrupt();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;mrdjun&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000000</span>; i++) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;i=&quot;</span> + (i + <span class=\"number\">1</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <strong>1000000</strong>  mrdjun  interrupt </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>    Java</p>\n<p>    public static boolean interrupted()  Thread.interrupted()  false </p>\n<p>    public boolean this.isInterrupted()  this </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        myThread.interrupt(); <span class=\"comment\">//  myThread </span></span><br><span class=\"line\">        <span class=\"comment\">// isInterrupted </span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>+myThread.isInterrupted());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>+myThread.isInterrupted());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>         Thread.interrupted()  Thread.java static currentThread() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">      \tThread.currentThread().interrupt(); <span class=\"comment\">//  Thread</span></span><br><span class=\"line\">        <span class=\"comment\">// isInterrupted </span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>+ Thread.interrupted()); <span class=\"comment\">//  true</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>+ Thread.interrupted()); <span class=\"comment\">//  false</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;END!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> interrupted() </p>\n<blockquote>\n<p>false</p>\n</blockquote>\n<p>isInterrupted() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isInterrupted</span><span class=\"params\">()</span>;</span><br></pre></td></tr></table></figure>\n\n<p>static</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">\t    myThread.interrupt();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + myThread.isInterrupted()); <span class=\"comment\">//  true</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + myThread.isInterrupted()); <span class=\"comment\">//  true</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;END!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>1Thread.interrupted() false</p>\n<p>2new Thread().isInterrupted() Thread</p>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h3><p>    main Thread  myThread.interrupt() for if </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">500</span>);</span><br><span class=\"line\">        myThread.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000000</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (interrupted()) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                    <span class=\"comment\">//  return;  throw new InterruptedException() </span></span><br><span class=\"line\">                    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">InterruptedException</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;i=&quot;</span> + (i + <span class=\"number\">1</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;for&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">            myThread.start();</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">            myThread.interrupt();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000000</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (interrupted()) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">InterruptedException</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;i=&quot;</span> + (i + <span class=\"number\">1</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;for&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">i=<span class=\"number\">312961</span></span><br><span class=\"line\">i=<span class=\"number\">312962</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">java.lang.InterruptedException</span><br><span class=\"line\">\tat com.fun.async.test.class03.MyThread.run(ThreadInterrupt.java:<span class=\"number\">34</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-sleep-\"><a href=\"#-sleep-\" class=\"headerlink\" title=\" sleep \"></a> sleep </h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SleepThreadInterrupt</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">MyThread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">            thread.start();</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">200</span>); <span class=\"comment\">// sleep  interrupt</span></span><br><span class=\"line\">            thread.interrupt();</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;complete!&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;main catch&quot;</span>);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span>&#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;run start ...&quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">200000</span>);</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;run end!&quot;</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;sleepcatch&quot;</span>+<span class=\"built_in\">this</span>.isInterrupted());</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> sleep  catch false</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">run start ...</span><br><span class=\"line\">complete!</span><br><span class=\"line\">sleep<span class=\"keyword\">catch</span><span class=\"literal\">false</span></span><br><span class=\"line\">java.lang.InterruptedException: sleep interrupted</span><br><span class=\"line\">\tat java.lang.Thread.sleep(Native Method)</span><br><span class=\"line\">\tat com.fun.async.test.class03.SleepThreadInterrupt$MyThread.run(SleepThreadInterrupt.java:<span class=\"number\">26</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n"},{"title":"JMM ","date":"2021-08-22T04:51:00.000Z","comments":0,"description":"CPUCPU","_content":"\n# Java - JMM \n\n## CPU\n\n### 1CPU - \n\nCPUCPU\n\n![CPU](.\\images\\CPU.png)\n\n****\n\nCPUCPU\n\n- L1 Cache()CPU********CPUL1 32-4096KB\n- L2 Cache() L1CPUCPU\n- L3 L3L3L3\n\n****\n\nCPUCPU\n\n CPU  MESI\n\n- (Modified) cache()cache\n\n- (Exclusive)cachecache\n\n- (Shared)cachecache\n\n- (Invalid)cache()\n\n\nCPUCPUCPUCPU****\n\nCPUCPU\n\n### 2CPU - \n\nCPU****CPUCPU****\n\n![CPU](.\\images\\CPU.png)\n\n** as-if-serial **()()runtime  as-if-serial ****\n\n`as-if-serial``as-if-serial`CPU****\n\n## \n\n\n\n(Memory Barrier) \n\n- (Load Memory Barrier)Load BarrierCPU\n\n- (Store Memory Barrier)Store BarrierCPU\n\n## JMM \n\n[JVM](./Java - JVM)JVMheap\n\nJava\n\nJMM \n\n1\n\n2\n\n3\n\n![JMM](./images/JMM.png)\n\nAflag=truestore\n\nlock unlock \n\n Java \n\n```java\npublic static int n = 0;\npublic void test() throws InterruptedException {\n    new Thread(() -> {\n        while (n == 0) {\n        }\n    }, \"A\").start();\n\t\n    //  1s n=1A\n    Thread.sleep(1000);\n    n = 1;\n    System.out.println(\"\");\n}\n```\n\nAn=0mainn1AA\n\n volatile \n\n\n\n## \n\ndata data \n\n![image-20210412160457763](.\\images\\.png)\n\nJava javap classJIT - Just In Time\n\n```\nJust In Time?\nJavaInterpreterJVMHot Spot CodeJVMJust In Time CompilerJIT\nJITC/C++\n\nJITJVMJVMJITJITJITJVM\n```\n\n![image-20210412161108065](.\\images\\.png)\n\n\n\n![image-20210412161403491](.\\images\\.png)\n\njava.exe classJVMJITclass \n\nJVM n=0while(n==0) JIT if(n==0){while(true){}}  n Java\n\n```java\n// int n = 0;\nwhile (n == 0) {}  JIT if(n==0){while(true){}}\n```\n\n\n\n```java\nnew Thread(() -> {\n    while (n == 0) {\n        synchronized(this){\n            add();\n        }\n    }\n}, \"A\").start();\n```\n\n## \n\nwrite\nread()\nlock(monitor)\nunlock\n(socket..)\n\n\n\n\n## happenbefore \n\nhappen-beforeJMMJMM happens-before\n\n\n\n1\n\n2unlocklock\n\n3volatilevolatile\n\n4Thread  start() \n\n5thread.jointhread.isAlive\n\n6interruptinterrupt\n\n7finalize\n\n8ABBCAC\n\n## final JMM\n\nread() finalfinal0\n\n```java\nclass A {\n    final int x;\n    int y;\n    static A a;\n    \n    public A() {\n        x=3;\n        y=4;\n    }\n    \n    static void write(){\n        a = new A();\n    }\n   \n    static void read(){\n        if(f!=null){\n            int i = a.x; // 3\n            int j = a.y; // 0\n        }\n    }\n}\n```\n\nfinalr = bew A()k = r.a \n\n","source":"_posts/Java - JMM .md","raw":"---\ntitle: JMM \ndate: 2021-08-22 12:51:00\ntags:\n- JUC\ncomments: false\ndescription: CPUCPU\n---\n\n# Java - JMM \n\n## CPU\n\n### 1CPU - \n\nCPUCPU\n\n![CPU](.\\images\\CPU.png)\n\n****\n\nCPUCPU\n\n- L1 Cache()CPU********CPUL1 32-4096KB\n- L2 Cache() L1CPUCPU\n- L3 L3L3L3\n\n****\n\nCPUCPU\n\n CPU  MESI\n\n- (Modified) cache()cache\n\n- (Exclusive)cachecache\n\n- (Shared)cachecache\n\n- (Invalid)cache()\n\n\nCPUCPUCPUCPU****\n\nCPUCPU\n\n### 2CPU - \n\nCPU****CPUCPU****\n\n![CPU](.\\images\\CPU.png)\n\n** as-if-serial **()()runtime  as-if-serial ****\n\n`as-if-serial``as-if-serial`CPU****\n\n## \n\n\n\n(Memory Barrier) \n\n- (Load Memory Barrier)Load BarrierCPU\n\n- (Store Memory Barrier)Store BarrierCPU\n\n## JMM \n\n[JVM](./Java - JVM)JVMheap\n\nJava\n\nJMM \n\n1\n\n2\n\n3\n\n![JMM](./images/JMM.png)\n\nAflag=truestore\n\nlock unlock \n\n Java \n\n```java\npublic static int n = 0;\npublic void test() throws InterruptedException {\n    new Thread(() -> {\n        while (n == 0) {\n        }\n    }, \"A\").start();\n\t\n    //  1s n=1A\n    Thread.sleep(1000);\n    n = 1;\n    System.out.println(\"\");\n}\n```\n\nAn=0mainn1AA\n\n volatile \n\n\n\n## \n\ndata data \n\n![image-20210412160457763](.\\images\\.png)\n\nJava javap classJIT - Just In Time\n\n```\nJust In Time?\nJavaInterpreterJVMHot Spot CodeJVMJust In Time CompilerJIT\nJITC/C++\n\nJITJVMJVMJITJITJITJVM\n```\n\n![image-20210412161108065](.\\images\\.png)\n\n\n\n![image-20210412161403491](.\\images\\.png)\n\njava.exe classJVMJITclass \n\nJVM n=0while(n==0) JIT if(n==0){while(true){}}  n Java\n\n```java\n// int n = 0;\nwhile (n == 0) {}  JIT if(n==0){while(true){}}\n```\n\n\n\n```java\nnew Thread(() -> {\n    while (n == 0) {\n        synchronized(this){\n            add();\n        }\n    }\n}, \"A\").start();\n```\n\n## \n\nwrite\nread()\nlock(monitor)\nunlock\n(socket..)\n\n\n\n\n## happenbefore \n\nhappen-beforeJMMJMM happens-before\n\n\n\n1\n\n2unlocklock\n\n3volatilevolatile\n\n4Thread  start() \n\n5thread.jointhread.isAlive\n\n6interruptinterrupt\n\n7finalize\n\n8ABBCAC\n\n## final JMM\n\nread() finalfinal0\n\n```java\nclass A {\n    final int x;\n    int y;\n    static A a;\n    \n    public A() {\n        x=3;\n        y=4;\n    }\n    \n    static void write(){\n        a = new A();\n    }\n   \n    static void read(){\n        if(f!=null){\n            int i = a.x; // 3\n            int j = a.y; // 0\n        }\n    }\n}\n```\n\nfinalr = bew A()k = r.a \n\n","slug":"Java - JMM ","published":1,"updated":"2022-02-28T10:56:10.790Z","_id":"cl06jhww10010qwu5gy4vg7b9","layout":"post","photos":[],"link":"","content":"<h1 id=\"Java-JMM-\"><a href=\"#Java-JMM-\" class=\"headerlink\" title=\"Java - JMM \"></a>Java - JMM </h1><h2 id=\"CPU\"><a href=\"#CPU\" class=\"headerlink\" title=\"CPU\"></a>CPU</h2><h3 id=\"1CPU-\"><a href=\"#1CPU-\" class=\"headerlink\" title=\"1CPU - \"></a>1CPU - </h3><p>CPUCPU</p>\n<p><img src=\".%5Cimages%5CCPU%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98%E7%BA%A7%E5%88%AB.png\" alt=\"CPU\"></p>\n<p><strong></strong></p>\n<p>CPUCPU</p>\n<ul>\n<li>L1 Cache()CPU<strong></strong><strong></strong>CPUL1 32-4096KB</li>\n<li>L2 Cache() L1CPUCPU</li>\n<li>L3 L3L3L3</li>\n</ul>\n<p><strong></strong></p>\n<p>CPUCPU</p>\n<p> CPU  MESI</p>\n<ul>\n<li><p>(Modified) cache()cache</p>\n</li>\n<li><p>(Exclusive)cachecache</p>\n</li>\n<li><p>(Shared)cachecache</p>\n</li>\n<li><p>(Invalid)cache()</p>\n</li>\n</ul>\n<p>CPUCPUCPUCPU<strong></strong></p>\n<p>CPUCPU</p>\n<h3 id=\"2CPU-\"><a href=\"#2CPU-\" class=\"headerlink\" title=\"2CPU - \"></a>2CPU - </h3><p>CPU<strong></strong>CPUCPU<strong></strong></p>\n<p><img src=\".%5Cimages%5CCPU%E8%BF%90%E8%A1%8C%E6%97%B6%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92.png\" alt=\"CPU\"></p>\n<p><strong> as-if-serial </strong>()()runtime  as-if-serial <strong></strong></p>\n<p><code>as-if-serial</code><code>as-if-serial</code>CPU<strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>(Memory Barrier) </p>\n<ul>\n<li><p>(Load Memory Barrier)Load BarrierCPU</p>\n</li>\n<li><p>(Store Memory Barrier)Store BarrierCPU</p>\n</li>\n</ul>\n<h2 id=\"JMM-\"><a href=\"#JMM-\" class=\"headerlink\" title=\"JMM \"></a>JMM </h2><p>[JVM](./Java - JVM)JVMheap</p>\n<p>Java</p>\n<p>JMM </p>\n<p>1</p>\n<p>2</p>\n<p>3</p>\n<p><img src=\"./images/JMM.png\" alt=\"JMM\"></p>\n<p>Aflag=truestore</p>\n<p>lock unlock </p>\n<p> Java </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (n == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;A&quot;</span>).start();</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"comment\">//  1s n=1A</span></span><br><span class=\"line\">    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">    n = <span class=\"number\">1</span>;</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>An=0mainn1AA</p>\n<p> volatile </p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>data data </p>\n<p><img src=\".%5Cimages%5C%E5%B7%A5%E4%BD%9C%E5%86%85%E5%AD%98%E7%BC%93%E5%AD%98%E7%BB%93%E6%9E%84.png\" alt=\"image-20210412160457763\"></p>\n<p>Java javap classJIT - Just In Time</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Just In Time?</span><br><span class=\"line\">JavaInterpreterJVMHot Spot CodeJVMJust In Time CompilerJIT</span><br><span class=\"line\">JITC/C++</span><br><span class=\"line\"></span><br><span class=\"line\">JITJVMJVMJITJITJITJVM</span><br></pre></td></tr></table></figure>\n\n<p><img src=\".%5Cimages%5C%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92%E5%BA%8F%E5%BC%95%E8%B5%B7%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%8F%AF%E8%A7%81%E6%80%A7%E9%97%AE%E9%A2%98.png\" alt=\"image-20210412161108065\"></p>\n<p></p>\n<p><img src=\".%5Cimages%5C%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92%E5%BA%8F%E4%B8%AD%E7%9A%84%E7%AD%89%E6%95%88%E6%9B%BF%E6%8D%A2.png\" alt=\"image-20210412161403491\"></p>\n<p>java.exe classJVMJITclass </p>\n<p>JVM n=0while(n==0) JIT if(n==0){while(true){}}  n Java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// int n = 0;</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (n == <span class=\"number\">0</span>) &#123;&#125;  JIT <span class=\"keyword\">if</span>(n==<span class=\"number\">0</span>)&#123;<span class=\"keyword\">while</span>(<span class=\"literal\">true</span>)&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span>(<span class=\"built_in\">this</span>)&#123;</span><br><span class=\"line\">            add();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;, <span class=\"string\">&quot;A&quot;</span>).start();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>write<br>read()<br>lock(monitor)<br>unlock<br>(socket..)<br></p>\n<p></p>\n<h2 id=\"happenbefore-\"><a href=\"#happenbefore-\" class=\"headerlink\" title=\"happenbefore \"></a>happenbefore </h2><p>happen-beforeJMMJMM happens-before</p>\n<p></p>\n<p>1</p>\n<p>2unlocklock</p>\n<p>3volatilevolatile</p>\n<p>4Thread  start() </p>\n<p>5thread.jointhread.isAlive</p>\n<p>6interruptinterrupt</p>\n<p>7finalize</p>\n<p>8ABBCAC</p>\n<h2 id=\"final-JMM\"><a href=\"#final-JMM\" class=\"headerlink\" title=\"final JMM\"></a>final JMM</h2><p>read() finalfinal0</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">A</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"type\">int</span> x;</span><br><span class=\"line\">    <span class=\"type\">int</span> y;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> A a;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">A</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        x=<span class=\"number\">3</span>;</span><br><span class=\"line\">        y=<span class=\"number\">4</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">write</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        a = <span class=\"keyword\">new</span> <span class=\"title class_\">A</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">read</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f!=<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> a.x; <span class=\"comment\">// 3</span></span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> a.y; <span class=\"comment\">// 0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>finalr = bew A()k = r.a </p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Java-JMM-\"><a href=\"#Java-JMM-\" class=\"headerlink\" title=\"Java - JMM \"></a>Java - JMM </h1><h2 id=\"CPU\"><a href=\"#CPU\" class=\"headerlink\" title=\"CPU\"></a>CPU</h2><h3 id=\"1CPU-\"><a href=\"#1CPU-\" class=\"headerlink\" title=\"1CPU - \"></a>1CPU - </h3><p>CPUCPU</p>\n<p><img src=\".%5Cimages%5CCPU%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98%E7%BA%A7%E5%88%AB.png\" alt=\"CPU\"></p>\n<p><strong></strong></p>\n<p>CPUCPU</p>\n<ul>\n<li>L1 Cache()CPU<strong></strong><strong></strong>CPUL1 32-4096KB</li>\n<li>L2 Cache() L1CPUCPU</li>\n<li>L3 L3L3L3</li>\n</ul>\n<p><strong></strong></p>\n<p>CPUCPU</p>\n<p> CPU  MESI</p>\n<ul>\n<li><p>(Modified) cache()cache</p>\n</li>\n<li><p>(Exclusive)cachecache</p>\n</li>\n<li><p>(Shared)cachecache</p>\n</li>\n<li><p>(Invalid)cache()</p>\n</li>\n</ul>\n<p>CPUCPUCPUCPU<strong></strong></p>\n<p>CPUCPU</p>\n<h3 id=\"2CPU-\"><a href=\"#2CPU-\" class=\"headerlink\" title=\"2CPU - \"></a>2CPU - </h3><p>CPU<strong></strong>CPUCPU<strong></strong></p>\n<p><img src=\".%5Cimages%5CCPU%E8%BF%90%E8%A1%8C%E6%97%B6%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92.png\" alt=\"CPU\"></p>\n<p><strong> as-if-serial </strong>()()runtime  as-if-serial <strong></strong></p>\n<p><code>as-if-serial</code><code>as-if-serial</code>CPU<strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>(Memory Barrier) </p>\n<ul>\n<li><p>(Load Memory Barrier)Load BarrierCPU</p>\n</li>\n<li><p>(Store Memory Barrier)Store BarrierCPU</p>\n</li>\n</ul>\n<h2 id=\"JMM-\"><a href=\"#JMM-\" class=\"headerlink\" title=\"JMM \"></a>JMM </h2><p>[JVM](./Java - JVM)JVMheap</p>\n<p>Java</p>\n<p>JMM </p>\n<p>1</p>\n<p>2</p>\n<p>3</p>\n<p><img src=\"./images/JMM.png\" alt=\"JMM\"></p>\n<p>Aflag=truestore</p>\n<p>lock unlock </p>\n<p> Java </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (n == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;A&quot;</span>).start();</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"comment\">//  1s n=1A</span></span><br><span class=\"line\">    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">    n = <span class=\"number\">1</span>;</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>An=0mainn1AA</p>\n<p> volatile </p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>data data </p>\n<p><img src=\".%5Cimages%5C%E5%B7%A5%E4%BD%9C%E5%86%85%E5%AD%98%E7%BC%93%E5%AD%98%E7%BB%93%E6%9E%84.png\" alt=\"image-20210412160457763\"></p>\n<p>Java javap classJIT - Just In Time</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Just In Time?</span><br><span class=\"line\">JavaInterpreterJVMHot Spot CodeJVMJust In Time CompilerJIT</span><br><span class=\"line\">JITC/C++</span><br><span class=\"line\"></span><br><span class=\"line\">JITJVMJVMJITJITJITJVM</span><br></pre></td></tr></table></figure>\n\n<p><img src=\".%5Cimages%5C%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92%E5%BA%8F%E5%BC%95%E8%B5%B7%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%8F%AF%E8%A7%81%E6%80%A7%E9%97%AE%E9%A2%98.png\" alt=\"image-20210412161108065\"></p>\n<p></p>\n<p><img src=\".%5Cimages%5C%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92%E5%BA%8F%E4%B8%AD%E7%9A%84%E7%AD%89%E6%95%88%E6%9B%BF%E6%8D%A2.png\" alt=\"image-20210412161403491\"></p>\n<p>java.exe classJVMJITclass </p>\n<p>JVM n=0while(n==0) JIT if(n==0){while(true){}}  n Java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// int n = 0;</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (n == <span class=\"number\">0</span>) &#123;&#125;  JIT <span class=\"keyword\">if</span>(n==<span class=\"number\">0</span>)&#123;<span class=\"keyword\">while</span>(<span class=\"literal\">true</span>)&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span>(<span class=\"built_in\">this</span>)&#123;</span><br><span class=\"line\">            add();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;, <span class=\"string\">&quot;A&quot;</span>).start();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>write<br>read()<br>lock(monitor)<br>unlock<br>(socket..)<br></p>\n<p></p>\n<h2 id=\"happenbefore-\"><a href=\"#happenbefore-\" class=\"headerlink\" title=\"happenbefore \"></a>happenbefore </h2><p>happen-beforeJMMJMM happens-before</p>\n<p></p>\n<p>1</p>\n<p>2unlocklock</p>\n<p>3volatilevolatile</p>\n<p>4Thread  start() </p>\n<p>5thread.jointhread.isAlive</p>\n<p>6interruptinterrupt</p>\n<p>7finalize</p>\n<p>8ABBCAC</p>\n<h2 id=\"final-JMM\"><a href=\"#final-JMM\" class=\"headerlink\" title=\"final JMM\"></a>final JMM</h2><p>read() finalfinal0</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">A</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"type\">int</span> x;</span><br><span class=\"line\">    <span class=\"type\">int</span> y;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> A a;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">A</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        x=<span class=\"number\">3</span>;</span><br><span class=\"line\">        y=<span class=\"number\">4</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">write</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        a = <span class=\"keyword\">new</span> <span class=\"title class_\">A</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">read</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f!=<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> a.x; <span class=\"comment\">// 3</span></span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> a.y; <span class=\"comment\">// 0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>finalr = bew A()k = r.a </p>\n"},{"title":"","date":"2021-08-22T04:57:00.000Z","comments":0,"_content":"\nSpring5 java.util.concurrent DCLDouble Check Lock\n\n1\n\n```java\nprivate static LazySingleton singleton4;\n\nprivate static LazySingleton lazy() {\n    if (singleton4 == null) {\n        singleton4 = new LazySingleton();\n    }\n    return singleton4;\n}\n```\n\nif  LazySingleton() \n\n2\n\n\n\n```java\nprivate static LazySingleton singleton4;\n\nprivate synchronized static LazySingleton lazy() {\n    if (singleton4 == null) {\n        singleton4 = new LazySingleton();\n    }\n    return singleton4;\n}\n```\n\n3\n\n\t\t if ifif\n\t\t singleton4 = new LazySingleton()     CPU1231323 singleton4 iffalse singleton4 \n\n\tvolatile 123volatile \n\n```java\nprivate volatile static LazySingleton singleton4;\n\nprivate static LazySingleton lazy2() throws InterruptedException {\n    if (singleton4 == null) {\n        synchronized (LazySingleton.class) {\n            if (singleton4 == null) {\n                singleton4 = new LazySingleton();\n            }\n            return singleton4;\n        }\n    }\n    return singleton4;\n}\n```\n\n4\n\n\n\n\n\nConcurrentHashMapThreadLocal\n\n\n\n```java\nprivate enum Lazy4 {\n    INSTANCE;\n\n    public static Lazy4 getInstance() {\n        return INSTANCE;\n    }\n}\n\npublic static void main(String[] args) throws Exception {\n        Lazy4 instance1 = Lazy4.INSTANCE;\n        Constructor<Lazy4> declaredConstructor = Lazy4.class.getDeclaredConstructor(String.class, int.class);\n        declaredConstructor.setAccessible(true);\n        Lazy4 instance2 = declaredConstructor.newInstance(); \n        System.out.println(instance1); System.out.println(instance2);\n    }\n```\n\n","source":"_posts/Java - JUC .md","raw":"---\ntitle: \ndate: 2021-08-22 12:57:00\ntags:\n- JUC\ncomments: false\n---\n\nSpring5 java.util.concurrent DCLDouble Check Lock\n\n1\n\n```java\nprivate static LazySingleton singleton4;\n\nprivate static LazySingleton lazy() {\n    if (singleton4 == null) {\n        singleton4 = new LazySingleton();\n    }\n    return singleton4;\n}\n```\n\nif  LazySingleton() \n\n2\n\n\n\n```java\nprivate static LazySingleton singleton4;\n\nprivate synchronized static LazySingleton lazy() {\n    if (singleton4 == null) {\n        singleton4 = new LazySingleton();\n    }\n    return singleton4;\n}\n```\n\n3\n\n\t\t if ifif\n\t\t singleton4 = new LazySingleton()     CPU1231323 singleton4 iffalse singleton4 \n\n\tvolatile 123volatile \n\n```java\nprivate volatile static LazySingleton singleton4;\n\nprivate static LazySingleton lazy2() throws InterruptedException {\n    if (singleton4 == null) {\n        synchronized (LazySingleton.class) {\n            if (singleton4 == null) {\n                singleton4 = new LazySingleton();\n            }\n            return singleton4;\n        }\n    }\n    return singleton4;\n}\n```\n\n4\n\n\n\n\n\nConcurrentHashMapThreadLocal\n\n\n\n```java\nprivate enum Lazy4 {\n    INSTANCE;\n\n    public static Lazy4 getInstance() {\n        return INSTANCE;\n    }\n}\n\npublic static void main(String[] args) throws Exception {\n        Lazy4 instance1 = Lazy4.INSTANCE;\n        Constructor<Lazy4> declaredConstructor = Lazy4.class.getDeclaredConstructor(String.class, int.class);\n        declaredConstructor.setAccessible(true);\n        Lazy4 instance2 = declaredConstructor.newInstance(); \n        System.out.println(instance1); System.out.println(instance2);\n    }\n```\n\n","slug":"Java - JUC ","published":1,"updated":"2022-02-28T10:55:46.153Z","_id":"cl06jl8370012qwu593nj692r","layout":"post","photos":[],"link":"","content":"<p>Spring5 java.util.concurrent DCLDouble Check Lock</p>\n<p>1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LazySingleton singleton4;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LazySingleton <span class=\"title function_\">lazy</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (singleton4 == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        singleton4 = <span class=\"keyword\">new</span> <span class=\"title class_\">LazySingleton</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> singleton4;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>if  LazySingleton() </p>\n<p>2</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LazySingleton singleton4;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">static</span> LazySingleton <span class=\"title function_\">lazy</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (singleton4 == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        singleton4 = <span class=\"keyword\">new</span> <span class=\"title class_\">LazySingleton</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> singleton4;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3</p>\n<p>         if ifif<br>         singleton4 = new LazySingleton()     CPU1231323 singleton4 iffalse singleton4 </p>\n<p>    volatile 123volatile </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> LazySingleton singleton4;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LazySingleton <span class=\"title function_\">lazy2</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (singleton4 == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (LazySingleton.class) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (singleton4 == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                singleton4 = <span class=\"keyword\">new</span> <span class=\"title class_\">LazySingleton</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> singleton4;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> singleton4;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>4</p>\n<p></p>\n<p></p>\n<p>ConcurrentHashMapThreadLocal</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">enum</span> <span class=\"title class_\">Lazy4</span> &#123;</span><br><span class=\"line\">    INSTANCE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Lazy4 <span class=\"title function_\">getInstance</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> INSTANCE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">Lazy4</span> <span class=\"variable\">instance1</span> <span class=\"operator\">=</span> Lazy4.INSTANCE;</span><br><span class=\"line\">        Constructor&lt;Lazy4&gt; declaredConstructor = Lazy4.class.getDeclaredConstructor(String.class, <span class=\"type\">int</span>.class);</span><br><span class=\"line\">        declaredConstructor.setAccessible(<span class=\"literal\">true</span>);</span><br><span class=\"line\">        <span class=\"type\">Lazy4</span> <span class=\"variable\">instance2</span> <span class=\"operator\">=</span> declaredConstructor.newInstance(); </span><br><span class=\"line\">        System.out.println(instance1); System.out.println(instance2);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<p>Spring5 java.util.concurrent DCLDouble Check Lock</p>\n<p>1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LazySingleton singleton4;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LazySingleton <span class=\"title function_\">lazy</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (singleton4 == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        singleton4 = <span class=\"keyword\">new</span> <span class=\"title class_\">LazySingleton</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> singleton4;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>if  LazySingleton() </p>\n<p>2</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LazySingleton singleton4;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">static</span> LazySingleton <span class=\"title function_\">lazy</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (singleton4 == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        singleton4 = <span class=\"keyword\">new</span> <span class=\"title class_\">LazySingleton</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> singleton4;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3</p>\n<p>         if ifif<br>         singleton4 = new LazySingleton()     CPU1231323 singleton4 iffalse singleton4 </p>\n<p>    volatile 123volatile </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> LazySingleton singleton4;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LazySingleton <span class=\"title function_\">lazy2</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (singleton4 == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (LazySingleton.class) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (singleton4 == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                singleton4 = <span class=\"keyword\">new</span> <span class=\"title class_\">LazySingleton</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> singleton4;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> singleton4;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>4</p>\n<p></p>\n<p></p>\n<p>ConcurrentHashMapThreadLocal</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">enum</span> <span class=\"title class_\">Lazy4</span> &#123;</span><br><span class=\"line\">    INSTANCE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Lazy4 <span class=\"title function_\">getInstance</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> INSTANCE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">Lazy4</span> <span class=\"variable\">instance1</span> <span class=\"operator\">=</span> Lazy4.INSTANCE;</span><br><span class=\"line\">        Constructor&lt;Lazy4&gt; declaredConstructor = Lazy4.class.getDeclaredConstructor(String.class, <span class=\"type\">int</span>.class);</span><br><span class=\"line\">        declaredConstructor.setAccessible(<span class=\"literal\">true</span>);</span><br><span class=\"line\">        <span class=\"type\">Lazy4</span> <span class=\"variable\">instance2</span> <span class=\"operator\">=</span> declaredConstructor.newInstance(); </span><br><span class=\"line\">        System.out.println(instance1); System.out.println(instance2);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Queue","date":"2021-06-03T00:33:00.000Z","comments":0,"_content":"\n\t\tQueueCollectionStackVectorCollectionJavaCollectionMap CollectionListSetQueueStack\n\n```java\npublic interface Queue<E> extends Collection<E> {}\n```\n\n### BlockingQueue API\n\n|          |  |  |  |                      |\n| ------------ | -------- | ------------------ | -------- | ---------------------------- |\n|        | add      | offer              | put      | offer(Element,Time,TimeUnit) |\n|        | remove   | poll               | take     | poll(,)                      |\n|  | element  | peek               | -        | -                            |\n\nBlockingQueueArrayBlockingQueueLinkedBlockingQueue\n\nBlockingQueue\n\n|                                   |                                                          |\n| --------------------------------------- | ------------------------------------------------------------ |\n| offer(anObject)                         | anObjectBlockingQueuetruefalse |\n| offer(E o, long timeout, TimeUnit unit) | BlockingQueue |\n| put(anObject)                           | anObjectBlockingQueue,BlockQueue,BlockingQueue |\n| poll(time)                              | BlockingQueue,,time,null |\n| poll(long timeout, TimeUnit unit)       | BlockingQueue |\n| take()                                  | BlockingQueue,BlockingQueue,BlockingQueue; |\n| drainTo()                               | BlockingQueue |\n\nArrayBlockingQueuepoll(long timeout, TimeUnit unit) \n\n```java\npublic E poll(long timeout, TimeUnit unit) throws InterruptedException {\n    // \n    long nanos = unit.toNanos(timeout);\n    final ReentrantLock lock = this.lock;\n    lock.lockInterruptibly();\n    try {\n        // \n        while (count == 0) {\n            if (nanos <= 0)\n                return null;\n            nanos = notEmpty.awaitNanos(nanos);\n        }\n        return dequeue();\n    } finally {\n        lock.unlock();\n    }\n}\n```\n\n****\n\n```java\nBlockingQueue<String> queue = new ArrayBlockingQueue<>(3);\n// \nBlockingQueue<String> syncQueue = new SynchronousQueue<>();\n/**\n * :\n * add()remove()element()\n */\npublic void test1() {\n    // ============== add ============= //\n    queue.add(\"1\");\n    queue.add(\"2\");\n    queue.add(\"3\");\n    // \n    queue.add(\"4\");\n\n    // ============== element ============= //\n    // \n    System.out.println(queue.element());\n\n    // ============== remove ============= //\n    System.out.println(queue.remove());\n    System.out.println(queue.remove());\n    System.out.println(queue.remove());\n    // \n    System.out.println(queue.remove());\n}\n```\n\n```java\n/**\n * \n * offer()poll()peek()\n */\npublic void test2() {\n    // ============== offer ============= //\n    queue.offer(\"1\");\n    queue.offer(\"2\");\n    queue.offer(\"3\");\n    // \n    System.out.println(queue.offer(\"4\"));\n\n    // ============== poll ============= //\n    // \n    System.out.println(queue.peek());\n\n    // ============== peek ============= //\n    queue.poll();\n    queue.poll();\n    queue.poll();\n    System.out.println(queue.size());\n    // \n    System.out.println(queue.poll());\n}\n```\n\n```java\n/**\n * \n * puttake\n */\npublic void test3() throws InterruptedException {\n    // ============== put ============= //\n    queue.put(\"1\");\n    queue.put(\"2\");\n    queue.put(\"3\");\n    // \n    queue.put(\"4\");\n\n    // ============== take ============= //\n    queue.take();\n    queue.take();\n    queue.take();\n    System.out.println(queue.size());\n    // \n    queue.take();\n}\n```\n\n```java\n/**\n * \n * offerpoll\n */\npublic void test4() throws InterruptedException {\n    queue.offer(\"1\");\n    queue.offer(\"2\");\n    queue.offer(\"3\");\n    // 2s\n    System.out.println(queue.offer(\"4\", 2, TimeUnit.SECONDS));\n\n    queue.poll();\n    queue.poll();\n    queue.poll();\n    System.out.println(queue.size());\n    // 2s\n    System.out.println(queue.poll(2, TimeUnit.SECONDS));\n}\n```\n\n### SynchronousQueue\n\n\n\n```java\n/**\n * \n * \n */\npublic void test5() {\n    new Thread(() -> {\n        try {\n            System.out.println(Thread.currentThread().getName() + \" put 1\");\n            syncQueue.put(\"1\");\n            System.out.println(Thread.currentThread().getName() + \" put 2\");\n            syncQueue.put(\"2\");\n            System.out.println(Thread.currentThread().getName() + \" put 3\");\n            syncQueue.put(\"3\");\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }, \"A\").start();\n\t\n    new Thread(() -> {\n        try {\n            // 1\n            TimeUnit.SECONDS.sleep(2);\n            System.out.println(Thread.currentThread().getName() + \"=>\" + syncQueue.take());\n            TimeUnit.SECONDS.sleep(2);\n            System.out.println(Thread.currentThread().getName() + \"=>\" + syncQueue.take());\n            TimeUnit.SECONDS.sleep(2);\n            System.out.println(Thread.currentThread().getName() + \"=>\" + syncQueue.take());\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }, \"B\").start();\n}\n```\n\n### PriorityQueue \n\nPriorityQueue Integer.MAX_VALUE\n\nOutOfMemoryError\n\ntaketake\n\nPriorityQueue\n\n```java\npublic class PriorityQueueDemo {\n    public static void main(String[] args) {\n        // \n        PriorityQueue<String> priorityQueue = new PriorityQueue<>(new Comparator<String>() {\n            @Override\n            public int compare(String o1, String o2) {\n                return 0;\n            }\n        });\n        priorityQueue.add(\"c\");\n        priorityQueue.add(\"a\");\n        priorityQueue.add(\"b\");\n\n        System.out.println(priorityQueue.poll());\n        System.out.println(priorityQueue.poll());\n        System.out.println(priorityQueue.poll());\n\n\t\t// MessageObject\n        PriorityQueue<MessageObject> MessageObjectQueue = new PriorityQueue<>(new Comparator<MessageObject>() {\n            @Override\n            public int compare(MessageObject o1, MessageObject o2) {\n                // OrderMessageObject\n                return o1.order > o2.order ? -1 : 1;\n            }\n        });\n    }\n\n    static class MessageObject {\n        String content;\n        int order;\n    }\n}\n```\n\n\n\n```java\npublic class DelayQueue<E extends Delayed> extends AbstractQueue<E>\n    implements BlockingQueue<E> {\n    // PriorityQueue\n    private final PriorityQueue<E> q = new PriorityQueue<E>();\n    ...\n}\n```\n\nDelayQueueDelayed\n\n```java\npublic interface Delayed extends Comparable<Delayed> {\n    /**\n     * Returns the remaining delay associated with this object, in the\n     * given time unit.\n     * \n     \n     * @param unit the time unit\n     * @return the remaining delay; zero or negative values indicate\n     * that the delay has already elapsed\n     */\n    long getDelay(TimeUnit unit);\n}\n```\n\n****\n\n\n\n```java\npublic class DelayQueueDemo {\n    public static void main(String[] args) throws InterruptedException {\n        DelayQueue<Message> delayQueue = new DelayQueue<Message>();\n        // 5\n        Message message = new Message(\"message - 00001\", new Date(System.currentTimeMillis() + 5000L));\n        delayQueue.add(message);\n\n        while (true) {\n            System.out.println(delayQueue.poll());\n            Thread.sleep(1000L);\n        }\n    }\n\n    // DelayedDelayQueue\n    static class Message implements Delayed {\n        String content;\n        Date sendTime;\n\n        /**\n         * @param content  \n         * @param sendTime \n         */\n        public Message(String content, Date sendTime) {\n            this.content = content;\n            this.sendTime = sendTime;\n        }\n\n        /**\n         * \n         */\n        @Override\n        public long getDelay(TimeUnit unit) {\n            long duration = sendTime.getTime() - System.currentTimeMillis();\n            return TimeUnit.NANOSECONDS.convert(duration, TimeUnit.MILLISECONDS);\n        }\n\n        @Override\n        public int compareTo(Delayed o) {\n            return o.getDelay(TimeUnit.NANOSECONDS) > this.getDelay(TimeUnit.NANOSECONDS) ? 1 : -1;\n        }\n    }\n}\n```\n\n","source":"_posts/Java - Queue.md","raw":"---\ntitle: Queue\ndate: 2021-06-03 8:33:00\ntags:\n  - JUC\ncomments: false\n---\n\n\t\tQueueCollectionStackVectorCollectionJavaCollectionMap CollectionListSetQueueStack\n\n```java\npublic interface Queue<E> extends Collection<E> {}\n```\n\n### BlockingQueue API\n\n|          |  |  |  |                      |\n| ------------ | -------- | ------------------ | -------- | ---------------------------- |\n|        | add      | offer              | put      | offer(Element,Time,TimeUnit) |\n|        | remove   | poll               | take     | poll(,)                      |\n|  | element  | peek               | -        | -                            |\n\nBlockingQueueArrayBlockingQueueLinkedBlockingQueue\n\nBlockingQueue\n\n|                                   |                                                          |\n| --------------------------------------- | ------------------------------------------------------------ |\n| offer(anObject)                         | anObjectBlockingQueuetruefalse |\n| offer(E o, long timeout, TimeUnit unit) | BlockingQueue |\n| put(anObject)                           | anObjectBlockingQueue,BlockQueue,BlockingQueue |\n| poll(time)                              | BlockingQueue,,time,null |\n| poll(long timeout, TimeUnit unit)       | BlockingQueue |\n| take()                                  | BlockingQueue,BlockingQueue,BlockingQueue; |\n| drainTo()                               | BlockingQueue |\n\nArrayBlockingQueuepoll(long timeout, TimeUnit unit) \n\n```java\npublic E poll(long timeout, TimeUnit unit) throws InterruptedException {\n    // \n    long nanos = unit.toNanos(timeout);\n    final ReentrantLock lock = this.lock;\n    lock.lockInterruptibly();\n    try {\n        // \n        while (count == 0) {\n            if (nanos <= 0)\n                return null;\n            nanos = notEmpty.awaitNanos(nanos);\n        }\n        return dequeue();\n    } finally {\n        lock.unlock();\n    }\n}\n```\n\n****\n\n```java\nBlockingQueue<String> queue = new ArrayBlockingQueue<>(3);\n// \nBlockingQueue<String> syncQueue = new SynchronousQueue<>();\n/**\n * :\n * add()remove()element()\n */\npublic void test1() {\n    // ============== add ============= //\n    queue.add(\"1\");\n    queue.add(\"2\");\n    queue.add(\"3\");\n    // \n    queue.add(\"4\");\n\n    // ============== element ============= //\n    // \n    System.out.println(queue.element());\n\n    // ============== remove ============= //\n    System.out.println(queue.remove());\n    System.out.println(queue.remove());\n    System.out.println(queue.remove());\n    // \n    System.out.println(queue.remove());\n}\n```\n\n```java\n/**\n * \n * offer()poll()peek()\n */\npublic void test2() {\n    // ============== offer ============= //\n    queue.offer(\"1\");\n    queue.offer(\"2\");\n    queue.offer(\"3\");\n    // \n    System.out.println(queue.offer(\"4\"));\n\n    // ============== poll ============= //\n    // \n    System.out.println(queue.peek());\n\n    // ============== peek ============= //\n    queue.poll();\n    queue.poll();\n    queue.poll();\n    System.out.println(queue.size());\n    // \n    System.out.println(queue.poll());\n}\n```\n\n```java\n/**\n * \n * puttake\n */\npublic void test3() throws InterruptedException {\n    // ============== put ============= //\n    queue.put(\"1\");\n    queue.put(\"2\");\n    queue.put(\"3\");\n    // \n    queue.put(\"4\");\n\n    // ============== take ============= //\n    queue.take();\n    queue.take();\n    queue.take();\n    System.out.println(queue.size());\n    // \n    queue.take();\n}\n```\n\n```java\n/**\n * \n * offerpoll\n */\npublic void test4() throws InterruptedException {\n    queue.offer(\"1\");\n    queue.offer(\"2\");\n    queue.offer(\"3\");\n    // 2s\n    System.out.println(queue.offer(\"4\", 2, TimeUnit.SECONDS));\n\n    queue.poll();\n    queue.poll();\n    queue.poll();\n    System.out.println(queue.size());\n    // 2s\n    System.out.println(queue.poll(2, TimeUnit.SECONDS));\n}\n```\n\n### SynchronousQueue\n\n\n\n```java\n/**\n * \n * \n */\npublic void test5() {\n    new Thread(() -> {\n        try {\n            System.out.println(Thread.currentThread().getName() + \" put 1\");\n            syncQueue.put(\"1\");\n            System.out.println(Thread.currentThread().getName() + \" put 2\");\n            syncQueue.put(\"2\");\n            System.out.println(Thread.currentThread().getName() + \" put 3\");\n            syncQueue.put(\"3\");\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }, \"A\").start();\n\t\n    new Thread(() -> {\n        try {\n            // 1\n            TimeUnit.SECONDS.sleep(2);\n            System.out.println(Thread.currentThread().getName() + \"=>\" + syncQueue.take());\n            TimeUnit.SECONDS.sleep(2);\n            System.out.println(Thread.currentThread().getName() + \"=>\" + syncQueue.take());\n            TimeUnit.SECONDS.sleep(2);\n            System.out.println(Thread.currentThread().getName() + \"=>\" + syncQueue.take());\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }, \"B\").start();\n}\n```\n\n### PriorityQueue \n\nPriorityQueue Integer.MAX_VALUE\n\nOutOfMemoryError\n\ntaketake\n\nPriorityQueue\n\n```java\npublic class PriorityQueueDemo {\n    public static void main(String[] args) {\n        // \n        PriorityQueue<String> priorityQueue = new PriorityQueue<>(new Comparator<String>() {\n            @Override\n            public int compare(String o1, String o2) {\n                return 0;\n            }\n        });\n        priorityQueue.add(\"c\");\n        priorityQueue.add(\"a\");\n        priorityQueue.add(\"b\");\n\n        System.out.println(priorityQueue.poll());\n        System.out.println(priorityQueue.poll());\n        System.out.println(priorityQueue.poll());\n\n\t\t// MessageObject\n        PriorityQueue<MessageObject> MessageObjectQueue = new PriorityQueue<>(new Comparator<MessageObject>() {\n            @Override\n            public int compare(MessageObject o1, MessageObject o2) {\n                // OrderMessageObject\n                return o1.order > o2.order ? -1 : 1;\n            }\n        });\n    }\n\n    static class MessageObject {\n        String content;\n        int order;\n    }\n}\n```\n\n\n\n```java\npublic class DelayQueue<E extends Delayed> extends AbstractQueue<E>\n    implements BlockingQueue<E> {\n    // PriorityQueue\n    private final PriorityQueue<E> q = new PriorityQueue<E>();\n    ...\n}\n```\n\nDelayQueueDelayed\n\n```java\npublic interface Delayed extends Comparable<Delayed> {\n    /**\n     * Returns the remaining delay associated with this object, in the\n     * given time unit.\n     * \n     \n     * @param unit the time unit\n     * @return the remaining delay; zero or negative values indicate\n     * that the delay has already elapsed\n     */\n    long getDelay(TimeUnit unit);\n}\n```\n\n****\n\n\n\n```java\npublic class DelayQueueDemo {\n    public static void main(String[] args) throws InterruptedException {\n        DelayQueue<Message> delayQueue = new DelayQueue<Message>();\n        // 5\n        Message message = new Message(\"message - 00001\", new Date(System.currentTimeMillis() + 5000L));\n        delayQueue.add(message);\n\n        while (true) {\n            System.out.println(delayQueue.poll());\n            Thread.sleep(1000L);\n        }\n    }\n\n    // DelayedDelayQueue\n    static class Message implements Delayed {\n        String content;\n        Date sendTime;\n\n        /**\n         * @param content  \n         * @param sendTime \n         */\n        public Message(String content, Date sendTime) {\n            this.content = content;\n            this.sendTime = sendTime;\n        }\n\n        /**\n         * \n         */\n        @Override\n        public long getDelay(TimeUnit unit) {\n            long duration = sendTime.getTime() - System.currentTimeMillis();\n            return TimeUnit.NANOSECONDS.convert(duration, TimeUnit.MILLISECONDS);\n        }\n\n        @Override\n        public int compareTo(Delayed o) {\n            return o.getDelay(TimeUnit.NANOSECONDS) > this.getDelay(TimeUnit.NANOSECONDS) ? 1 : -1;\n        }\n    }\n}\n```\n\n","slug":"Java - Queue","published":1,"updated":"2022-02-28T10:50:19.795Z","_id":"cl06jmpkp0014qwu5fppdc0t1","layout":"post","photos":[],"link":"","content":"<p>        QueueCollectionStackVectorCollectionJavaCollectionMap CollectionListSetQueueStack</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">Queue</span>&lt;E&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">Collection</span>&lt;E&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"BlockingQueue-API\"><a href=\"#BlockingQueue-API\" class=\"headerlink\" title=\"BlockingQueue API\"></a>BlockingQueue API</h3><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td>add</td>\n<td>offer</td>\n<td>put</td>\n<td>offer(Element,Time,TimeUnit)</td>\n</tr>\n<tr>\n<td></td>\n<td>remove</td>\n<td>poll</td>\n<td>take</td>\n<td>poll(,)</td>\n</tr>\n<tr>\n<td></td>\n<td>element</td>\n<td>peek</td>\n<td>-</td>\n<td>-</td>\n</tr>\n</tbody></table>\n<p>BlockingQueueArrayBlockingQueueLinkedBlockingQueue</p>\n<p>BlockingQueue</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>offer(anObject)</td>\n<td>anObjectBlockingQueuetruefalse</td>\n</tr>\n<tr>\n<td>offer(E o, long timeout, TimeUnit unit)</td>\n<td>BlockingQueue</td>\n</tr>\n<tr>\n<td>put(anObject)</td>\n<td>anObjectBlockingQueue,BlockQueue,BlockingQueue</td>\n</tr>\n<tr>\n<td>poll(time)</td>\n<td>BlockingQueue,,time,null</td>\n</tr>\n<tr>\n<td>poll(long timeout, TimeUnit unit)</td>\n<td>BlockingQueue</td>\n</tr>\n<tr>\n<td>take()</td>\n<td>BlockingQueue,BlockingQueue,BlockingQueue;</td>\n</tr>\n<tr>\n<td>drainTo()</td>\n<td>BlockingQueue</td>\n</tr>\n</tbody></table>\n<p>ArrayBlockingQueuepoll(long timeout, TimeUnit unit) </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> E <span class=\"title function_\">poll</span><span class=\"params\">(<span class=\"type\">long</span> timeout, TimeUnit unit)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">nanos</span> <span class=\"operator\">=</span> unit.toNanos(timeout);</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"type\">ReentrantLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.lock;</span><br><span class=\"line\">    lock.lockInterruptibly();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (count == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nanos &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">            nanos = notEmpty.awaitNanos(nanos);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dequeue();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        lock.unlock();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BlockingQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayBlockingQueue</span>&lt;&gt;(<span class=\"number\">3</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">BlockingQueue&lt;String&gt; syncQueue = <span class=\"keyword\">new</span> <span class=\"title class_\">SynchronousQueue</span>&lt;&gt;();</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * :</span></span><br><span class=\"line\"><span class=\"comment\"> * add()remove()element()</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ============== add ============= //</span></span><br><span class=\"line\">    queue.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    queue.add(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    queue.add(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    queue.add(<span class=\"string\">&quot;4&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== element ============= //</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.element());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== remove ============= //</span></span><br><span class=\"line\">    System.out.println(queue.remove());</span><br><span class=\"line\">    System.out.println(queue.remove());</span><br><span class=\"line\">    System.out.println(queue.remove());</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.remove());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * offer()poll()peek()</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ============== offer ============= //</span></span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.offer(<span class=\"string\">&quot;4&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== poll ============= //</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.peek());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== peek ============= //</span></span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    System.out.println(queue.size());</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.poll());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * puttake</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test3</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ============== put ============= //</span></span><br><span class=\"line\">    queue.put(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    queue.put(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    queue.put(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    queue.put(<span class=\"string\">&quot;4&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== take ============= //</span></span><br><span class=\"line\">    queue.take();</span><br><span class=\"line\">    queue.take();</span><br><span class=\"line\">    queue.take();</span><br><span class=\"line\">    System.out.println(queue.size());</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    queue.take();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * offerpoll</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test4</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 2s</span></span><br><span class=\"line\">    System.out.println(queue.offer(<span class=\"string\">&quot;4&quot;</span>, <span class=\"number\">2</span>, TimeUnit.SECONDS));</span><br><span class=\"line\"></span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    System.out.println(queue.size());</span><br><span class=\"line\">    <span class=\"comment\">// 2s</span></span><br><span class=\"line\">    System.out.println(queue.poll(<span class=\"number\">2</span>, TimeUnit.SECONDS));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SynchronousQueue\"><a href=\"#SynchronousQueue\" class=\"headerlink\" title=\"SynchronousQueue\"></a>SynchronousQueue</h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test5</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; put 1&quot;</span>);</span><br><span class=\"line\">            syncQueue.put(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; put 2&quot;</span>);</span><br><span class=\"line\">            syncQueue.put(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; put 3&quot;</span>);</span><br><span class=\"line\">            syncQueue.put(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;A&quot;</span>).start();</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 1</span></span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;=&gt;&quot;</span> + syncQueue.take());</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;=&gt;&quot;</span> + syncQueue.take());</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;=&gt;&quot;</span> + syncQueue.take());</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;B&quot;</span>).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"PriorityQueue-\"><a href=\"#PriorityQueue-\" class=\"headerlink\" title=\"PriorityQueue \"></a>PriorityQueue </h3><p>PriorityQueue Integer.MAX_VALUE</p>\n<p>OutOfMemoryError</p>\n<p>taketake</p>\n<p>PriorityQueue</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PriorityQueueDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        PriorityQueue&lt;String&gt; priorityQueue = <span class=\"keyword\">new</span> <span class=\"title class_\">PriorityQueue</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">Comparator</span>&lt;String&gt;() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">compare</span><span class=\"params\">(String o1, String o2)</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        priorityQueue.add(<span class=\"string\">&quot;c&quot;</span>);</span><br><span class=\"line\">        priorityQueue.add(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\">        priorityQueue.add(<span class=\"string\">&quot;b&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(priorityQueue.poll());</span><br><span class=\"line\">        System.out.println(priorityQueue.poll());</span><br><span class=\"line\">        System.out.println(priorityQueue.poll());</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// MessageObject</span></span><br><span class=\"line\">        PriorityQueue&lt;MessageObject&gt; MessageObjectQueue = <span class=\"keyword\">new</span> <span class=\"title class_\">PriorityQueue</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">Comparator</span>&lt;MessageObject&gt;() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">compare</span><span class=\"params\">(MessageObject o1, MessageObject o2)</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// OrderMessageObject</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> o1.order &gt; o2.order ? -<span class=\"number\">1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MessageObject</span> &#123;</span><br><span class=\"line\">        String content;</span><br><span class=\"line\">        <span class=\"type\">int</span> order;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DelayQueue</span>&lt;E <span class=\"keyword\">extends</span> <span class=\"title class_\">Delayed</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">AbstractQueue</span>&lt;E&gt;</span><br><span class=\"line\">    <span class=\"keyword\">implements</span> <span class=\"title class_\">BlockingQueue</span>&lt;E&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">// PriorityQueue</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> PriorityQueue&lt;E&gt; q = <span class=\"keyword\">new</span> <span class=\"title class_\">PriorityQueue</span>&lt;E&gt;();</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>DelayQueueDelayed</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">Delayed</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Comparable</span>&lt;Delayed&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Returns the remaining delay associated with this object, in the</span></span><br><span class=\"line\"><span class=\"comment\">     * given time unit.</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> unit the time unit</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> the remaining delay; zero or negative values indicate</span></span><br><span class=\"line\"><span class=\"comment\">     * that the delay has already elapsed</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"title function_\">getDelay</span><span class=\"params\">(TimeUnit unit)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DelayQueueDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        DelayQueue&lt;Message&gt; delayQueue = <span class=\"keyword\">new</span> <span class=\"title class_\">DelayQueue</span>&lt;Message&gt;();</span><br><span class=\"line\">        <span class=\"comment\">// 5</span></span><br><span class=\"line\">        <span class=\"type\">Message</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Message</span>(<span class=\"string\">&quot;message - 00001&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(System.currentTimeMillis() + <span class=\"number\">5000L</span>));</span><br><span class=\"line\">        delayQueue.add(message);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">            System.out.println(delayQueue.poll());</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000L</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// DelayedDelayQueue</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Message</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Delayed</span> &#123;</span><br><span class=\"line\">        String content;</span><br><span class=\"line\">        Date sendTime;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@param</span> content  </span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@param</span> sendTime </span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"title function_\">Message</span><span class=\"params\">(String content, Date sendTime)</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.content = content;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.sendTime = sendTime;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * </span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"type\">long</span> <span class=\"title function_\">getDelay</span><span class=\"params\">(TimeUnit unit)</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">long</span> <span class=\"variable\">duration</span> <span class=\"operator\">=</span> sendTime.getTime() - System.currentTimeMillis();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> TimeUnit.NANOSECONDS.convert(duration, TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">compareTo</span><span class=\"params\">(Delayed o)</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> o.getDelay(TimeUnit.NANOSECONDS) &gt; <span class=\"built_in\">this</span>.getDelay(TimeUnit.NANOSECONDS) ? <span class=\"number\">1</span> : -<span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<p>        QueueCollectionStackVectorCollectionJavaCollectionMap CollectionListSetQueueStack</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">Queue</span>&lt;E&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">Collection</span>&lt;E&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"BlockingQueue-API\"><a href=\"#BlockingQueue-API\" class=\"headerlink\" title=\"BlockingQueue API\"></a>BlockingQueue API</h3><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td>add</td>\n<td>offer</td>\n<td>put</td>\n<td>offer(Element,Time,TimeUnit)</td>\n</tr>\n<tr>\n<td></td>\n<td>remove</td>\n<td>poll</td>\n<td>take</td>\n<td>poll(,)</td>\n</tr>\n<tr>\n<td></td>\n<td>element</td>\n<td>peek</td>\n<td>-</td>\n<td>-</td>\n</tr>\n</tbody></table>\n<p>BlockingQueueArrayBlockingQueueLinkedBlockingQueue</p>\n<p>BlockingQueue</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>offer(anObject)</td>\n<td>anObjectBlockingQueuetruefalse</td>\n</tr>\n<tr>\n<td>offer(E o, long timeout, TimeUnit unit)</td>\n<td>BlockingQueue</td>\n</tr>\n<tr>\n<td>put(anObject)</td>\n<td>anObjectBlockingQueue,BlockQueue,BlockingQueue</td>\n</tr>\n<tr>\n<td>poll(time)</td>\n<td>BlockingQueue,,time,null</td>\n</tr>\n<tr>\n<td>poll(long timeout, TimeUnit unit)</td>\n<td>BlockingQueue</td>\n</tr>\n<tr>\n<td>take()</td>\n<td>BlockingQueue,BlockingQueue,BlockingQueue;</td>\n</tr>\n<tr>\n<td>drainTo()</td>\n<td>BlockingQueue</td>\n</tr>\n</tbody></table>\n<p>ArrayBlockingQueuepoll(long timeout, TimeUnit unit) </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> E <span class=\"title function_\">poll</span><span class=\"params\">(<span class=\"type\">long</span> timeout, TimeUnit unit)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"variable\">nanos</span> <span class=\"operator\">=</span> unit.toNanos(timeout);</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"type\">ReentrantLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.lock;</span><br><span class=\"line\">    lock.lockInterruptibly();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (count == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nanos &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">            nanos = notEmpty.awaitNanos(nanos);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dequeue();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        lock.unlock();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BlockingQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayBlockingQueue</span>&lt;&gt;(<span class=\"number\">3</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">BlockingQueue&lt;String&gt; syncQueue = <span class=\"keyword\">new</span> <span class=\"title class_\">SynchronousQueue</span>&lt;&gt;();</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * :</span></span><br><span class=\"line\"><span class=\"comment\"> * add()remove()element()</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ============== add ============= //</span></span><br><span class=\"line\">    queue.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    queue.add(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    queue.add(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    queue.add(<span class=\"string\">&quot;4&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== element ============= //</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.element());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== remove ============= //</span></span><br><span class=\"line\">    System.out.println(queue.remove());</span><br><span class=\"line\">    System.out.println(queue.remove());</span><br><span class=\"line\">    System.out.println(queue.remove());</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.remove());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * offer()poll()peek()</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ============== offer ============= //</span></span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.offer(<span class=\"string\">&quot;4&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== poll ============= //</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.peek());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== peek ============= //</span></span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    System.out.println(queue.size());</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    System.out.println(queue.poll());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * puttake</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test3</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ============== put ============= //</span></span><br><span class=\"line\">    queue.put(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    queue.put(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    queue.put(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    queue.put(<span class=\"string\">&quot;4&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ============== take ============= //</span></span><br><span class=\"line\">    queue.take();</span><br><span class=\"line\">    queue.take();</span><br><span class=\"line\">    queue.take();</span><br><span class=\"line\">    System.out.println(queue.size());</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    queue.take();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * offerpoll</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test4</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    queue.offer(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 2s</span></span><br><span class=\"line\">    System.out.println(queue.offer(<span class=\"string\">&quot;4&quot;</span>, <span class=\"number\">2</span>, TimeUnit.SECONDS));</span><br><span class=\"line\"></span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    queue.poll();</span><br><span class=\"line\">    System.out.println(queue.size());</span><br><span class=\"line\">    <span class=\"comment\">// 2s</span></span><br><span class=\"line\">    System.out.println(queue.poll(<span class=\"number\">2</span>, TimeUnit.SECONDS));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SynchronousQueue\"><a href=\"#SynchronousQueue\" class=\"headerlink\" title=\"SynchronousQueue\"></a>SynchronousQueue</h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test5</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; put 1&quot;</span>);</span><br><span class=\"line\">            syncQueue.put(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; put 2&quot;</span>);</span><br><span class=\"line\">            syncQueue.put(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; put 3&quot;</span>);</span><br><span class=\"line\">            syncQueue.put(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;A&quot;</span>).start();</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 1</span></span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;=&gt;&quot;</span> + syncQueue.take());</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;=&gt;&quot;</span> + syncQueue.take());</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;=&gt;&quot;</span> + syncQueue.take());</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;B&quot;</span>).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"PriorityQueue-\"><a href=\"#PriorityQueue-\" class=\"headerlink\" title=\"PriorityQueue \"></a>PriorityQueue </h3><p>PriorityQueue Integer.MAX_VALUE</p>\n<p>OutOfMemoryError</p>\n<p>taketake</p>\n<p>PriorityQueue</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PriorityQueueDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        PriorityQueue&lt;String&gt; priorityQueue = <span class=\"keyword\">new</span> <span class=\"title class_\">PriorityQueue</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">Comparator</span>&lt;String&gt;() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">compare</span><span class=\"params\">(String o1, String o2)</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        priorityQueue.add(<span class=\"string\">&quot;c&quot;</span>);</span><br><span class=\"line\">        priorityQueue.add(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\">        priorityQueue.add(<span class=\"string\">&quot;b&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(priorityQueue.poll());</span><br><span class=\"line\">        System.out.println(priorityQueue.poll());</span><br><span class=\"line\">        System.out.println(priorityQueue.poll());</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// MessageObject</span></span><br><span class=\"line\">        PriorityQueue&lt;MessageObject&gt; MessageObjectQueue = <span class=\"keyword\">new</span> <span class=\"title class_\">PriorityQueue</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">Comparator</span>&lt;MessageObject&gt;() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">compare</span><span class=\"params\">(MessageObject o1, MessageObject o2)</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// OrderMessageObject</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> o1.order &gt; o2.order ? -<span class=\"number\">1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MessageObject</span> &#123;</span><br><span class=\"line\">        String content;</span><br><span class=\"line\">        <span class=\"type\">int</span> order;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DelayQueue</span>&lt;E <span class=\"keyword\">extends</span> <span class=\"title class_\">Delayed</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">AbstractQueue</span>&lt;E&gt;</span><br><span class=\"line\">    <span class=\"keyword\">implements</span> <span class=\"title class_\">BlockingQueue</span>&lt;E&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">// PriorityQueue</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> PriorityQueue&lt;E&gt; q = <span class=\"keyword\">new</span> <span class=\"title class_\">PriorityQueue</span>&lt;E&gt;();</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>DelayQueueDelayed</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">Delayed</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Comparable</span>&lt;Delayed&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Returns the remaining delay associated with this object, in the</span></span><br><span class=\"line\"><span class=\"comment\">     * given time unit.</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> unit the time unit</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> the remaining delay; zero or negative values indicate</span></span><br><span class=\"line\"><span class=\"comment\">     * that the delay has already elapsed</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"title function_\">getDelay</span><span class=\"params\">(TimeUnit unit)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DelayQueueDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        DelayQueue&lt;Message&gt; delayQueue = <span class=\"keyword\">new</span> <span class=\"title class_\">DelayQueue</span>&lt;Message&gt;();</span><br><span class=\"line\">        <span class=\"comment\">// 5</span></span><br><span class=\"line\">        <span class=\"type\">Message</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Message</span>(<span class=\"string\">&quot;message - 00001&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(System.currentTimeMillis() + <span class=\"number\">5000L</span>));</span><br><span class=\"line\">        delayQueue.add(message);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">            System.out.println(delayQueue.poll());</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000L</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// DelayedDelayQueue</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Message</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Delayed</span> &#123;</span><br><span class=\"line\">        String content;</span><br><span class=\"line\">        Date sendTime;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@param</span> content  </span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@param</span> sendTime </span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"title function_\">Message</span><span class=\"params\">(String content, Date sendTime)</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.content = content;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.sendTime = sendTime;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * </span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"type\">long</span> <span class=\"title function_\">getDelay</span><span class=\"params\">(TimeUnit unit)</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">long</span> <span class=\"variable\">duration</span> <span class=\"operator\">=</span> sendTime.getTime() - System.currentTimeMillis();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> TimeUnit.NANOSECONDS.convert(duration, TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">compareTo</span><span class=\"params\">(Delayed o)</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> o.getDelay(TimeUnit.NANOSECONDS) &gt; <span class=\"built_in\">this</span>.getDelay(TimeUnit.NANOSECONDS) ? <span class=\"number\">1</span> : -<span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"ReentrantLockReadWriteLock","date":"2021-04-29T09:19:00.000Z","comments":0,"_content":"\n\n\n```java\npublic interface Lock {\n    void lock();\n    // \n    void lockInterruptibly() throws InterruptedException;\n    // \n    boolean tryLock();\n    boolean tryLock(long time, TimeUnit unit) throws InterruptedException;\n    void unlock();\n    Condition newCondition();\n}\n```\n\n## ReentrantLock\n\n\n\n![image-20210429135322710](.\\images\\Lock - ReetrantLock.png)\n\nnulllock()unlock()10 getHoldCount()\n\n\t\n\n## ReadWriteLockLock\n\n;\n\n\n\n:\n\n```java\n// \npublic class LockDemo2 {\n    ReadWriteLock lock = new ReentrantReadWriteLock();\n\n    public static void main(String[] args) {\n        LockDemo2 lockDemo2 = new LockDemo2();\n\n        for (int i = 0; i < 2; i++) {\n            new Thread(() -> {\n                lockDemo2.read(Thread.currentThread());\n            }, \"A\" + i).start();\n        }\n\n        new Thread(() -> {\n            lockDemo2.write(Thread.currentThread());\n        }, \"C\").start();\n    }\n\n    // \n    public void read(Thread t) {\n        lock.readLock().lock();\n        try {\n            long start = System.currentTimeMillis();\n            while (System.currentTimeMillis() - start <= 1) {\n                System.out.println(t.getName() + \"\");\n            }\n            System.out.println(t.getName() + \"\");\n        } finally {\n            lock.readLock().unlock();\n        }\n    }\n\n    // \n    public void write(Thread t) {\n        lock.writeLock().lock();\n        try {\n            long start = System.currentTimeMillis();\n            while (System.currentTimeMillis() - start <= 1) {\n                System.out.println(t.getName() + \"\");\n            }\n            System.out.println(t.getName() + \"\");\n        } finally {\n            lock.writeLock().unlock();\n        }\n    }\n}\n```\n\n## ReadWriteLock\n\n,\n\n->(~>, )\n\n```java\n/**\n * demo\n * ReentrantReadWriteLock\n *\n * @author DengJun 2021/4/29\n */\npublic class LockDemo3 {\n    // \n    private Map<String, Object> cache = new HashMap<>();\n    // \n    private ReadWriteLock rwl = new ReentrantReadWriteLock();\n\n    public Object getData(String key) {\n        // \n        rwl.readLock().lock();\n        Object value = null;\n        try {\n            value = cache.get(key);\n            // \n            if (value == null) {\n                // \n                rwl.readLock().unlock();\n                rwl.writeLock().lock();\n                try {\n                    // \n                    if (value == null) {\n                        // DB\n                        value = \"XXX\";\n                    }\n                } finally {\n                    // \n                    rwl.writeLock().unlock();\n                }\n                // \n                rwl.readLock().lock();\n            }\n        } finally {\n            // \n            value = cache.get(key);\n            rwl.readLock().unlock();\n        }\n        return value;\n    }\n}\n```\n\n## Condition\n\n![image-20210429171248960](.\\images\\Lock-ReentrantLock-Condition.png)\n\n","source":"_posts/Java - ReetrantLock.md","raw":"---\ntitle: ReentrantLockReadWriteLock\ndate: 2021-04-29 17:19:00\ntags:\n  - JUC\ncomments: false\n---\n\n\n\n```java\npublic interface Lock {\n    void lock();\n    // \n    void lockInterruptibly() throws InterruptedException;\n    // \n    boolean tryLock();\n    boolean tryLock(long time, TimeUnit unit) throws InterruptedException;\n    void unlock();\n    Condition newCondition();\n}\n```\n\n## ReentrantLock\n\n\n\n![image-20210429135322710](.\\images\\Lock - ReetrantLock.png)\n\nnulllock()unlock()10 getHoldCount()\n\n\t\n\n## ReadWriteLockLock\n\n;\n\n\n\n:\n\n```java\n// \npublic class LockDemo2 {\n    ReadWriteLock lock = new ReentrantReadWriteLock();\n\n    public static void main(String[] args) {\n        LockDemo2 lockDemo2 = new LockDemo2();\n\n        for (int i = 0; i < 2; i++) {\n            new Thread(() -> {\n                lockDemo2.read(Thread.currentThread());\n            }, \"A\" + i).start();\n        }\n\n        new Thread(() -> {\n            lockDemo2.write(Thread.currentThread());\n        }, \"C\").start();\n    }\n\n    // \n    public void read(Thread t) {\n        lock.readLock().lock();\n        try {\n            long start = System.currentTimeMillis();\n            while (System.currentTimeMillis() - start <= 1) {\n                System.out.println(t.getName() + \"\");\n            }\n            System.out.println(t.getName() + \"\");\n        } finally {\n            lock.readLock().unlock();\n        }\n    }\n\n    // \n    public void write(Thread t) {\n        lock.writeLock().lock();\n        try {\n            long start = System.currentTimeMillis();\n            while (System.currentTimeMillis() - start <= 1) {\n                System.out.println(t.getName() + \"\");\n            }\n            System.out.println(t.getName() + \"\");\n        } finally {\n            lock.writeLock().unlock();\n        }\n    }\n}\n```\n\n## ReadWriteLock\n\n,\n\n->(~>, )\n\n```java\n/**\n * demo\n * ReentrantReadWriteLock\n *\n * @author DengJun 2021/4/29\n */\npublic class LockDemo3 {\n    // \n    private Map<String, Object> cache = new HashMap<>();\n    // \n    private ReadWriteLock rwl = new ReentrantReadWriteLock();\n\n    public Object getData(String key) {\n        // \n        rwl.readLock().lock();\n        Object value = null;\n        try {\n            value = cache.get(key);\n            // \n            if (value == null) {\n                // \n                rwl.readLock().unlock();\n                rwl.writeLock().lock();\n                try {\n                    // \n                    if (value == null) {\n                        // DB\n                        value = \"XXX\";\n                    }\n                } finally {\n                    // \n                    rwl.writeLock().unlock();\n                }\n                // \n                rwl.readLock().lock();\n            }\n        } finally {\n            // \n            value = cache.get(key);\n            rwl.readLock().unlock();\n        }\n        return value;\n    }\n}\n```\n\n## Condition\n\n![image-20210429171248960](.\\images\\Lock-ReentrantLock-Condition.png)\n\n","slug":"Java - ReetrantLock","published":1,"updated":"2022-02-28T10:54:19.446Z","_id":"cl06jpgrh0016qwu5awypgklt","layout":"post","photos":[],"link":"","content":"<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">Lock</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">lock</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">lockInterruptibly</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"title function_\">tryLock</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"title function_\">tryLock</span><span class=\"params\">(<span class=\"type\">long</span> time, TimeUnit unit)</span> <span class=\"keyword\">throws</span> InterruptedException;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">unlock</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    Condition <span class=\"title function_\">newCondition</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ReentrantLock\"><a href=\"#ReentrantLock\" class=\"headerlink\" title=\"ReentrantLock\"></a>ReentrantLock</h2><p></p>\n<p>![image-20210429135322710](.\\images\\Lock - ReetrantLock.png)</p>\n<p>nulllock()unlock()10 getHoldCount()</p>\n<p>    </p>\n<h2 id=\"ReadWriteLockLock\"><a href=\"#ReadWriteLockLock\" class=\"headerlink\" title=\"ReadWriteLockLock\"></a>ReadWriteLockLock</h2><p>;</p>\n<p></p>\n<p>:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LockDemo2</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">ReadWriteLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantReadWriteLock</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">LockDemo2</span> <span class=\"variable\">lockDemo2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">LockDemo2</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                lockDemo2.read(Thread.currentThread());</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;A&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            lockDemo2.write(Thread.currentThread());</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;C&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">read</span><span class=\"params\">(Thread t)</span> &#123;</span><br><span class=\"line\">        lock.readLock().lock();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (System.currentTimeMillis() - start &lt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                System.out.println(t.getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(t.getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.readLock().unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">write</span><span class=\"params\">(Thread t)</span> &#123;</span><br><span class=\"line\">        lock.writeLock().lock();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (System.currentTimeMillis() - start &lt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                System.out.println(t.getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(t.getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.writeLock().unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ReadWriteLock\"><a href=\"#ReadWriteLock\" class=\"headerlink\" title=\"ReadWriteLock\"></a>ReadWriteLock</h2><p>,</p>\n<p>-&gt;(~&gt;, )</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * demo</span></span><br><span class=\"line\"><span class=\"comment\"> * ReentrantReadWriteLock</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> DengJun 2021/4/29</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LockDemo3</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;String, Object&gt; cache = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">ReadWriteLock</span> <span class=\"variable\">rwl</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantReadWriteLock</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Object <span class=\"title function_\">getData</span><span class=\"params\">(String key)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        rwl.readLock().lock();</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            value = cache.get(key);</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (value == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                rwl.readLock().unlock();</span><br><span class=\"line\">                rwl.writeLock().lock();</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (value == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// DB</span></span><br><span class=\"line\">                        value = <span class=\"string\">&quot;XXX&quot;</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    rwl.writeLock().unlock();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                rwl.readLock().lock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            value = cache.get(key);</span><br><span class=\"line\">            rwl.readLock().unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Condition\"><a href=\"#Condition\" class=\"headerlink\" title=\"Condition\"></a>Condition</h2><p><img src=\".%5Cimages%5CLock-ReentrantLock-Condition%E5%8E%9F%E7%90%86.png\" alt=\"image-20210429171248960\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">Lock</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">lock</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">lockInterruptibly</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"title function_\">tryLock</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"title function_\">tryLock</span><span class=\"params\">(<span class=\"type\">long</span> time, TimeUnit unit)</span> <span class=\"keyword\">throws</span> InterruptedException;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">unlock</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    Condition <span class=\"title function_\">newCondition</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ReentrantLock\"><a href=\"#ReentrantLock\" class=\"headerlink\" title=\"ReentrantLock\"></a>ReentrantLock</h2><p></p>\n<p>![image-20210429135322710](.\\images\\Lock - ReetrantLock.png)</p>\n<p>nulllock()unlock()10 getHoldCount()</p>\n<p>    </p>\n<h2 id=\"ReadWriteLockLock\"><a href=\"#ReadWriteLockLock\" class=\"headerlink\" title=\"ReadWriteLockLock\"></a>ReadWriteLockLock</h2><p>;</p>\n<p></p>\n<p>:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LockDemo2</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">ReadWriteLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantReadWriteLock</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">LockDemo2</span> <span class=\"variable\">lockDemo2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">LockDemo2</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                lockDemo2.read(Thread.currentThread());</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;A&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            lockDemo2.write(Thread.currentThread());</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;C&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">read</span><span class=\"params\">(Thread t)</span> &#123;</span><br><span class=\"line\">        lock.readLock().lock();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (System.currentTimeMillis() - start &lt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                System.out.println(t.getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(t.getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.readLock().unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">write</span><span class=\"params\">(Thread t)</span> &#123;</span><br><span class=\"line\">        lock.writeLock().lock();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (System.currentTimeMillis() - start &lt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                System.out.println(t.getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(t.getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.writeLock().unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ReadWriteLock\"><a href=\"#ReadWriteLock\" class=\"headerlink\" title=\"ReadWriteLock\"></a>ReadWriteLock</h2><p>,</p>\n<p>-&gt;(~&gt;, )</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * demo</span></span><br><span class=\"line\"><span class=\"comment\"> * ReentrantReadWriteLock</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> DengJun 2021/4/29</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LockDemo3</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;String, Object&gt; cache = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">ReadWriteLock</span> <span class=\"variable\">rwl</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantReadWriteLock</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Object <span class=\"title function_\">getData</span><span class=\"params\">(String key)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        rwl.readLock().lock();</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            value = cache.get(key);</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (value == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                rwl.readLock().unlock();</span><br><span class=\"line\">                rwl.writeLock().lock();</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (value == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// DB</span></span><br><span class=\"line\">                        value = <span class=\"string\">&quot;XXX&quot;</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    rwl.writeLock().unlock();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                rwl.readLock().lock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            value = cache.get(key);</span><br><span class=\"line\">            rwl.readLock().unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Condition\"><a href=\"#Condition\" class=\"headerlink\" title=\"Condition\"></a>Condition</h2><p><img src=\".%5Cimages%5CLock-ReentrantLock-Condition%E5%8E%9F%E7%90%86.png\" alt=\"image-20210429171248960\"></p>\n"},{"title":" Semaphore","date":"2021-05-14T09:18:00.000Z","comments":0,"description":"Hystrix","_content":"\n# Java -  Semaphore\n\nHystrix\n\n\n\nJava Semaphore acquirereleaseavailablePermits() \n\nacquirerelease\n\n## \n\n```java\npublic void testSemaphore() {\n    // 33\n    Semaphore semaphore = new Semaphore(3);\n\n    for (int i = 0; i < 6; i++) {\n        new Thread(() -> {\n            try {\n                semaphore.acquire();\n                System.out.println(Thread.currentThread().getName() + \"\");\n                TimeUnit.SECONDS.sleep(2);\n                System.out.println(Thread.currentThread().getName() + \"\");\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            } finally {\n                semaphore.release();\n            }\n\n        }, \"\" + i).start();\n    }\n}\n```\n\n\n\n```\n0\n1\n2\n1\n2\n0\n4\n3\n5\n3\n5\n4\n```\n\n## \n\nSemaphoreAQS\n\n```java\npublic class Semaphore implements java.io.Serializable {\n     private final Sync sync;\n     abstract static class Sync extends AbstractQueuedSynchronizer {...}\n    ...\n}\n```\n\nSemaphore\n\n```java\npublic final void acquireSharedInterruptibly(int arg)\n    throws InterruptedException {\n    if (Thread.interrupted())\n        throw new InterruptedException();\n    // \n    if (tryAcquireShared(arg) < 0)\n        doAcquireSharedInterruptibly(arg);\n}\n```\n\n","source":"_posts/Java - Semaphore.md","raw":"---\ntitle:  Semaphore\ndate: 2021-05-14 17:18:00\ntags:\n  - JUC\ncomments: false\ndescription: Hystrix\n---\n\n# Java -  Semaphore\n\nHystrix\n\n\n\nJava Semaphore acquirereleaseavailablePermits() \n\nacquirerelease\n\n## \n\n```java\npublic void testSemaphore() {\n    // 33\n    Semaphore semaphore = new Semaphore(3);\n\n    for (int i = 0; i < 6; i++) {\n        new Thread(() -> {\n            try {\n                semaphore.acquire();\n                System.out.println(Thread.currentThread().getName() + \"\");\n                TimeUnit.SECONDS.sleep(2);\n                System.out.println(Thread.currentThread().getName() + \"\");\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            } finally {\n                semaphore.release();\n            }\n\n        }, \"\" + i).start();\n    }\n}\n```\n\n\n\n```\n0\n1\n2\n1\n2\n0\n4\n3\n5\n3\n5\n4\n```\n\n## \n\nSemaphoreAQS\n\n```java\npublic class Semaphore implements java.io.Serializable {\n     private final Sync sync;\n     abstract static class Sync extends AbstractQueuedSynchronizer {...}\n    ...\n}\n```\n\nSemaphore\n\n```java\npublic final void acquireSharedInterruptibly(int arg)\n    throws InterruptedException {\n    if (Thread.interrupted())\n        throw new InterruptedException();\n    // \n    if (tryAcquireShared(arg) < 0)\n        doAcquireSharedInterruptibly(arg);\n}\n```\n\n","slug":"Java - Semaphore","published":1,"updated":"2022-02-28T10:56:41.123Z","_id":"cl06jr0ky0018qwu5bgr4f7yb","layout":"post","photos":[],"link":"","content":"<h1 id=\"Java--Semaphore\"><a href=\"#Java--Semaphore\" class=\"headerlink\" title=\"Java -  Semaphore\"></a>Java -  Semaphore</h1><p>Hystrix</p>\n<p></p>\n<p>Java Semaphore acquirereleaseavailablePermits() </p>\n<p>acquirerelease</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testSemaphore</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 33</span></span><br><span class=\"line\">    <span class=\"type\">Semaphore</span> <span class=\"variable\">semaphore</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Semaphore</span>(<span class=\"number\">3</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">6</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                semaphore.acquire();</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                semaphore.release();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;&quot;</span> + i).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0</span><br><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">0</span><br><span class=\"line\">4</span><br><span class=\"line\">3</span><br><span class=\"line\">5</span><br><span class=\"line\">3</span><br><span class=\"line\">5</span><br><span class=\"line\">4</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SemaphoreAQS</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Semaphore</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">java</span>.io.Serializable &#123;</span><br><span class=\"line\">     <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Sync sync;</span><br><span class=\"line\">     <span class=\"keyword\">abstract</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Sync</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">AbstractQueuedSynchronizer</span> &#123;...&#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Semaphore</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">acquireSharedInterruptibly</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span></span><br><span class=\"line\">    <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (Thread.interrupted())</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">InterruptedException</span>();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tryAcquireShared(arg) &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        doAcquireSharedInterruptibly(arg);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Java--Semaphore\"><a href=\"#Java--Semaphore\" class=\"headerlink\" title=\"Java -  Semaphore\"></a>Java -  Semaphore</h1><p>Hystrix</p>\n<p></p>\n<p>Java Semaphore acquirereleaseavailablePermits() </p>\n<p>acquirerelease</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testSemaphore</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 33</span></span><br><span class=\"line\">    <span class=\"type\">Semaphore</span> <span class=\"variable\">semaphore</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Semaphore</span>(<span class=\"number\">3</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">6</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                semaphore.acquire();</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                semaphore.release();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;&quot;</span> + i).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0</span><br><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">0</span><br><span class=\"line\">4</span><br><span class=\"line\">3</span><br><span class=\"line\">5</span><br><span class=\"line\">3</span><br><span class=\"line\">5</span><br><span class=\"line\">4</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SemaphoreAQS</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Semaphore</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">java</span>.io.Serializable &#123;</span><br><span class=\"line\">     <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Sync sync;</span><br><span class=\"line\">     <span class=\"keyword\">abstract</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Sync</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">AbstractQueuedSynchronizer</span> &#123;...&#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Semaphore</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">acquireSharedInterruptibly</span><span class=\"params\">(<span class=\"type\">int</span> arg)</span></span><br><span class=\"line\">    <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (Thread.interrupted())</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">InterruptedException</span>();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tryAcquireShared(arg) &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        doAcquireSharedInterruptibly(arg);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"synchronized","date":"2021-06-07T05:58:00.000Z","comments":0,"_content":"\nsynchronized \n\nsynchronized Java\n\n## \n\n\n\n****\n\n1\n2\n\n\n\n```java\npublic class HasSelfPrivateNum_1 {\n\n    public void addI(String str) {\n        try {\n            int num = 0;\n            if (str.equals(\"a\")) {\n                num = 100;\n                System.out.println(\"a set over!\");\n                Thread.sleep(200);\n            } else {\n                num = 200;\n                System.out.println(\"b set over!\");\n            }\n            System.out.println(str + \" num=\" + num);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\nclass ThreadA extends Thread {\n    private HasSelfPrivateNum_1 numRef;\n\n    public ThreadA(HasSelfPrivateNum_1 numRef) {\n        this.numRef = numRef;\n    }\n\n    @Override\n    public void run() {\n        super.run();\n        numRef.addI(\"a\");\n    }\n}\n\nclass ThreadB extends Thread {\n    private HasSelfPrivateNum_1 numRef;\n\n    public ThreadB(HasSelfPrivateNum_1 numRef) {\n        this.numRef = numRef;\n    }\n    @Override\n    public void run() {\n        super.run();\n        numRef.addI(\"b\");\n    }\n}\n\nclass ThreadTest0216{\n    public static void main(String[] args) {\n        HasSelfPrivateNum_1 privateNum = new HasSelfPrivateNum_1();\n        ThreadA threadA  = new ThreadA(privateNum);\n        threadA.start();\n\n        ThreadB threadB = new ThreadB(privateNum);\n        threadB.start();\n    }\n}\n```\n\n\n\n```\na set over!\nb set over!\nb num=200\na num=100\n```\n\n## \n\n- \n- \n- \n\n```java\npublic class HasSelfPrivateNum_2 {\n    private int num = 0;\n\n    public void addI(String str) {\n        try {\n            if (str.equals(\"a\")) {\n                num = 100;\n                System.out.println(\"a set over!\");\n                Thread.sleep(200);\n            } else {\n                num = 200;\n                System.out.println(\"b set over!\");\n            }\n            System.out.println(str + \" num=\" + num);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\nclass ThreadC extends Thread {\n    private HasSelfPrivateNum_2 numRef;\n\n    public ThreadC(HasSelfPrivateNum_2 numRef) {\n        this.numRef = numRef;\n    }\n\n    @Override\n    public void run() {\n        super.run();\n        numRef.addI(\"a\");\n    }\n}\n\nclass ThreadD extends Thread {\n    private HasSelfPrivateNum_2 numRef;\n\n    public ThreadD(HasSelfPrivateNum_2 numRef) {\n        this.numRef = numRef;\n    }\n    @Override\n    public void run() {\n        super.run();\n        numRef.addI(\"b\");\n    }\n}\n\nclass ThreadTest02162{\n    public static void main(String[] args) {\n        HasSelfPrivateNum_2 privateNum = new HasSelfPrivateNum_2();\n        ThreadC threadC  = new ThreadC(privateNum);\n        threadC.start();\n\n        ThreadD threadD = new ThreadD(privateNum);\n        threadD.start();\n    }\n}\n```\n\n\n\n```\na set over!\nb set over!\nb num=200\na num=200\n```\n\n\n\n public void addI(String str)  synchronized \n\n\n\n## \n\nsysnchronized(****){\n\n  // (****)\n\n}\n\n1  \n\n2 \n\n****\n\n****\n\n```java\nclass W implements Runnable{\n    int ticket = 100;\n    // Object obj = new Object();\n    public void run(){\n        while(true) {\n            /*\n              this\n              \n              this\n             */\n            synchronized (this) {\n                if (ticket > 0) {\n                    try{\n                        Thread.currentThread().sleep(100);\n                        System.out.println(Thread.currentThread().getName() + \"\" + ticket--);\n                    }catch (InterruptedException e){\n                        e.printStackTrace();\n                    }\n                }\n            }\n        }\n    }\n}\npublic class TestThreadSecurity {\n    public static void main(String[] args){\n        W window = new W();\n        Thread window1 = new Thread(window);\n        Thread window2 = new Thread(window);\n        Thread window3 = new Thread(window);\n\n        window1.setName(\"1\");\n        window2.setName(\"2\");\n        window3.setName(\"3\");\n\n        window1.start();\n        window2.start();\n        window3.start();\n    }\n}\n```\n\n##  \n\nsysnchronized\n\nthis\n\n```java\nclass Win implements Runnable{\n    int ticket = 100;\n    // Object obj = new Object();\n    public void run(){\n        while(true){\n            show();\n        }\n    }\n    public synchronized void show(){\n        if (ticket > 0 ){\n            try{\n                Thread.currentThread().sleep(10);\n                System.out.println(Thread.currentThread().getName()+\"\"+ticket--);\n            }catch (InterruptedException e){\n                e.printStackTrace();\n            }\n        }\n    }\n}\n\npublic class TestThreadSecurity2 {\n    public static void main(String[] args){\n        Win window = new Win();\n        Thread window1 = new Thread(window);\n        Thread window2 = new Thread(window);\n        Thread window3 = new Thread(window);\n\n        window1.setName(\"1\");\n        window2.setName(\"2\");\n        window3.setName(\"3\");\n\n        window1.start();\n        window2.start();\n        window3.start();\n    }\n}\n```\n\n ****\n\nhttps://blog.csdn.net/qq_41647999/article/details/83447936\n\nprivatenewgetInstancegetInstance\n\n\n\n```java\nclass Singleton{\n    private Singleton(){\n\n    }\n    /*\n     ABgetInstance\n    instancenullASingleton\n    BinstancenullA\n    Singleton1111B\n    1111\n    instance\n    newnew\n     */\n    private static Singleton instance = null;\n    /*\n    instancenull\n    mate20\n    mate20\n    \n    instancenullmate20\n    \n    */\n    if (instance == null ){\n    public static Singleton getInstance(){\n        if (instance == null ){\n            instance = new Singleton();\n        }\n        return instance;\n    }\n}\n}\n\npublic class TestSingleton {\n    public static void main(String[] args) {\n        /*\n        getInstance(\n        )\n        getInstancestatic\n         */\n        Singleton s1 = Singleton.getInstance();\n        Singleton s2 = Singleton.getInstance();\n        System.out.println(s1 == s2);\n    }\n}\n```\n\n**BUG**\n\n```java\nclass Singleton2{\n    private Singleton2(){\n\n    }\n\n    private static Singleton2 instance = null;\n    public static Singleton2 getInstance() {\n        /*\n        1 staticthis\n        2 \n        3 \n         */\n        synchronized (Singleton2.class) {\n            /*\n            Singleton2.class\n             */\n            if (instance == null) {\n                instance = new Singleton2();\n            }\n            \n        }\n        return instance;\n    }\n}\n\npublic class TestSingleton2 {\n    public static void main(String[] args) {\n        Singleton2 s1 = Singleton2.getInstance();\n        Singleton2 s2 = Singleton2.getInstance();\n        System.out.println(s1 == s2);\n    }\n}\n```\n\n## synchronized\n\n\tsynchronizedflagACC_SYNCHRONIZED.ACC_SYNCHRONIZED\n```java\n/**\n *  public static synchronized void testMethod();\n *     descriptor: ()V\n *     flags: ACC_PUBLIC, ACC_STATIC, ACC_SYNCHRONIZED\n *     Code:\n *       stack=0, locals=0, args_size=0\n *          0: return\n *       LineNumberTable:\n *         line 26: 0\n *\n *       public synchronized.viod myMethod()\n *   flagACC_SYNCHRONIZED,\n *\n *\n *\n *  public void myMethod();\n *     descriptor: ()V\n *     flags: ACC_PUBLIC\n *     Code:\n *       stack=2, locals=4, args_size=1\n *          0: aload_0\n *          1: dup\n *          2: astore_1\n *          3: monitorenter\n *          4: bipush        100\n *          6: istore_2\n *          7: aload_1\n *          8: monitorexit\n *          9: goto          17\n *         12: astore_3\n *         13: aload_1\n *         14: monitorexit\n *         15: aload_3\n *         16: athrow\n *         17: return\n *\n *         monitorentermonitorexit\n *         AB\n *         AB\n */\nclass Test {\n    synchronized public static void testMethod(){\n\t\t\n    }\n    public static void Test()throws InterruptedException{\n        testMethod();\n    }\n}\npublic class Test2 {\n\t//  synchronized monitorenter  monitorexit \n     public void myMethod(){\n        synchronized (this){\n            int age=100;\n        }\n    }\n    public static void main(String[] args)throws InterruptedException {\n     \tTest2 test = new Test2();\n        test.myMethod();\t\n    }\n}\n```\n\n##  Synchronized \n\n object  a  b  t1  t2 t1  at2b\n\n1 a bt1  object  lock t2 object t1  t2 \n\n2 a b synchronized t1  t2 \n\n\n\n- Java \n- Java synchronized \n-  synchronized \n\n> synchronizedstatic\n\n## synchronized \n\n> \n\nsynchronized  synchronized  /  / \n\n```java\npublic class Service{\n    public synchronized  void fun1(){\n        System.out.println(\"\");\n        fun2();\n    }\n\n    public synchronized void fun2(){\n        System.out.println(\"\");\n        fun3();\n    }\n\n    public synchronized void fun3(){\n        System.out.println(\"\");\n    }\n}\n```\n\n```java\npublic class MyThread extends Thread {\n    private Service service;\n    \n    public SynThreadText(Service service){\n        this.service=service;\n    }\n    \n    @Override\n    public void run(){\n        service.fun1();\n    }\n\n    public static void main(String[] args) {\n        Service service = new Service();\n        MyThread myThread = new MyThread(service);\n        myThread.start();\n    }\n}\n```\n\n\n\n```\n\n\n\n```\n\n## synchronized \n\n synchronized \n\n```java\npublic class SubClass extends SuperClass implements Runnable {\n    @Override\n    public void run(){\n        this.subFun();\n    }\n\t\n    public synchronized  void subFun(){\n        System.out.println(\"\");\n        this.superSynFun();\n    }\n\t\n    public static void main(String[] args) {\n        SubClass sub = new SubClass();\n        Thread t = new Thread(sub);\n        t.start();\n    }\n\n}\n\nclass SuperClass{\n    public synchronized void superSynFun(){\n        System.out.println(\"\");\n    }\n}\n```\n\n\n\n```\n\n\n```\n\nsynchronized synchronized  \n\n## \n\n\n\nJIT\n\n```java\npublic void test(){\n    synchronized(lock){\n        //do some thing\n    }\n    // JITJITWatch\n    synchronized(lock){\n        //do other thing\n    }\n}\n```\n\nJIT\n\nStringBufferappend()  synchronized JIT\n\n## synchronized\n\nsynchronizedJMM\n\n![image-20210423124817593](.\\images\\synchronized.png)\n\nHotSpotMark WordClass Metadata AddressArray Length\n\n- Mark WordMark WordStateGCbitfields  \n- Class Metadata AddressClass\n- Array Length\n\nJVM ->  -> \n\nJVM\n\n![image-20210429101554456](.\\images\\JVM-.png)\n\n - monitor\n\n![image-20210429101903740](.\\images\\(monitor).png)\n\n","source":"_posts/Java - synchronized.md","raw":"---\ntitle: synchronized\ndate: 2021-06-07 13:58:00\ntags:\n  - JUC\ncomments: false\n---\n\nsynchronized \n\nsynchronized Java\n\n## \n\n\n\n****\n\n1\n2\n\n\n\n```java\npublic class HasSelfPrivateNum_1 {\n\n    public void addI(String str) {\n        try {\n            int num = 0;\n            if (str.equals(\"a\")) {\n                num = 100;\n                System.out.println(\"a set over!\");\n                Thread.sleep(200);\n            } else {\n                num = 200;\n                System.out.println(\"b set over!\");\n            }\n            System.out.println(str + \" num=\" + num);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\nclass ThreadA extends Thread {\n    private HasSelfPrivateNum_1 numRef;\n\n    public ThreadA(HasSelfPrivateNum_1 numRef) {\n        this.numRef = numRef;\n    }\n\n    @Override\n    public void run() {\n        super.run();\n        numRef.addI(\"a\");\n    }\n}\n\nclass ThreadB extends Thread {\n    private HasSelfPrivateNum_1 numRef;\n\n    public ThreadB(HasSelfPrivateNum_1 numRef) {\n        this.numRef = numRef;\n    }\n    @Override\n    public void run() {\n        super.run();\n        numRef.addI(\"b\");\n    }\n}\n\nclass ThreadTest0216{\n    public static void main(String[] args) {\n        HasSelfPrivateNum_1 privateNum = new HasSelfPrivateNum_1();\n        ThreadA threadA  = new ThreadA(privateNum);\n        threadA.start();\n\n        ThreadB threadB = new ThreadB(privateNum);\n        threadB.start();\n    }\n}\n```\n\n\n\n```\na set over!\nb set over!\nb num=200\na num=100\n```\n\n## \n\n- \n- \n- \n\n```java\npublic class HasSelfPrivateNum_2 {\n    private int num = 0;\n\n    public void addI(String str) {\n        try {\n            if (str.equals(\"a\")) {\n                num = 100;\n                System.out.println(\"a set over!\");\n                Thread.sleep(200);\n            } else {\n                num = 200;\n                System.out.println(\"b set over!\");\n            }\n            System.out.println(str + \" num=\" + num);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\nclass ThreadC extends Thread {\n    private HasSelfPrivateNum_2 numRef;\n\n    public ThreadC(HasSelfPrivateNum_2 numRef) {\n        this.numRef = numRef;\n    }\n\n    @Override\n    public void run() {\n        super.run();\n        numRef.addI(\"a\");\n    }\n}\n\nclass ThreadD extends Thread {\n    private HasSelfPrivateNum_2 numRef;\n\n    public ThreadD(HasSelfPrivateNum_2 numRef) {\n        this.numRef = numRef;\n    }\n    @Override\n    public void run() {\n        super.run();\n        numRef.addI(\"b\");\n    }\n}\n\nclass ThreadTest02162{\n    public static void main(String[] args) {\n        HasSelfPrivateNum_2 privateNum = new HasSelfPrivateNum_2();\n        ThreadC threadC  = new ThreadC(privateNum);\n        threadC.start();\n\n        ThreadD threadD = new ThreadD(privateNum);\n        threadD.start();\n    }\n}\n```\n\n\n\n```\na set over!\nb set over!\nb num=200\na num=200\n```\n\n\n\n public void addI(String str)  synchronized \n\n\n\n## \n\nsysnchronized(****){\n\n  // (****)\n\n}\n\n1  \n\n2 \n\n****\n\n****\n\n```java\nclass W implements Runnable{\n    int ticket = 100;\n    // Object obj = new Object();\n    public void run(){\n        while(true) {\n            /*\n              this\n              \n              this\n             */\n            synchronized (this) {\n                if (ticket > 0) {\n                    try{\n                        Thread.currentThread().sleep(100);\n                        System.out.println(Thread.currentThread().getName() + \"\" + ticket--);\n                    }catch (InterruptedException e){\n                        e.printStackTrace();\n                    }\n                }\n            }\n        }\n    }\n}\npublic class TestThreadSecurity {\n    public static void main(String[] args){\n        W window = new W();\n        Thread window1 = new Thread(window);\n        Thread window2 = new Thread(window);\n        Thread window3 = new Thread(window);\n\n        window1.setName(\"1\");\n        window2.setName(\"2\");\n        window3.setName(\"3\");\n\n        window1.start();\n        window2.start();\n        window3.start();\n    }\n}\n```\n\n##  \n\nsysnchronized\n\nthis\n\n```java\nclass Win implements Runnable{\n    int ticket = 100;\n    // Object obj = new Object();\n    public void run(){\n        while(true){\n            show();\n        }\n    }\n    public synchronized void show(){\n        if (ticket > 0 ){\n            try{\n                Thread.currentThread().sleep(10);\n                System.out.println(Thread.currentThread().getName()+\"\"+ticket--);\n            }catch (InterruptedException e){\n                e.printStackTrace();\n            }\n        }\n    }\n}\n\npublic class TestThreadSecurity2 {\n    public static void main(String[] args){\n        Win window = new Win();\n        Thread window1 = new Thread(window);\n        Thread window2 = new Thread(window);\n        Thread window3 = new Thread(window);\n\n        window1.setName(\"1\");\n        window2.setName(\"2\");\n        window3.setName(\"3\");\n\n        window1.start();\n        window2.start();\n        window3.start();\n    }\n}\n```\n\n ****\n\nhttps://blog.csdn.net/qq_41647999/article/details/83447936\n\nprivatenewgetInstancegetInstance\n\n\n\n```java\nclass Singleton{\n    private Singleton(){\n\n    }\n    /*\n     ABgetInstance\n    instancenullASingleton\n    BinstancenullA\n    Singleton1111B\n    1111\n    instance\n    newnew\n     */\n    private static Singleton instance = null;\n    /*\n    instancenull\n    mate20\n    mate20\n    \n    instancenullmate20\n    \n    */\n    if (instance == null ){\n    public static Singleton getInstance(){\n        if (instance == null ){\n            instance = new Singleton();\n        }\n        return instance;\n    }\n}\n}\n\npublic class TestSingleton {\n    public static void main(String[] args) {\n        /*\n        getInstance(\n        )\n        getInstancestatic\n         */\n        Singleton s1 = Singleton.getInstance();\n        Singleton s2 = Singleton.getInstance();\n        System.out.println(s1 == s2);\n    }\n}\n```\n\n**BUG**\n\n```java\nclass Singleton2{\n    private Singleton2(){\n\n    }\n\n    private static Singleton2 instance = null;\n    public static Singleton2 getInstance() {\n        /*\n        1 staticthis\n        2 \n        3 \n         */\n        synchronized (Singleton2.class) {\n            /*\n            Singleton2.class\n             */\n            if (instance == null) {\n                instance = new Singleton2();\n            }\n            \n        }\n        return instance;\n    }\n}\n\npublic class TestSingleton2 {\n    public static void main(String[] args) {\n        Singleton2 s1 = Singleton2.getInstance();\n        Singleton2 s2 = Singleton2.getInstance();\n        System.out.println(s1 == s2);\n    }\n}\n```\n\n## synchronized\n\n\tsynchronizedflagACC_SYNCHRONIZED.ACC_SYNCHRONIZED\n```java\n/**\n *  public static synchronized void testMethod();\n *     descriptor: ()V\n *     flags: ACC_PUBLIC, ACC_STATIC, ACC_SYNCHRONIZED\n *     Code:\n *       stack=0, locals=0, args_size=0\n *          0: return\n *       LineNumberTable:\n *         line 26: 0\n *\n *       public synchronized.viod myMethod()\n *   flagACC_SYNCHRONIZED,\n *\n *\n *\n *  public void myMethod();\n *     descriptor: ()V\n *     flags: ACC_PUBLIC\n *     Code:\n *       stack=2, locals=4, args_size=1\n *          0: aload_0\n *          1: dup\n *          2: astore_1\n *          3: monitorenter\n *          4: bipush        100\n *          6: istore_2\n *          7: aload_1\n *          8: monitorexit\n *          9: goto          17\n *         12: astore_3\n *         13: aload_1\n *         14: monitorexit\n *         15: aload_3\n *         16: athrow\n *         17: return\n *\n *         monitorentermonitorexit\n *         AB\n *         AB\n */\nclass Test {\n    synchronized public static void testMethod(){\n\t\t\n    }\n    public static void Test()throws InterruptedException{\n        testMethod();\n    }\n}\npublic class Test2 {\n\t//  synchronized monitorenter  monitorexit \n     public void myMethod(){\n        synchronized (this){\n            int age=100;\n        }\n    }\n    public static void main(String[] args)throws InterruptedException {\n     \tTest2 test = new Test2();\n        test.myMethod();\t\n    }\n}\n```\n\n##  Synchronized \n\n object  a  b  t1  t2 t1  at2b\n\n1 a bt1  object  lock t2 object t1  t2 \n\n2 a b synchronized t1  t2 \n\n\n\n- Java \n- Java synchronized \n-  synchronized \n\n> synchronizedstatic\n\n## synchronized \n\n> \n\nsynchronized  synchronized  /  / \n\n```java\npublic class Service{\n    public synchronized  void fun1(){\n        System.out.println(\"\");\n        fun2();\n    }\n\n    public synchronized void fun2(){\n        System.out.println(\"\");\n        fun3();\n    }\n\n    public synchronized void fun3(){\n        System.out.println(\"\");\n    }\n}\n```\n\n```java\npublic class MyThread extends Thread {\n    private Service service;\n    \n    public SynThreadText(Service service){\n        this.service=service;\n    }\n    \n    @Override\n    public void run(){\n        service.fun1();\n    }\n\n    public static void main(String[] args) {\n        Service service = new Service();\n        MyThread myThread = new MyThread(service);\n        myThread.start();\n    }\n}\n```\n\n\n\n```\n\n\n\n```\n\n## synchronized \n\n synchronized \n\n```java\npublic class SubClass extends SuperClass implements Runnable {\n    @Override\n    public void run(){\n        this.subFun();\n    }\n\t\n    public synchronized  void subFun(){\n        System.out.println(\"\");\n        this.superSynFun();\n    }\n\t\n    public static void main(String[] args) {\n        SubClass sub = new SubClass();\n        Thread t = new Thread(sub);\n        t.start();\n    }\n\n}\n\nclass SuperClass{\n    public synchronized void superSynFun(){\n        System.out.println(\"\");\n    }\n}\n```\n\n\n\n```\n\n\n```\n\nsynchronized synchronized  \n\n## \n\n\n\nJIT\n\n```java\npublic void test(){\n    synchronized(lock){\n        //do some thing\n    }\n    // JITJITWatch\n    synchronized(lock){\n        //do other thing\n    }\n}\n```\n\nJIT\n\nStringBufferappend()  synchronized JIT\n\n## synchronized\n\nsynchronizedJMM\n\n![image-20210423124817593](.\\images\\synchronized.png)\n\nHotSpotMark WordClass Metadata AddressArray Length\n\n- Mark WordMark WordStateGCbitfields  \n- Class Metadata AddressClass\n- Array Length\n\nJVM ->  -> \n\nJVM\n\n![image-20210429101554456](.\\images\\JVM-.png)\n\n - monitor\n\n![image-20210429101903740](.\\images\\(monitor).png)\n\n","slug":"Java - synchronized","published":1,"updated":"2022-02-28T10:49:27.154Z","_id":"cl06kvvne001aqwu570ix6lt4","layout":"post","photos":[],"link":"","content":"<p>synchronized </p>\n<p>synchronized Java</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p><strong></strong></p>\n<p>1<br>2</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HasSelfPrivateNum_1</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addI</span><span class=\"params\">(String str)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">num</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (str.equals(<span class=\"string\">&quot;a&quot;</span>)) &#123;</span><br><span class=\"line\">                num = <span class=\"number\">100</span>;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;a set over!&quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">200</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                num = <span class=\"number\">200</span>;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;b set over!&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(str + <span class=\"string\">&quot; num=&quot;</span> + num);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadA</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HasSelfPrivateNum_1 numRef;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ThreadA</span><span class=\"params\">(HasSelfPrivateNum_1 numRef)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.numRef = numRef;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        numRef.addI(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadB</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HasSelfPrivateNum_1 numRef;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ThreadB</span><span class=\"params\">(HasSelfPrivateNum_1 numRef)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.numRef = numRef;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        numRef.addI(<span class=\"string\">&quot;b&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadTest0216</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">HasSelfPrivateNum_1</span> <span class=\"variable\">privateNum</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HasSelfPrivateNum_1</span>();</span><br><span class=\"line\">        <span class=\"type\">ThreadA</span> <span class=\"variable\">threadA</span>  <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadA</span>(privateNum);</span><br><span class=\"line\">        threadA.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">ThreadB</span> <span class=\"variable\">threadB</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadB</span>(privateNum);</span><br><span class=\"line\">        threadB.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a set over!</span><br><span class=\"line\">b set over!</span><br><span class=\"line\">b num=200</span><br><span class=\"line\">a num=100</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HasSelfPrivateNum_2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">num</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addI</span><span class=\"params\">(String str)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (str.equals(<span class=\"string\">&quot;a&quot;</span>)) &#123;</span><br><span class=\"line\">                num = <span class=\"number\">100</span>;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;a set over!&quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">200</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                num = <span class=\"number\">200</span>;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;b set over!&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(str + <span class=\"string\">&quot; num=&quot;</span> + num);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadC</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HasSelfPrivateNum_2 numRef;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ThreadC</span><span class=\"params\">(HasSelfPrivateNum_2 numRef)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.numRef = numRef;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        numRef.addI(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadD</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HasSelfPrivateNum_2 numRef;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ThreadD</span><span class=\"params\">(HasSelfPrivateNum_2 numRef)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.numRef = numRef;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        numRef.addI(<span class=\"string\">&quot;b&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadTest02162</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">HasSelfPrivateNum_2</span> <span class=\"variable\">privateNum</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HasSelfPrivateNum_2</span>();</span><br><span class=\"line\">        <span class=\"type\">ThreadC</span> <span class=\"variable\">threadC</span>  <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadC</span>(privateNum);</span><br><span class=\"line\">        threadC.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">ThreadD</span> <span class=\"variable\">threadD</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadD</span>(privateNum);</span><br><span class=\"line\">        threadD.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a set over!</span><br><span class=\"line\">b set over!</span><br><span class=\"line\">b num=200</span><br><span class=\"line\">a num=200</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p> public void addI(String str)  synchronized </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>sysnchronized(<strong></strong>){</p>\n<p>  // (<strong></strong>)</p>\n<p>}</p>\n<p>1  </p>\n<p>2 </p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">W</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">ticket</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">    <span class=\"comment\">// Object obj = new Object();</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">              this</span></span><br><span class=\"line\"><span class=\"comment\">              </span></span><br><span class=\"line\"><span class=\"comment\">              this</span></span><br><span class=\"line\"><span class=\"comment\">             */</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (ticket &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                        Thread.currentThread().sleep(<span class=\"number\">100</span>);</span><br><span class=\"line\">                        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;&quot;</span> + ticket--);</span><br><span class=\"line\">                    &#125;<span class=\"keyword\">catch</span> (InterruptedException e)&#123;</span><br><span class=\"line\">                        e.printStackTrace();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TestThreadSecurity</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">W</span> <span class=\"variable\">window</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">W</span>();</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\"></span><br><span class=\"line\">        window1.setName(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">        window2.setName(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">        window3.setName(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        window1.start();</span><br><span class=\"line\">        window2.start();</span><br><span class=\"line\">        window3.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>sysnchronized</p>\n<p>this</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Win</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">ticket</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">    <span class=\"comment\">// Object obj = new Object();</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(<span class=\"literal\">true</span>)&#123;</span><br><span class=\"line\">            show();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">show</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ticket &gt; <span class=\"number\">0</span> )&#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                Thread.currentThread().sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;&quot;</span>+ticket--);</span><br><span class=\"line\">            &#125;<span class=\"keyword\">catch</span> (InterruptedException e)&#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TestThreadSecurity2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">Win</span> <span class=\"variable\">window</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Win</span>();</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\"></span><br><span class=\"line\">        window1.setName(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">        window2.setName(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">        window3.setName(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        window1.start();</span><br><span class=\"line\">        window2.start();</span><br><span class=\"line\">        window3.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <strong></strong></p>\n<p><a href=\"https://blog.csdn.net/qq_41647999/article/details/83447936\">https://blog.csdn.net/qq_41647999/article/details/83447936</a></p>\n<p>privatenewgetInstancegetInstance</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Singleton</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">Singleton</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     ABgetInstance</span></span><br><span class=\"line\"><span class=\"comment\">    instancenullASingleton</span></span><br><span class=\"line\"><span class=\"comment\">    BinstancenullA</span></span><br><span class=\"line\"><span class=\"comment\">    Singleton1111B</span></span><br><span class=\"line\"><span class=\"comment\">    1111</span></span><br><span class=\"line\"><span class=\"comment\">    instance</span></span><br><span class=\"line\"><span class=\"comment\">    newnew</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Singleton</span> <span class=\"variable\">instance</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    instancenull</span></span><br><span class=\"line\"><span class=\"comment\">    mate20</span></span><br><span class=\"line\"><span class=\"comment\">    mate20</span></span><br><span class=\"line\"><span class=\"comment\">    </span></span><br><span class=\"line\"><span class=\"comment\">    instancenullmate20</span></span><br><span class=\"line\"><span class=\"comment\">    </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (instance == <span class=\"literal\">null</span> )&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title function_\">getInstance</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (instance == <span class=\"literal\">null</span> )&#123;</span><br><span class=\"line\">            instance = <span class=\"keyword\">new</span> <span class=\"title class_\">Singleton</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TestSingleton</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">        getInstance(</span></span><br><span class=\"line\"><span class=\"comment\">        )</span></span><br><span class=\"line\"><span class=\"comment\">        getInstancestatic</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"type\">Singleton</span> <span class=\"variable\">s1</span> <span class=\"operator\">=</span> Singleton.getInstance();</span><br><span class=\"line\">        <span class=\"type\">Singleton</span> <span class=\"variable\">s2</span> <span class=\"operator\">=</span> Singleton.getInstance();</span><br><span class=\"line\">        System.out.println(s1 == s2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>BUG</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Singleton2</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">Singleton2</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Singleton2</span> <span class=\"variable\">instance</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton2 <span class=\"title function_\">getInstance</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">        1 staticthis</span></span><br><span class=\"line\"><span class=\"comment\">        2 </span></span><br><span class=\"line\"><span class=\"comment\">        3 </span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (Singleton2.class) &#123;</span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">            Singleton2.class</span></span><br><span class=\"line\"><span class=\"comment\">             */</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (instance == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                instance = <span class=\"keyword\">new</span> <span class=\"title class_\">Singleton2</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TestSingleton2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Singleton2</span> <span class=\"variable\">s1</span> <span class=\"operator\">=</span> Singleton2.getInstance();</span><br><span class=\"line\">        <span class=\"type\">Singleton2</span> <span class=\"variable\">s2</span> <span class=\"operator\">=</span> Singleton2.getInstance();</span><br><span class=\"line\">        System.out.println(s1 == s2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><p>    synchronizedflagACC_SYNCHRONIZED.ACC_SYNCHRONIZED</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  public static synchronized void testMethod();</span></span><br><span class=\"line\"><span class=\"comment\"> *     descriptor: ()V</span></span><br><span class=\"line\"><span class=\"comment\"> *     flags: ACC_PUBLIC, ACC_STATIC, ACC_SYNCHRONIZED</span></span><br><span class=\"line\"><span class=\"comment\"> *     Code:</span></span><br><span class=\"line\"><span class=\"comment\"> *       stack=0, locals=0, args_size=0</span></span><br><span class=\"line\"><span class=\"comment\"> *          0: return</span></span><br><span class=\"line\"><span class=\"comment\"> *       LineNumberTable:</span></span><br><span class=\"line\"><span class=\"comment\"> *         line 26: 0</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *       public synchronized.viod myMethod()</span></span><br><span class=\"line\"><span class=\"comment\"> *   flagACC_SYNCHRONIZED,</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *  public void myMethod();</span></span><br><span class=\"line\"><span class=\"comment\"> *     descriptor: ()V</span></span><br><span class=\"line\"><span class=\"comment\"> *     flags: ACC_PUBLIC</span></span><br><span class=\"line\"><span class=\"comment\"> *     Code:</span></span><br><span class=\"line\"><span class=\"comment\"> *       stack=2, locals=4, args_size=1</span></span><br><span class=\"line\"><span class=\"comment\"> *          0: aload_0</span></span><br><span class=\"line\"><span class=\"comment\"> *          1: dup</span></span><br><span class=\"line\"><span class=\"comment\"> *          2: astore_1</span></span><br><span class=\"line\"><span class=\"comment\"> *          3: monitorenter</span></span><br><span class=\"line\"><span class=\"comment\"> *          4: bipush        100</span></span><br><span class=\"line\"><span class=\"comment\"> *          6: istore_2</span></span><br><span class=\"line\"><span class=\"comment\"> *          7: aload_1</span></span><br><span class=\"line\"><span class=\"comment\"> *          8: monitorexit</span></span><br><span class=\"line\"><span class=\"comment\"> *          9: goto          17</span></span><br><span class=\"line\"><span class=\"comment\"> *         12: astore_3</span></span><br><span class=\"line\"><span class=\"comment\"> *         13: aload_1</span></span><br><span class=\"line\"><span class=\"comment\"> *         14: monitorexit</span></span><br><span class=\"line\"><span class=\"comment\"> *         15: aload_3</span></span><br><span class=\"line\"><span class=\"comment\"> *         16: athrow</span></span><br><span class=\"line\"><span class=\"comment\"> *         17: return</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *         monitorentermonitorexit</span></span><br><span class=\"line\"><span class=\"comment\"> *         AB</span></span><br><span class=\"line\"><span class=\"comment\"> *         AB</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testMethod</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">Test</span><span class=\"params\">()</span><span class=\"keyword\">throws</span> InterruptedException&#123;</span><br><span class=\"line\">        testMethod();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test2</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//  synchronized monitorenter  monitorexit </span></span><br><span class=\"line\">     <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">myMethod</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> age=<span class=\"number\">100</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span><span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">     \t<span class=\"type\">Test2</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test2</span>();</span><br><span class=\"line\">        test.myMethod();\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-Synchronized-\"><a href=\"#-Synchronized-\" class=\"headerlink\" title=\" Synchronized \"></a> Synchronized </h2><p> object  a  b  t1  t2 t1  at2b</p>\n<p>1 a bt1  object  lock t2 object t1  t2 </p>\n<p>2 a b synchronized t1  t2 </p>\n<p></p>\n<ul>\n<li>Java </li>\n<li>Java synchronized </li>\n<li> synchronized </li>\n</ul>\n<blockquote>\n<p>synchronizedstatic</p>\n</blockquote>\n<h2 id=\"synchronized-\"><a href=\"#synchronized-\" class=\"headerlink\" title=\"synchronized \"></a>synchronized </h2><blockquote>\n<p></p>\n</blockquote>\n<p>synchronized  synchronized  /  / </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Service</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span>  <span class=\"keyword\">void</span> <span class=\"title function_\">fun1</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        fun2();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">fun2</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        fun3();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">fun3</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Service service;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">SynThreadText</span><span class=\"params\">(Service service)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.service=service;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        service.fun1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Service</span> <span class=\"variable\">service</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Service</span>();</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>(service);</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"synchronized-\"><a href=\"#synchronized-\" class=\"headerlink\" title=\"synchronized \"></a>synchronized </h2><p> synchronized </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SubClass</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">SuperClass</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.subFun();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span>  <span class=\"keyword\">void</span> <span class=\"title function_\">subFun</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.superSynFun();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">SubClass</span> <span class=\"variable\">sub</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SubClass</span>();</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(sub);</span><br><span class=\"line\">        t.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">SuperClass</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">superSynFun</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>synchronized synchronized  </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>JIT</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span>(lock)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//do some thing</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// JITJITWatch</span></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span>(lock)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//do other thing</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JIT</p>\n<p>StringBufferappend()  synchronized JIT</p>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><p>synchronizedJMM</p>\n<p><img src=\".%5Cimages%5Csynchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86.png\" alt=\"image-20210423124817593\"></p>\n<p>HotSpotMark WordClass Metadata AddressArray Length</p>\n<ul>\n<li>Mark WordMark WordStateGCbitfields  </li>\n<li>Class Metadata AddressClass</li>\n<li>Array Length</li>\n</ul>\n<p>JVM -&gt;  -&gt; </p>\n<p>JVM</p>\n<p><img src=\".%5Cimages%5CJVM-%E4%BB%8E%E5%81%8F%E5%90%91%E9%94%81%E5%88%B0%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81%E7%9A%84%E8%BF%87%E7%A8%8B.png\" alt=\"image-20210429101554456\"></p>\n<p> - monitor</p>\n<p><img src=\".%5Cimages%5C%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81%E7%9B%91%E8%A7%86%E5%99%A8(monitor)%E5%8E%9F%E7%90%86.png\" alt=\"image-20210429101903740\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>synchronized </p>\n<p>synchronized Java</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p><strong></strong></p>\n<p>1<br>2</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HasSelfPrivateNum_1</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addI</span><span class=\"params\">(String str)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">num</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (str.equals(<span class=\"string\">&quot;a&quot;</span>)) &#123;</span><br><span class=\"line\">                num = <span class=\"number\">100</span>;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;a set over!&quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">200</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                num = <span class=\"number\">200</span>;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;b set over!&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(str + <span class=\"string\">&quot; num=&quot;</span> + num);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadA</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HasSelfPrivateNum_1 numRef;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ThreadA</span><span class=\"params\">(HasSelfPrivateNum_1 numRef)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.numRef = numRef;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        numRef.addI(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadB</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HasSelfPrivateNum_1 numRef;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ThreadB</span><span class=\"params\">(HasSelfPrivateNum_1 numRef)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.numRef = numRef;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        numRef.addI(<span class=\"string\">&quot;b&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadTest0216</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">HasSelfPrivateNum_1</span> <span class=\"variable\">privateNum</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HasSelfPrivateNum_1</span>();</span><br><span class=\"line\">        <span class=\"type\">ThreadA</span> <span class=\"variable\">threadA</span>  <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadA</span>(privateNum);</span><br><span class=\"line\">        threadA.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">ThreadB</span> <span class=\"variable\">threadB</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadB</span>(privateNum);</span><br><span class=\"line\">        threadB.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a set over!</span><br><span class=\"line\">b set over!</span><br><span class=\"line\">b num=200</span><br><span class=\"line\">a num=100</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HasSelfPrivateNum_2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">num</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addI</span><span class=\"params\">(String str)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (str.equals(<span class=\"string\">&quot;a&quot;</span>)) &#123;</span><br><span class=\"line\">                num = <span class=\"number\">100</span>;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;a set over!&quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">200</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                num = <span class=\"number\">200</span>;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;b set over!&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(str + <span class=\"string\">&quot; num=&quot;</span> + num);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadC</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HasSelfPrivateNum_2 numRef;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ThreadC</span><span class=\"params\">(HasSelfPrivateNum_2 numRef)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.numRef = numRef;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        numRef.addI(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadD</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HasSelfPrivateNum_2 numRef;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ThreadD</span><span class=\"params\">(HasSelfPrivateNum_2 numRef)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.numRef = numRef;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.run();</span><br><span class=\"line\">        numRef.addI(<span class=\"string\">&quot;b&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadTest02162</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">HasSelfPrivateNum_2</span> <span class=\"variable\">privateNum</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HasSelfPrivateNum_2</span>();</span><br><span class=\"line\">        <span class=\"type\">ThreadC</span> <span class=\"variable\">threadC</span>  <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadC</span>(privateNum);</span><br><span class=\"line\">        threadC.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">ThreadD</span> <span class=\"variable\">threadD</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadD</span>(privateNum);</span><br><span class=\"line\">        threadD.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a set over!</span><br><span class=\"line\">b set over!</span><br><span class=\"line\">b num=200</span><br><span class=\"line\">a num=200</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p> public void addI(String str)  synchronized </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>sysnchronized(<strong></strong>){</p>\n<p>  // (<strong></strong>)</p>\n<p>}</p>\n<p>1  </p>\n<p>2 </p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">W</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">ticket</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">    <span class=\"comment\">// Object obj = new Object();</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">              this</span></span><br><span class=\"line\"><span class=\"comment\">              </span></span><br><span class=\"line\"><span class=\"comment\">              this</span></span><br><span class=\"line\"><span class=\"comment\">             */</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (ticket &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                        Thread.currentThread().sleep(<span class=\"number\">100</span>);</span><br><span class=\"line\">                        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;&quot;</span> + ticket--);</span><br><span class=\"line\">                    &#125;<span class=\"keyword\">catch</span> (InterruptedException e)&#123;</span><br><span class=\"line\">                        e.printStackTrace();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TestThreadSecurity</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">W</span> <span class=\"variable\">window</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">W</span>();</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\"></span><br><span class=\"line\">        window1.setName(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">        window2.setName(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">        window3.setName(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        window1.start();</span><br><span class=\"line\">        window2.start();</span><br><span class=\"line\">        window3.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>sysnchronized</p>\n<p>this</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Win</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">ticket</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">    <span class=\"comment\">// Object obj = new Object();</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(<span class=\"literal\">true</span>)&#123;</span><br><span class=\"line\">            show();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">show</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ticket &gt; <span class=\"number\">0</span> )&#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                Thread.currentThread().sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;&quot;</span>+ticket--);</span><br><span class=\"line\">            &#125;<span class=\"keyword\">catch</span> (InterruptedException e)&#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TestThreadSecurity2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">Win</span> <span class=\"variable\">window</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Win</span>();</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">window3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(window);</span><br><span class=\"line\"></span><br><span class=\"line\">        window1.setName(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">        window2.setName(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">        window3.setName(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        window1.start();</span><br><span class=\"line\">        window2.start();</span><br><span class=\"line\">        window3.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <strong></strong></p>\n<p><a href=\"https://blog.csdn.net/qq_41647999/article/details/83447936\">https://blog.csdn.net/qq_41647999/article/details/83447936</a></p>\n<p>privatenewgetInstancegetInstance</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Singleton</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">Singleton</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     ABgetInstance</span></span><br><span class=\"line\"><span class=\"comment\">    instancenullASingleton</span></span><br><span class=\"line\"><span class=\"comment\">    BinstancenullA</span></span><br><span class=\"line\"><span class=\"comment\">    Singleton1111B</span></span><br><span class=\"line\"><span class=\"comment\">    1111</span></span><br><span class=\"line\"><span class=\"comment\">    instance</span></span><br><span class=\"line\"><span class=\"comment\">    newnew</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Singleton</span> <span class=\"variable\">instance</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    instancenull</span></span><br><span class=\"line\"><span class=\"comment\">    mate20</span></span><br><span class=\"line\"><span class=\"comment\">    mate20</span></span><br><span class=\"line\"><span class=\"comment\">    </span></span><br><span class=\"line\"><span class=\"comment\">    instancenullmate20</span></span><br><span class=\"line\"><span class=\"comment\">    </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (instance == <span class=\"literal\">null</span> )&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title function_\">getInstance</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (instance == <span class=\"literal\">null</span> )&#123;</span><br><span class=\"line\">            instance = <span class=\"keyword\">new</span> <span class=\"title class_\">Singleton</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TestSingleton</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">        getInstance(</span></span><br><span class=\"line\"><span class=\"comment\">        )</span></span><br><span class=\"line\"><span class=\"comment\">        getInstancestatic</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"type\">Singleton</span> <span class=\"variable\">s1</span> <span class=\"operator\">=</span> Singleton.getInstance();</span><br><span class=\"line\">        <span class=\"type\">Singleton</span> <span class=\"variable\">s2</span> <span class=\"operator\">=</span> Singleton.getInstance();</span><br><span class=\"line\">        System.out.println(s1 == s2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>BUG</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Singleton2</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">Singleton2</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Singleton2</span> <span class=\"variable\">instance</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton2 <span class=\"title function_\">getInstance</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">        1 staticthis</span></span><br><span class=\"line\"><span class=\"comment\">        2 </span></span><br><span class=\"line\"><span class=\"comment\">        3 </span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (Singleton2.class) &#123;</span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">            Singleton2.class</span></span><br><span class=\"line\"><span class=\"comment\">             */</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (instance == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                instance = <span class=\"keyword\">new</span> <span class=\"title class_\">Singleton2</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TestSingleton2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Singleton2</span> <span class=\"variable\">s1</span> <span class=\"operator\">=</span> Singleton2.getInstance();</span><br><span class=\"line\">        <span class=\"type\">Singleton2</span> <span class=\"variable\">s2</span> <span class=\"operator\">=</span> Singleton2.getInstance();</span><br><span class=\"line\">        System.out.println(s1 == s2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><p>    synchronizedflagACC_SYNCHRONIZED.ACC_SYNCHRONIZED</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  public static synchronized void testMethod();</span></span><br><span class=\"line\"><span class=\"comment\"> *     descriptor: ()V</span></span><br><span class=\"line\"><span class=\"comment\"> *     flags: ACC_PUBLIC, ACC_STATIC, ACC_SYNCHRONIZED</span></span><br><span class=\"line\"><span class=\"comment\"> *     Code:</span></span><br><span class=\"line\"><span class=\"comment\"> *       stack=0, locals=0, args_size=0</span></span><br><span class=\"line\"><span class=\"comment\"> *          0: return</span></span><br><span class=\"line\"><span class=\"comment\"> *       LineNumberTable:</span></span><br><span class=\"line\"><span class=\"comment\"> *         line 26: 0</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *       public synchronized.viod myMethod()</span></span><br><span class=\"line\"><span class=\"comment\"> *   flagACC_SYNCHRONIZED,</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *  public void myMethod();</span></span><br><span class=\"line\"><span class=\"comment\"> *     descriptor: ()V</span></span><br><span class=\"line\"><span class=\"comment\"> *     flags: ACC_PUBLIC</span></span><br><span class=\"line\"><span class=\"comment\"> *     Code:</span></span><br><span class=\"line\"><span class=\"comment\"> *       stack=2, locals=4, args_size=1</span></span><br><span class=\"line\"><span class=\"comment\"> *          0: aload_0</span></span><br><span class=\"line\"><span class=\"comment\"> *          1: dup</span></span><br><span class=\"line\"><span class=\"comment\"> *          2: astore_1</span></span><br><span class=\"line\"><span class=\"comment\"> *          3: monitorenter</span></span><br><span class=\"line\"><span class=\"comment\"> *          4: bipush        100</span></span><br><span class=\"line\"><span class=\"comment\"> *          6: istore_2</span></span><br><span class=\"line\"><span class=\"comment\"> *          7: aload_1</span></span><br><span class=\"line\"><span class=\"comment\"> *          8: monitorexit</span></span><br><span class=\"line\"><span class=\"comment\"> *          9: goto          17</span></span><br><span class=\"line\"><span class=\"comment\"> *         12: astore_3</span></span><br><span class=\"line\"><span class=\"comment\"> *         13: aload_1</span></span><br><span class=\"line\"><span class=\"comment\"> *         14: monitorexit</span></span><br><span class=\"line\"><span class=\"comment\"> *         15: aload_3</span></span><br><span class=\"line\"><span class=\"comment\"> *         16: athrow</span></span><br><span class=\"line\"><span class=\"comment\"> *         17: return</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *         monitorentermonitorexit</span></span><br><span class=\"line\"><span class=\"comment\"> *         AB</span></span><br><span class=\"line\"><span class=\"comment\"> *         AB</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testMethod</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">Test</span><span class=\"params\">()</span><span class=\"keyword\">throws</span> InterruptedException&#123;</span><br><span class=\"line\">        testMethod();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test2</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//  synchronized monitorenter  monitorexit </span></span><br><span class=\"line\">     <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">myMethod</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> age=<span class=\"number\">100</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span><span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">     \t<span class=\"type\">Test2</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test2</span>();</span><br><span class=\"line\">        test.myMethod();\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-Synchronized-\"><a href=\"#-Synchronized-\" class=\"headerlink\" title=\" Synchronized \"></a> Synchronized </h2><p> object  a  b  t1  t2 t1  at2b</p>\n<p>1 a bt1  object  lock t2 object t1  t2 </p>\n<p>2 a b synchronized t1  t2 </p>\n<p></p>\n<ul>\n<li>Java </li>\n<li>Java synchronized </li>\n<li> synchronized </li>\n</ul>\n<blockquote>\n<p>synchronizedstatic</p>\n</blockquote>\n<h2 id=\"synchronized-\"><a href=\"#synchronized-\" class=\"headerlink\" title=\"synchronized \"></a>synchronized </h2><blockquote>\n<p></p>\n</blockquote>\n<p>synchronized  synchronized  /  / </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Service</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span>  <span class=\"keyword\">void</span> <span class=\"title function_\">fun1</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        fun2();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">fun2</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        fun3();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">fun3</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Service service;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">SynThreadText</span><span class=\"params\">(Service service)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.service=service;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        service.fun1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Service</span> <span class=\"variable\">service</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Service</span>();</span><br><span class=\"line\">        <span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>(service);</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"synchronized-\"><a href=\"#synchronized-\" class=\"headerlink\" title=\"synchronized \"></a>synchronized </h2><p> synchronized </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SubClass</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">SuperClass</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.subFun();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span>  <span class=\"keyword\">void</span> <span class=\"title function_\">subFun</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.superSynFun();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">SubClass</span> <span class=\"variable\">sub</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SubClass</span>();</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(sub);</span><br><span class=\"line\">        t.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">SuperClass</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">superSynFun</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>synchronized synchronized  </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>JIT</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span>(lock)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//do some thing</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// JITJITWatch</span></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span>(lock)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//do other thing</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JIT</p>\n<p>StringBufferappend()  synchronized JIT</p>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><p>synchronizedJMM</p>\n<p><img src=\".%5Cimages%5Csynchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86.png\" alt=\"image-20210423124817593\"></p>\n<p>HotSpotMark WordClass Metadata AddressArray Length</p>\n<ul>\n<li>Mark WordMark WordStateGCbitfields  </li>\n<li>Class Metadata AddressClass</li>\n<li>Array Length</li>\n</ul>\n<p>JVM -&gt;  -&gt; </p>\n<p>JVM</p>\n<p><img src=\".%5Cimages%5CJVM-%E4%BB%8E%E5%81%8F%E5%90%91%E9%94%81%E5%88%B0%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81%E7%9A%84%E8%BF%87%E7%A8%8B.png\" alt=\"image-20210429101554456\"></p>\n<p> - monitor</p>\n<p><img src=\".%5Cimages%5C%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81%E7%9B%91%E8%A7%86%E5%99%A8(monitor)%E5%8E%9F%E7%90%86.png\" alt=\"image-20210429101903740\"></p>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"cl06j796n000qqwu507fy8fur","tag_id":"cl064ohl10004lou5huur9p1p","_id":"cl06j796n000rqwu53mxsa9vc"},{"post_id":"cl06iwafo000nqwu573xwg7v8","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06j9sn0000tqwu5f5mq0rbu"},{"post_id":"cl06jbeml000uqwu56n784tyq","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06jbemm000vqwu5bmtbh6to"},{"post_id":"cl06jc54a000wqwu51oeq1w13","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06jd71n000xqwu5018g2l0j"},{"post_id":"cl06jfuo3000yqwu5g54wbl9h","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06jh5zf000zqwu5fnto0qg9"},{"post_id":"cl06jhww10010qwu5gy4vg7b9","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06jkwr10011qwu50pii4s54"},{"post_id":"cl06jl8370012qwu593nj692r","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06jmi7b0013qwu59b28e7di"},{"post_id":"cl06jmpkp0014qwu5fppdc0t1","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06josib0015qwu5c8d92vmn"},{"post_id":"cl06jpgrh0016qwu5awypgklt","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06jqo110017qwu59plqdlbu"},{"post_id":"cl06jr0ky0018qwu5bgr4f7yb","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06jrq4m0019qwu5cjb01sna"},{"post_id":"cl06kvvne001aqwu570ix6lt4","tag_id":"cl06j9sn0000sqwu58ysr4n0c","_id":"cl06kwu2y001bqwu5c0cs0lxo"}],"Tag":[{"name":"Java","_id":"cl064ohl10004lou5huur9p1p"},{"name":"Spring Boot","_id":"cl064ohl50007lou5cnttd8rn"},{"name":"Spring Cloud","_id":"cl064ohl60009lou5avw8a9cf"},{"name":"jQuery","_id":"cl064ohl6000blou5792x1e96"},{"name":"JUC","_id":"cl064ohl7000clou5g8wt8094"},{"name":"JVM","_id":"cl064ohl7000dlou5bu2jbp2c"},{"name":"","_id":"cl064ohl7000elou591oe9gel"},{"name":"","_id":"cl064ohl7000flou592a51o1g"},{"name":"Centos","_id":"cl064ohl8000glou592lb32qv"},{"name":"VUE","_id":"cl064ohl8000hlou54sjkgshh"},{"name":"Welcome","_id":"cl064ohl8000ilou58vjj0mdd"},{"name":"This","_id":"cl064ohl9000jlou5cwf5cy3r"},{"name":"problems","_id":"cl064ohl9000klou5cf86feyo"},{"name":"documentation","_id":"cl064ohl9000llou5hx0j4eov"},{"name":"using","_id":"cl064ohl9000mlou588iw1ig9"},{"name":"answer","_id":"cl064ohl9000nlou5dakmc8z4"},{"name":"Quick Start","_id":"cl064ohla000olou514tddaat"},{"name":"ask me","_id":"cl064ohla000plou5av7khmij"},{"name":"Welcome3","_id":"cl064ohla000qlou55pavbnxh"},{"name":"JUC","_id":"cl06j9sn0000sqwu58ysr4n0c"}]}}